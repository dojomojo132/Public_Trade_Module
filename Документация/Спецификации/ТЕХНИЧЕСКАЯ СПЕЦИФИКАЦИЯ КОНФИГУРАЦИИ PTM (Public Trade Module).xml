<?xml version="1.0" encoding="UTF-8"?>
<Configuration name="PTM - Public Trade Module" version="1.1.0" platform="8.3.27" country="Ukraine">

    <Description>
        Полная техническая спецификация конфигурации.
        Является ЕДИНЫМ ИСТОЧНИКОМ ПРАВДЫ для разработки.
        Целевая платформа: 1С:Предприятие 8.3.27.1719+
	</Description>

	<SessionParameters>
	
        <Object name="ТекущийПользователь">
            <Block name="Purpose"><Content>Хранит ссылку на справочник "Пользователи" для текущего сеанса.</Content></Block>
            <Block name="DataModel"><Fields><Field type="Type" type_val="Справочник.Пользователи"/></Fields></Block>
        </Object>
        <Object name="ТекущаяКасса">
            <Block name="Purpose"><Content>Кэширует кассу, к которой привязано рабочее место (чтобы не выбирать каждый раз).</Content></Block>
            <Block name="DataModel"><Fields><Field type="Type" type_val="Справочник.Кассы"/></Fields></Block>
        </Object>
    </SessionParameters>
	
	<Constants>
	
		<Object name="ОсновнойСклад" synonym="Основной склад (для подстановки)">
			<Block name="Purpose">
				<Content>Значение по умолчанию для заполнения склада в новых чеках.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field name="Тип" type="Справочник.Склады">Ссылка на склад.</Field>
				</Fields>
			</Block>
		</Object>
		
		<Object name="ПорядокОкругленияЦен" synonym="Порядок округления цен">
			<Block name="Purpose">
				<Content>Глобальная настройка точности расчета цен в документах.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field name="Значение" type="Перечисление.ПорядкиОкругленияЦен">Правило округления.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Используется в обработке "ЗаполнениеНоменклатуры" и при расчете скидок в РМК.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание константы.</Record>
			</Block>
		</Object>

		<Object name="КонтролироватьОстаткиПриСписании" synonym="Контролировать остатки при списании">
			<Block name="Purpose">
				<Content>Флаг, включающий жесткий контроль отрицательных остатков.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field name="Значение" type="Булево">Истина - запрещать списание в минус.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Проверяется в модуле объекта документов (ЧекККМ, СписаниеТовара) перед записью движений.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание константы.</Record>
			</Block>
		</Object>

		<Object name="ОсновнойПоставщик" synonym="Основной поставщик">
			<Block name="Purpose">
				<Content>Значение по умолчанию для подстановки в документы закупки.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field name="Значение" type="Справочник.Контрагенты">Ссылка на поставщика.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Автозаполнение поля "Контрагент" в документе "ПриходТовара" при создании нового.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание константы.</Record>
			</Block>
		</Object>
		
	</Constants>
	
	<CommonModules>
	
		<Object name="НастройкиПоУмолчанию" synonym="Настройки по умолчанию">
			<Block name="Purpose">
				<Content>Серверный API для работы с настройками по умолчанию. Предоставляет универсальные методы для сохранения и чтения значений Неопределенного типа.</Content>
			</Block>
			<Block name="Architecture">
				<Items>
					<Item>Актуальная архитектура: Key-Value с сериализацией в внутреннем формате вместо типизированных полей.</Item>
					<Item>Основные выоды: средние останания - резко снижают стоимость добавления новых настроек с 5 файлов до 1-2 функций в API.</Item>
				</Items>
			</Block>
			<Block name="Properties">
				<Items>
					<Item>Серверный</Item>
					<Item>Вызов сервера</Item>
				</Items>
			</Block>
			<Block name="PublicAPI">
				<Methods>
					<Method name="ПолучитьОсновнойСклад">(нематериализует чтение данных) -&gt; Справочник.Склады</Method>
					<Method name="ПолучитьОсновногоПоставщика">-&gt; Справочник.Контрагенты</Method>
					<Method name="ПолучитьОсновнуюКассу">-&gt; Справочник.Кассы</Method>
					<Method name="ПолучитьОсновнойТипЦен">-&gt; Справочник.ТипыЦен</Method>
					<Method name="ПолучитьПорядокОкругленияЦен">-&gt; Перечисление.ПорядкиОкругленияЦен</Method>
					<Method name="ПолучитьКонтрольОстатков">-&gt; Булево</Method>
					<Method name="ПолучитьКоличествоКнопокВКолонке">-&gt; Число (количество кнопок в вертикальной колонке РМК)</Method>
					<Method name="ПолучитьКоличествоКнопокВРяду">-&gt; Число (количество кнопок в горизонтальном ряду РМК)</Method>
					<Method name="УстановитьЗначениеНастройки">(Настройка: Справочник.НастройкиПоУмолчанию, Значение: Произвольные) - Сохраняет любое значение</Method>
					<Method name="ПолучитьВсеНастройки">-&gt; Структура со всеми настройками (включая новые параметры РМК)</Method>
					<Method name="ИнициализироватьНастройки">() - Автоматическая инициализация всех настроек при старте системы. Проверяет существование записей и наличие значений, устанавливает дефолтные значения для пустых настроек.</Method>
				</Methods>
			</Block>
			<Block name="History">
				<Record date="2026-01-21">Оптимизация: трансиция с типизированных ресурсов на Key-Value с сериализацией в внутреннем формате.</Record>
				<Record date="2026-01-28">Реализация полной сериализации: УстановитьЗначениеНастройки() использует ЗначениеВСтрокуВнутр(), ПолучитьЗначениеНастройки() использует ЗначениеИзСтрокиВнутр() для преобразования данных.</Record>
				<Record date="2026-01-29">Исправление: замена несуществующих функций ЗначениеВСтроку/СтрокаВЗначение на стандартные ЗначениеВСтрокуВнутр/ЗначениеИзСтрокиВнутр для 1С1:8.3.</Record>
				<Record date="2026-01-29">Добавлен метод ИнициализироватьНастройки() для автоматической проверки и заполнения всех настроек дефолтными значениями при старте системы. Вызывается из модуля управляемого приложения.</Record>
				<Record date="2026-01-29" status="incomplete">СТАТУС: Функционал инициализации настроек реализован частично. Исправлены синтаксические ошибки (Новая→Новый Структура), но полное тестирование и интеграция не завершены. Работа приостановлена для переключения на другие задачи.</Record>
			</Block>
		</Object>
		
	</CommonModules>

	<Subsystems>
		<Object name="Все" synonym="Все объекты">
			<Block name="Purpose"><Content>Корневая подсистема, содержащая все объекты конфигурации.</Content></Block>
			<Block name="Composition">
				<Content>Включает все функциональные подсистемы: Торговля, Склад, Финансы, Настройки, Фискал, Тесты.</Content>
			</Block>
			<Block name="History">
				<Record date="2026-01-17">Обновление описания структуры подсистем.</Record>
				<Record date="2026-01-21">Логическое перераспределение объектов. Создание подсистемы "Финансы".</Record>
			</Block>
		</Object>
		
        <Object name="Торговля" synonym="Розничные продажи">
            <Block name="Purpose"><Content>Основной раздел для менеджеров и кассиров. Группирует функционал розничных продаж.</Content></Block>
            <Block name="Composition">
                <Content>РМК, Док.ЧекККМ, Док.ВозвратТовараОтПокупателя, Спр.Номенклатура, Спр.Контрагенты, Спр.ДисконтныеКарты, Спр.ВидыДисконтныхКарт, Спр.ТипыЦен, РегСвед.ЦеныНоменклатуры, РегСвед.Штрихкоды, РегСвед.НастройкиРаспределенияПродаж, РегНак.Продажи, РегНак.ПродажиПоДисконтнымКартам, РегНак.ОстаткиТоваров.</Content>
            </Block>
			<Block name="History">
				<Record date="2026-01-17">Расширение состава подсистемы.</Record>
				<Record date="2026-01-21">Логическое перераспределение: добавлены дисконтные карты, убрана кассовая смена (в Финансы).</Record>
			</Block>
        </Object>
		
		<Object name="Склад" synonym="Складской учет">
			<Block name="Purpose">
				<Content>Раздел для кладовщиков. Группирует функционал учета товарных запасов.</Content>
			</Block>
			<Block name="Composition">
				<Content>Спр.Склады, Спр.Номенклатура, Спр.Контрагенты, Док.ПриходТовара, Док.СписаниеТовара, Док.ИнвентаризацияТоваров, Док.Переоценка, Конст.ОсновнойСклад, Конст.ОсновнойПоставщик, Конст.КонтролироватьОстаткиПриСписании, РегНак.ОстаткиТоваров, РегСвед.ЦеныЗакупки, Отчет.ОстаткиТоваров.</Content>
			</Block>
			<Block name="History">
				<Record date="2026-01-17">Расширение состава подсистемы.</Record>
				<Record date="2026-01-21">Логическое перераспределение: добавлены константы управления складом.</Record>
			</Block>
		</Object>
		
		<Object name="Финансы" synonym="Денежные расчеты">
			<Block name="Purpose">
				<Content>Раздел для управления денежными средствами. Группирует кассовые операции и взаиморасчеты.</Content>
			</Block>
			<Block name="Composition">
				<Content>Спр.Кассы, Спр.ФОП, Док.КассоваяСмена, Док.ПриходныйКассовыйОрдер, Док.РасходныйКассовыйОрдер, РегНак.ДенежныеСредства, РегНак.Взаиморасчеты.</Content>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Управление денежными потоками через кассы.</Item>
					<Item>Контроль кассовых смен и операций.</Item>
					<Item>Учет взаиморасчетов с контрагентами.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-21">Создание подсистемы. Выделена из Торговля для логического разделения.</Record>
				<Record date="2026-02-11">Добавлен Справочник.ФОП в состав подсистемы.</Record>
			</Block>
		</Object>
		
        <Object name="Настройки" synonym="НСИ и Администрирование">
            <Block name="Purpose"><Content>Раздел для администратора и товароведа. Группирует справочники, константы и настройки.</Content></Block>
            <Block name="Composition">
                <Content>Все справочники (Пользователи, Кассы, Склады, ТипыЦен, НалоговыеГруппы, КассовоеОборудование, ВидыДисконтныхКарт, Номенклатура, Контрагенты, ФОП), все константы, все регистры сведений, все перечисления.</Content>
            </Block>
			<Block name="History">
				<Record date="2026-01-17">Обновление состава подсистемы.</Record>
				<Record date="2026-01-21">Расширение состава: включены все НСИ объекты.</Record>
				<Record date="2026-02-11">Добавлен Справочник.ФОП в состав подсистемы.</Record>
			</Block>
        </Object>
		
		<Object name="Фискал" synonym="Фискализация">
			<Block name="Purpose">
				<Content>Служебная подсистема для взаимодействия с фискальным оборудованием (ПРРО, ККТ, сканеры).</Content>
			</Block>
			<Block name="Composition">
				<Content>Док.ФискальныйЧек, Спр.КассовоеОборудование, ОбщМодуль.МенеджерОборудования, ОбщШаблон.Драйвер1ССканер, Перечисление.ТипыОборудования.</Content>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Интеграция с фискальным оборудованием.</Item>
					<Item>Используется для настройки прав доступа к фискальным функциям.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-17">Обновление описания и состава.</Record>
				<Record date="2026-01-21">Оптимизация состава: только фискальные объекты и оборудование.</Record>
			</Block>
		</Object>
		
		<Object name="Тесты" synonym="Тестовые обработки">
			<Block name="Purpose">
				<Content>Служебная подсистема для тестовых обработок и заполнения данных.</Content>
			</Block>
			<Block name="Composition">
				<Content>Обработка.ЗаполниеТестовойНоменклатуры, Обработка.ТестовоеЗаполнениеЦен, Обработка.ТестовоеЗаполнениеШтрихкодов, Обработка.ТестовоеЗаполнениеДанных.</Content>
			</Block>
			<Block name="History">
				<Record date="2026-01-21">Описание в спецификации.</Record>
			</Block>
		</Object>
		
		<Object name="mcp_MCPСервер" synonym="MCP-cервер">
			<Block name="Purpose">
				<Content>Служебная подсистема для модуля Model Context Protocol (MCP) расширения IDE.</Content>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Содержит утилиты для интеграции с VS Code и автоматизации разработки.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-17">Документирование MCP-серверов в спецификации.</Record>
			</Block>
		</Object>
    </Subsystems>

    <Reports>
		<Object name="ОстаткиТоваров" synonym="Остатки товаров">
			<Block name="Purpose">
				<Content>Отчет для анализа количественных остатков товаров на складах с группировкой по категориям товаров.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Dimension">Номенклатура (Справочник.Номенклатура) - наименование товара.</Field>
					<Field type="Dimension">Родитель (Справочник.Номенклатура) - группа товара (для группировки).</Field>
					<Field type="Dimension">Склад (Справочник.Склады) - место хранения товара.</Field>
					<Field type="Attribute">ЕдиницаИзмерения (Перечисление.ЕдиницыИзмерения) - единица измерения товара.</Field>
					<Field type="Resource">Количество (Число) - текущий остаток товара на складе.</Field>
				</Fields>
				<Parameters>
					<Parameter name="МоментВремени">Дата, на которую рассчитываются остатки.</Parameter>
					<Parameter name="Номенклатура">Фильтр по конкретному товару (необязательный).</Parameter>
					<Parameter name="Родитель">Фильтр по группе товаров (необязательный, иерархический).</Parameter>
					<Parameter name="Склад">Фильтр по складу (необязательный).</Parameter>
				</Parameters>
			</Block>
			<Block name="Logic">
				<Items>
					<Item event="Источник">Использует виртуальную таблицу РегистрНакопления.ОстаткиТоваров.Остатки.</Item>
					<Item event="Фильтры">
						1. По умолчанию показываются только элементы (не группы) номенклатуры.
						2. Поддерживается фильтрация по конкретному товару.
						3. Поддерживается иерархический фильтр по группе товаров.
						4. Поддерживается фильтрация по складу.
					</Item>
					<Item event="Группировка">
						По умолчанию данные группируются по полю "Родитель" (группа товаров), затем по товарам внутри каждой группы.
					</Item>
					<Item event="Вывод">
						Отчет выводит: Наименование товара, Единицу измерения, Остаток.
						Поддерживает итоги по группам товаров.
					</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-17">Добавление описания отчета в спецификацию.</Record>
				<Record date="2026-01-25">Доработка отчета: добавлены поля Родитель и ЕдиницаИзмерения, настроена группировка по категориям товаров, добавлены параметры фильтрации по конкретному товару и группе товаров.</Record>
			</Block>
		</Object>

		<Object name="Продажи" synonym="Продажи">
			<Block name="Purpose">
				<Content>Отчет для анализа продаж товаров за период с группировкой по категориям товаров и дополнительной аналитикой по кассам и сотрудникам.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Dimension">Номенклатура (Справочник.Номенклатура) - наименование проданного товара.</Field>
					<Field type="Dimension">Родитель (Справочник.Номенклатура) - группа товара (для группировки).</Field>
					<Field type="Dimension">Касса (Справочник.Кассы) - касса, на которой прошла продажа.</Field>
					<Field type="Dimension">КассоваяСмена (Документ.КассоваяСмена) - смена, в которой была продажа.</Field>
					<Field type="Dimension">Сотрудник (Справочник.Пользователи) - кассир, проводивший операцию.</Field>
					<Field type="Attribute">ЕдиницаИзмерения (Перечисление.ЕдиницыИзмерения) - единица измерения товара.</Field>
					<Field type="Resource">Количество (Число) - проданное количество товара.</Field>
					<Field type="Resource">Сумма (Число) - выручка от продажи товара.</Field>
				</Fields>
				<Parameters>
					<Parameter name="НачалоПериода">Начало периода анализа продаж.</Parameter>
					<Parameter name="КонецПериода">Конец периода анализа продаж.</Parameter>
					<Parameter name="Номенклатура">Фильтр по конкретному товару (необязательный).</Parameter>
					<Parameter name="Родитель">Фильтр по группе товаров (необязательный, иерархический).</Parameter>
					<Parameter name="Касса">Фильтр по кассе (необязательный).</Parameter>
					<Parameter name="Сотрудник">Фильтр по сотруднику (необязательный).</Parameter>
				</Parameters>
			</Block>
			<Block name="Logic">
				<Items>
					<Item event="Источник">Использует виртуальную таблицу РегистрНакопления.Продажи.Обороты за указанный период.</Item>
					<Item event="Фильтры">
						1. Обязательные параметры: НачалоПериода и КонецПериода.
						2. Поддерживается фильтрация по конкретному товару.
						3. Поддерживается иерархический фильтр по группе товаров.
						4. Поддерживается фильтрация по кассе и сотруднику.
					</Item>
					<Item event="Группировка">
						По умолчанию данные группируются по полю "Родитель" (группа товаров), затем по товарам внутри каждой группы.
						Доступна дополнительная аналитика по измерениям: Касса, КассоваяСмена, Сотрудник.
					</Item>
					<Item event="Вывод">
						Отчет выводит: Наименование товара, Единицу измерения, Количество, Сумму.
						Поддерживает итоги по группам товаров и общий итог.
					</Item>
					<Item event="Агрегация">
						Количество и Сумма рассчитываются как суммарные обороты за период по всем измерениям.
					</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-25">Создание отчета с полной схемой компоновки данных. Реализована группировка по категориям товаров, вывод количества и суммы продаж, фильтрация по периоду, товарам, кассам и сотрудникам.</Record>
				<Record date="2026-01-25">Упрощение отчета: объединение параметров периода в один (Период), удаление лишних фильтров, показ продаж по всем товарам с группировкой по родителю.</Record>
			</Block>
		</Object>

		<Object name="Возвраты" synonym="Возвраты">
			<Block name="Purpose">
				<Content>Отчет для анализа возвратов товаров от покупателей за период с группировкой по категориям товаров.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Dimension">Номенклатура (Справочник.Номенклатура) - наименование возвращенного товара.</Field>
					<Field type="Dimension">Родитель (Справочник.Номенклатура) - группа товара (для группировки).</Field>
					<Field type="Attribute">ЕдиницаИзмерения (Перечисление.ЕдиницыИзмерения) - единица измерения товара.</Field>
					<Field type="Resource">Количество (Число) - возвращенное количество товара.</Field>
					<Field type="Resource">Сумма (Число) - сумма возвращенных товаров.</Field>
				</Fields>
				<Parameters>
					<Parameter name="Период">Период анализа возвратов (стандартный период с началом и окончанием).</Parameter>
				</Parameters>
			</Block>
			<Block name="Logic">
				<Items>
					<Item event="Источник">Использует табличную часть "Товары" документа "ВозвратТовараОтПокупателя" с агрегацией данных за период.</Item>
					<Item event="Фильтры">
						1. Обязательный параметр: Период (стандартный период).
						2. Учитываются только проведенные документы возврата.
						3. Без дополнительных фильтров - показываются все возвраты за период.
					</Item>
					<Item event="Группировка">
						По умолчанию данные группируются по полю "Родитель" (группа товаров), затем по товарам внутри каждой группы.
					</Item>
					<Item event="Вывод">
						Отчет выводит: Наименование товара, Единицу измерения, Количество, Сумму.
						Поддерживает итоги по группам товаров и общий итог.
					</Item>
					<Item event="Агрегация">
						Количество и Сумма рассчитываются как суммарные значения из всех документов возврата за период.
					</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-25">Создание отчета с полной схемой компоновки данных. Реализован упрощенный вариант с единым параметром периода, группировкой по категориям товаров, без дополнительных фильтров.</Record>
			</Block>
		</Object>

		<Object name="ДвижениеТоваров" synonym="Движение товаров">
			<Block name="Purpose">
				<Content>Оборотно-сальдовый отчет для анализа движения товаров за период с отображением начальных остатков, прихода, расхода, возврата и конечных остатков.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Dimension">Номенклатура (Справочник.Номенклатура) - наименование товара.</Field>
					<Field type="Attribute">ЕдиницаИзмерения (Перечисление.ЕдиницыИзмерения) - единица измерения товара.</Field>
					<Field type="Resource">НачальныйОстаток (Число) - остаток товара на начало периода.</Field>
					<Field type="Resource">Приход (Число) - поступление товара за период (без возвратов).</Field>
					<Field type="Resource">Расход (Число) - выбытие товара за период.</Field>
					<Field type="Resource">Возврат (Число) - возврат товара от покупателей за период.</Field>
					<Field type="Resource">КонечныйОстаток (Число) - остаток товара на конец периода.</Field>
				</Fields>
				<Parameters>
					<Parameter name="Период">Период анализа движения товаров (стандартный период).</Parameter>
					<Parameter name="Номенклатура">Фильтр по конкретному товару (необязательный). Если не заполнен - показываются все товары.</Parameter>
				</Parameters>
			</Block>
			<Block name="Logic">
				<Items>
					<Item event="Источник">Использует виртуальную таблицу РегистрНакопления.ОстаткиТоваров.ОстаткиИОбороты для получения начальных/конечных остатков и оборотов за период.</Item>
					<Item event="Разделение возвратов">
						Возвраты выделяются отдельной колонкой путем анализа типа регистратора (Документ.ВозвратТовараОтПокупателя).
						Приход корректируется - из него вычитаются возвраты.
					</Item>
					<Item event="Фильтры">
						1. Обязательный параметр: Период.
						2. Необязательный параметр: Номенклатура (товар).
						3. Фильтр применяется как к основному запросу, так и к подзапросу возвратов.
					</Item>
					<Item event="Расчеты">
						НачальныйОстаток = КоличествоНачальныйОстаток
						Приход = КоличествоПриход - Возвраты
						Расход = КоличествоРасход
						Возврат = Сумма приходов от документов ВозвратТовараОтПокупателя
						КонечныйОстаток = КоличествоКонечныйОстаток
					</Item>
					<Item event="Вывод">
						Отчет выводит оборотно-сальдовую ведомость с полями:
						Номенклатура, Ед.изм., Остаток на начало, Приход, Расход, Возврат, Остаток на конец.
					</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-25">Создание отчета с оборотно-сальдовой структурой. Реализованы фильтры по периоду и товару, разделение возвратов в отдельную колонку, отображение начальных и конечных остатков.</Record>
			</Block>
		</Object>

		<Object name="ВаловаяПрибыль" synonym="Валовая прибыль">
			<Block name="Purpose">
				<Content>СКД-отчет для анализа валовой прибыли по номенклатуре за выбранный период. Показывает прибыль за день и за период с группировкой по дням. Рассчитывает прибыль как разницу между суммой продаж и себестоимостью товаров.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Dimension">Период (Дата) - дата продажи (группировка по дням).</Field>
					<Field type="Dimension">Номенклатура (Справочник.Номенклатура) - наименование товара.</Field>
					<Field type="Dimension">Группа (Справочник.Номенклатура) - родительская группа товара.</Field>
					<Field type="Resource">Количество (Число) - количество проданного товара.</Field>
					<Field type="Resource">Себестоимость (Число) - себестоимость проданного товара.</Field>
					<Field type="Resource">ПродажнаяСумма (Число) - сумма продаж товара.</Field>
					<Field type="Resource">ВаловаяПрибыль (Число) - валовая прибыль (ПродажнаяСумма - Себестоимость).</Field>
					<Field type="Resource">Рентабельность (Число) - рентабельность продаж в процентах ((ВаловаяПрибыль / ПродажнаяСумма) × 100).</Field>
				</Fields>
				<Parameters>
					<Parameter name="Период">СтандартныйПериод - единый параметр выбора периода анализа.</Parameter>
				</Parameters>
			</Block>
			<Block name="Logic">
				<Items>
					<Item event="Источник">РегистрНакопления.Продажи.Обороты с периодичностью День.</Item>
					<Item event="Группировка">Первый уровень: Период (по дням). Второй уровень: детализация по номенклатуре. Итоги по дням и общий итог за весь период.</Item>
					<Item event="Расчеты">
						Количество = СУММА(КоличествоОборот)
						Себестоимость = СУММА(СебестоимостьОборот)
						ПродажнаяСумма = СУММА(СуммаОборот)
						ВаловаяПрибыль = СУММА(СуммаОборот - СебестоимостьОборот)
						Рентабельность = (ВаловаяПрибыль / ПродажнаяСумма) × 100
					</Item>
					<Item event="Реализация">СКД-отчёт без собственной формы (используется стандартная форма отчёта). Шаблон: ОсновнаяСхемаКомпоновкиДанных (DataCompositionSchema).</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-02-11">Создание отчета. Реализован расчет валовой прибыли и рентабельности по номенклатуре за период с возможностью выбора начала и конца периода.</Record>
				<Record date="2026-02-11">Переработка на СКД. Один параметр Период (СтандартныйПериод), группировка по дням, колонки: Номенклатура, Себестоимость, Продажная сумма, Валовая прибыль, Рентабельность.</Record>
			</Block>
		</Object>

		<Object name="ПродажиПоСчетам" synonym="Продажи по счетам">
			<Block name="Purpose">
				<Content>Отчёт о продажах за день и период с группировкой по кассам. Содержит: Номенклатура, Количество, Сумма продажи.</Content>
			</Block>
			<Block name="DataModel">
				<DataSource>РегистрНакопления.Продажи.Обороты</DataSource>
				<Fields>
					<Field name="Касса" dataType="Справочник.Кассы">Группировка — касса, через которую прошла продажа.</Field>
					<Field name="ВидКассы" dataType="Перечисление.ВидыКасс">Вид кассы (Наличная / Банковский счет) — через реквизит кассы.</Field>
					<Field name="Номенклатура" dataType="Справочник.Номенклатура">Проданный товар.</Field>
					<Field name="Количество" dataType="Число">Суммарное количество проданного товара.</Field>
					<Field name="Сумма" dataType="Число">Сумма продажи.</Field>
				</Fields>
				<Parameters>
					<Parameter name="Период" dataType="СтандартныйПериод">Период отчёта (по умолчанию — Сегодня).</Parameter>
				</Parameters>
			</Block>
			<Block name="Logic">
				<Items>
					<Item event="Реализация">СКД-отчёт. Группировка первого уровня по Кассе, детализация — номенклатура/количество/сумма. Параметр Период по умолчанию = Сегодня.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-02-11">Создание отчёта продаж по счетам (кассам) с группировкой по кассам.</Record>
			</Block>
		</Object>

		<Object name="ДвижениеДенежныхСредств" synonym="Движение денежных средств">
			<Block name="Purpose">
				<Content>СКД-отчёт по регистру ДенежныеСредства. Показывает остатки и обороты по кассам за период.</Content>
			</Block>
			<Block name="DataModel">
				<DataSource>РегистрНакопления.ДенежныеСредства.ОстаткиИОбороты</DataSource>
				<Fields>
					<Field name="Касса" type_val="Измерение">Касса (группировка).</Field>
					<Field name="Регистратор" type_val="Измерение">Документ-основание.</Field>
					<Field name="Период" type_val="Измерение">Период (основной).</Field>
					<Field name="СуммаНачальныйОстаток" type_val="Ресурс">Остаток на начало.</Field>
					<Field name="СуммаПриход" type_val="Ресурс">Приход за период.</Field>
					<Field name="СуммаРасход" type_val="Ресурс">Расход за период.</Field>
					<Field name="СуммаКонечныйОстаток" type_val="Ресурс">Остаток на конец.</Field>
				</Fields>
				<Parameters>
					<Parameter name="Период" dataType="СтандартныйПериод">Период отчёта.</Parameter>
				</Parameters>
			</Block>
			<Block name="Logic">
				<Items>
					<Item event="Реализация">СКД-отчёт. Группировка по Кассе. Поля: начальный остаток, приход, расход, конечный остаток.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-02-11">Создание отчёта движения денежных средств по кассам.</Record>
			</Block>
		</Object>

		<Object name="Взаиморасчеты" synonym="Взаиморасчеты">
			<Block name="Purpose">
				<Content>СКД-отчёт по регистру Взаиморасчеты. Показывает остатки и обороты долга по контрагентам.</Content>
			</Block>
			<Block name="DataModel">
				<DataSource>РегистрНакопления.Взаиморасчеты.ОстаткиИОбороты</DataSource>
				<Fields>
					<Field name="Контрагент" type_val="Измерение">Контрагент (группировка).</Field>
					<Field name="Регистратор" type_val="Измерение">Документ-основание.</Field>
					<Field name="Период" type_val="Измерение">Период.</Field>
					<Field name="СуммаНачальныйОстаток" type_val="Ресурс">Долг на начало.</Field>
					<Field name="СуммаПриход" type_val="Ресурс">Приход (увеличение долга).</Field>
					<Field name="СуммаРасход" type_val="Ресурс">Расход (уменьшение долга).</Field>
					<Field name="СуммаКонечныйОстаток" type_val="Ресурс">Долг на конец.</Field>
				</Fields>
				<Parameters>
					<Parameter name="Период" dataType="СтандартныйПериод">Период отчёта.</Parameter>
				</Parameters>
			</Block>
			<Block name="Logic">
				<Items>
					<Item event="Реализация">СКД-отчёт. Группировка по Контрагенту. Поля: долг на начало, приход, расход, долг на конец.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-02-11">Создание отчёта взаиморасчётов с контрагентами.</Record>
			</Block>
		</Object>
	</Reports>

    <Catalogs>
		<Object name="Номенклатура" synonym="Товары и услуги">
			
			<Block name="Purpose">
				<Content>
					Центральный справочник для хранения информации о товарах и услугах. 
					Используется во всех товароучетных документах и РМК.
				</Content>
			</Block>

			<Block name="DataModel">
				<Fields>
					<Field name="Артикул" type="Строка(25)">Уникальный артикул производителя.</Field>
					<Field name="Код" type="Строка(11)">Внутренний код (генерируется автоматически).</Field>
					<Field name="ЕдиницаИзмерения" type="Справочник.ЕдиницыИзмерения">Базовая единица учета.</Field>
					<Field name="СтавкаНДС" type="Перечисление.СтавкиНДС">20%, 7%, 0%, Без НДС.</Field>
					<Field name="КодУКТЗЕД" type="Строка(20)">Код ВЭД (Обязателен для акцизных товаров в Украине).</Field>
					<Field name="ТребуетАкцизнуюМарку" type="Булево">Флаг контроля маркировки в РМК.</Field>
					<Field name="НалоговаяГруппа" type="Справочник.НалоговыеГруппы">Группа налогообложения для ПРРО.</Field>
					<Field name="ПроцентНаценки" type="Число(5,2)">Плановая наценка для авторасчета цен.</Field>
					<Field name="ФОП" type="Справочник.ФОП">Форма оплати платежу — визначає, в який фіскальний чек потрапить позиція при продажу. Заповнюється з довідника ФОП.</Field>
				</Fields>
				<TabularSections>
					<TabularSection name="Штрихкоды">
						<Field name="Штрихкод" type="Строка(200)">Штрихкод товара. Связывается с регистром сведений "Штрихкоды".</Field>
					</TabularSection>
				</TabularSections>
			</Block>

			<Block name="Logic">
				<Items>
					<Item event="ПередЗаписью">
						Автозаполнение: Если поле "Артикул" не заполнено, в него копируется значение поля "Код".
					</Item>
					<Item event="Контроль">
						При установке флага "ТребуетАкцизнуюМарку" проверка заполненности "КодУКТЗЕД".
					</Item>
					<Item event="ПередЗаписью">
						Проверка уникальности штрихкодов внутри табличной части "Штрихкоды". При обнаружении дублей запись отменяется с выводом сообщения.
					</Item>
					<Item event="ПослеЗаписи">
						Синхронизация табличной части "Штрихкоды" с регистром сведений "Штрихкоды". Все старые записи регистра для данной номенклатуры удаляются, затем добавляются новые из ТЧ.
					</Item>
				</Items>
			</Block>

			<Block name="Interface">
				<Items>
					<Item>
						Форма списка: Реализован быстрый поиск по вхождению строки в Наименование/Артикул/Штрихкод.
					</Item>
					<Item>
						Форма элемента: Содержит табличную часть "Штрихкоды" для управления штрихкодами товара. При открытии формы штрихкоды загружаются из регистра сведений. При записи штрихкоды синхронизируются с регистром.
					</Item>
					<Item>
						Форма элемента: Проверка уникальности штрихкодов выполняется как внутри ТЧ, так и в регистре (проверка на использование у другой номенклатуры).
					</Item>
				<Item event="ШтрихкодыШтрихкодПриИзменении">
					При изменении штрихкода автоматически удаляются пробелы и выполняется проверка уникальности в табличной части. При обнаружении дубликата штрихкод очищается с выводом предупреждения.
				</Item>
				<Item event="ШтрихкодыПередУдалением">
					Перед удалением непустого штрихкода запрашивается подтверждение. Пустые штрихкоды удаляются без подтверждения.
				</Item>
				<Item event="ШтрихкодыПередНачаломДобавления">
					При копировании строки штрихкод автоматически очищается для предотвращения дублирования.
				</Item>
			<Block name="History">
				<Record date="2025-10-15">Реализовано автозаполнение Артикула из Кода.</Record>
				<Record date="2025-10-20">Добавлены реквизиты для ПРРО (КодУКТЗЕД, НалоговаяГруппа).</Record>
				<Record date="2026-01-25">Добавлена табличная часть "Штрихкоды" с колонкой "Штрихкод". Реализована форма элемента с загрузкой штрихкодов из регистра сведений "Штрихкоды". Реализована синхронизация штрихкодов с регистром при записи элемента. Добавлена проверка уникальности штрихкодов. Реализованы обработчики удаления и изменения штрихкодов с проверками и подтверждениями.</Record>
				<Record date="2026-02-11">Добавлен реквизит ФОП (Справочник.ФОП) — форма оплати платежу для группировки позиций у фіскальні чеки.</Record>
			</Block>
		</Object>

		<Object name="Кассы" synonym="Кассовые аппараты">
			
			<Block name="Purpose">
				<Content>
					Места проведения расчетов. Разделяет денежные потоки и смены по физическим устройствам.
				</Content>
			</Block>

			<Block name="DataModel">
				<Fields>
					<Field type="StandardAttribute" name="Код">Строка(9) - уникальный код кассы.</Field>
					<Field type="StandardAttribute" name="Наименование">Строка(25) - название кассы (пр. "Касса №1").</Field>
					<Field type="Attribute" name="ВидКассы" dataType="Перечисление.ВидыКасс">Вид кассы: Наличная или Банковский счет. Обязательный для заполнения.</Field>
					<Field type="Attribute" name="ДоступнаПриРасчете" dataType="Булево">Отображать кассу при выборе оплаты в РМК.</Field>
					<Field type="Attribute" name="Оборудование" dataType="Справочник.КассовоеОборудование">Фискальный регистратор (РРО/ПРРО), закреплённый за данной кассой. Одна касса = один РРО.</Field>
				</Fields>
				<Properties>
					<Hierarchical>false</Hierarchical>
					<Autonumbering>true</Autonumbering>
					<CheckUnique>true</CheckUnique>
					<InputByString>Code, Description</InputByString>
				</Properties>
			</Block>

			<Block name="Logic">
				<Items>
					<Item>Используется как разделитель учета в регистре "ДенежныеСредства".</Item>
					<Item>Используется в ТЧ "ЧекиККМ" документа "КассоваяСмена" для детализации чеков по кассам.</Item>
				</Items>
			</Block>

			<Block name="History">
				<Record date="2025-10-01">Создание базовой структуры.</Record>
				<Record date="2026-02-11">Добавлен реквизит ВидКассы (Перечисление.ВидыКасс) - наличная или банковский счёт.</Record>
				<Record date="2026-02-11">Добавлен реквизит Оборудование (Справочник.КассовоеОборудование) — привязка фискального регистратора к кассе (1 касса = 1 РРО/ПРРО). Регистр НастройкиРаспределенияПродаж более не используется для маршрутизации.</Record>
			</Block>
		</Object>

		<Object name="Склады" synonym="Склады и магазины">
			<Block name="Purpose">
				<Content>Места хранения товарных остатков. Определяет места хранения для учета остатков и движения товаров.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="StandardAttribute" name="Код">Строка(9) - уникальный код склада.</Field>
					<Field type="StandardAttribute" name="Наименование">Строка(25) - название склада.</Field>
					<Field name="ТипСклада" type="Перечисление.ТипыСкладов">Классификация склада (основной, розничный и т.д.).</Field>
				</Fields>
				<Properties>
					<Hierarchical>false</Hierarchical>
					<Autonumbering>true</Autonumbering>
					<CheckUnique>true</CheckUnique>
					<InputByString>Code, Description</InputByString>
				</Properties>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Разделитель учета в регистре "ОстаткиТоваров".</Item>
					<Item>Обязательное заполнение в документах прихода и расхода товаров.</Item>
					<Item>По умолчанию заполняется из константы ОсновнойСклад.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2025-10-01">Создание базовой структуры.</Record>
				<Record date="2026-01-17">Дополнение спецификации полной структурой согласно стандарту.</Record>
			</Block>
		</Object>

		<Object name="НалоговыеГруппы" synonym="Налоговые группы (ПРРО)">
			<Block name="Purpose">
				<Content>
					Классификатор кодов налоговых групп для фискального чека (ПРРО). Необходимо для маппинга ставок НДС на коды ККТ.
				</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="StandardAttribute" name="Код">Строка(9) - уникальный код налоговой группы.</Field>
					<Field type="StandardAttribute" name="Наименование">Строка(25) - название налоговой группы.</Field>
					<Field type="Attribute" name="КодНалоговойГруппыККТ">Строка(10) - код налоговой группы для ККТ.</Field>
				</Fields>
				<Properties>
					<Hierarchical>false</Hierarchical>
					<Autonumbering>true</Autonumbering>
					<CheckUnique>true</CheckUnique>
					<InputByString>Code, Description</InputByString>
				</Properties>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Используется в справочнике Номенклатура для указания налоговой группы товара.</Item>
					<Item>При фискализации чека код передается в ККТ для корректного расчета налогов.</Item>
					<Item>Специализация для Украины и системы ПРРО.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2025-10-20">Добавлен в рамках адаптации под законодательство Украины.</Record>
				<Record date="2026-01-17">Дополнение спецификации полной структурой согласно стандарту.</Record>
			</Block>
		</Object>
	
		<Object name="Пользователи" synonym="Список пользователей">
            <Block name="Purpose">
                <Content>Список физических лиц, работающих с системой. Определяет права доступа и роли кассиров в системе.</Content>
            </Block>
            <Block name="DataModel">
                <Fields>
					<Field type="StandardAttribute" name="Код">Строка(9) - уникальный код пользователя.</Field>
                    <Field name="Наименование" type="Строка(100)">ФИО.</Field>
                    <Field name="ИдентификаторПользователяИБ" type="УникальныйИдентификатор">Связь с пользователем платформы.</Field>
					<Field name="РазрешитьПродажуВМинус" type="Булево">Право на проведение чека при недостатке остатка.</Field>
					<Field name="РазрешитьРучныеСкидки" type="Булево">Право на редактирование цены/скидки в чеке.</Field>
                </Fields>
				<Properties>
					<Hierarchical>false</Hierarchical>
					<Autonumbering>true</Autonumbering>
					<CheckUnique>true</CheckUnique>
					<InputByString>Code, Description</InputByString>
				</Properties>
            </Block>
			<Block name="Logic">
				<Items>
					<Item>Используется в параметре сеанса ТекущийПользователь для идентификации кассира.</Item>
					<Item>Флаги прав проверяются в РМК при операциях продажи и применении скидок.</Item>
					<Item>Используется как измерение в регистре Продажи (Сотрудник) для аналитики по кассирам.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Добавлены флаги дополнительных прав (продажа в минус, скидки).</Record>
				<Record date="2026-01-17">Дополнение спецификации полной структурой согласно стандарту.</Record>
			</Block>
        </Object>
		
		<Object name="Контрагенты" synonym="Контрагенты">
			<Block name="Purpose">
				<Content>Справочник для хранения списка поставщиков, покупателей и прочих бизнес-партнеров.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="StandardAttribute" name="Код">Строка(9) - уникальный код контрагента.</Field>
					<Field name="Наименование" type="Строка(25)">Название контрагента.</Field>
				</Fields>
				<Properties>
					<Hierarchical>false</Hierarchical>
					<Autonumbering>true</Autonumbering>
					<CheckUnique>true</CheckUnique>
					<InputByString>Code, Description</InputByString>
				</Properties>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Используется как аналитика в регистре "Взаиморасчеты".</Item>
					<Item>Обязательное заполнение в документах ПриходТовара.</Item>
					<Item>Автоматическое заполнение из константы ОсновнойПоставщик.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
				<Record date="2026-01-17">Дополнение спецификации полной структурой согласно стандарту.</Record>
			</Block>
		</Object>

		<Object name="КассовоеОборудование" synonym="Кассовое оборудование">
			<Block name="Purpose">
				<Content>Каталог внешнего оборудования (ККТ, сканеры, принтеры, весы) для хранения настроек подключения и конфигурации.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="StandardAttribute" name="Код">Строка(9) - уникальный код оборудования.</Field>
					<Field type="StandardAttribute" name="Наименование">Строка(25) - название устройства.</Field>
					<Field name="ТипОборудования" type="Перечисление.ТипыОборудования">Вид устройства (ККТ, сканер, принтер, весы).</Field>
					<Field name="ДрайверID" type="Строка(100)">Идентификатор драйвера в системе (AddIn).</Field>
					<Field name="ПараметрыПодключения" type="ХранилищеЗначения">Сериализованные настройки (порт, скорость и т.д.).</Field>
					<Field name="Порт" type="Число(2)">Номер COM-порта (устаревает).</Field>
				</Fields>
				<Properties>
					<Hierarchical>false</Hierarchical>
					<Autonumbering>true</Autonumbering>
					<CheckUnique>true</CheckUnique>
					<InputByString>Code, Description</InputByString>
				</Properties>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Используется МенеджерОборудования для создания подключений к устройствам.</Item>
					<Item>ПараметрыПодключения хранят специфичные настройки для разных моделей оборудования.</Item>
					<Item>Поддержка библиотек для обмена с фискальными системами и периферийными устройствами.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
				<Record date="2026-01-17">Дополнение спецификации полной структурой согласно стандарту.</Record>
			</Block>
		</Object>

		<Object name="ТипыЦен" synonym="Типы цен">
			<Block name="Purpose">
				<Content>Классификатор видов цен (Закупочная, Розничная, Оптовая, Минимальная). Определяет назначение и политику ценообразования.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="StandardAttribute" name="Код">Строка(9) - уникальный код типа цены.</Field>
					<Field type="StandardAttribute" name="Наименование">Строка(25) - название типа цены.</Field>
				</Fields>
				<Properties>
					<Hierarchical>false</Hierarchical>
					<Autonumbering>true</Autonumbering>
					<CheckUnique>true</CheckUnique>
					<InputByString>Code, Description</InputByString>
					<PredefinedDataUpdate>Auto</PredefinedDataUpdate>
				</Properties>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Используется как измерение в регистре ЦеныНоменклатуры для хранения как розничных, так и закупочных цен.</Item>
					<Item>Предопределенные элементы: Закупочная, Розничная.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
				<Record date="2026-01-17">Дополнение спецификации полной структурой согласно стандарту.</Record>
				<Record date="2026-01-29">Добавлены предопределённые элементы Закупочная и Розничная. Регистр ЦеныЗакупки удалён, все цены теперь хранятся в ЦеныНоменклатуры с различными типами цен.</Record>
			</Block>
		</Object>

		<Object name="ВидыДисконтныхКарт" synonym="Виды дисконтных карт">
			<Block name="Purpose">
				<Content>Классификатор типов карт лояльности ("Золотая", "Серебряная", "Платиновая"). Используется для группировки дисконтных карт по уровню привилегий.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="StandardAttribute" name="Код">Строка(9) - уникальный код вида карты.</Field>
					<Field type="StandardAttribute" name="Наименование">Строка(25) - название вида карты.</Field>
				</Fields>
				<Properties>
					<Hierarchical>false</Hierarchical>
					<Autonumbering>true</Autonumbering>
					<CheckUnique>true</CheckUnique>
					<InputByString>Code, Description</InputByString>
				</Properties>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Служит родительским справочником для справочника ДисконтныеКарты.</Item>
					<Item>Определяет правила начисления скидок и бонусов по программе лояльности.</Item>
					<Item>Используется для аналитики продаж по видам карт лояльности.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
				<Record date="2026-01-17">Дополнение спецификации полной структурой согласно стандарту.</Record>
			</Block>
		</Object>

		<Object name="ФОП" synonym="Форми оплат (ФОП)">
			<Block name="Purpose">
				<Content>Справочник форм оплат (Форма оплати платежу) для группировки позицій чека у окремі фіскальні чеки. Кожна позиція номенклатури має реквізит ФОП, який визначає, в який фіскальний чек потрапить ця позиція при продажу через РМК. Це дозволяє розділяти готівкові та безготівкові оплати, а також інші форми оплат, на рівні окремих фіскальних чеків.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="StandardAttribute" name="Код">Строка(9) - уникальный код формы оплаты.</Field>
					<Field type="StandardAttribute" name="Наименование">Строка(50) - название формы оплаты.</Field>
				</Fields>
				<Properties>
					<Hierarchical>false</Hierarchical>
					<Autonumbering>true</Autonumbering>
					<CheckUnique>true</CheckUnique>
					<CodeLength>9</CodeLength>
					<DescriptionLength>50</DescriptionLength>
					<InputByString>Code, Description</InputByString>
					<PredefinedDataUpdate>Auto</PredefinedDataUpdate>
				</Properties>
				<PredefinedItems>
					<Item name="Готівка">Готівкова оплата (наличные). Предвизначений елемент за замовчуванням.</Item>
				</PredefinedItems>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Используется как реквизит справочника Номенклатура для указания формы оплаты товара.</Item>
					<Item>При пробитии чека в РМК позиции группируются по значению ФОП — для каждой уникальной ФОП создаётся отдельный фискальный чек.</Item>
					<Item>Предопределённый элемент "Готівка" используется по умолчанию для товаров без явно указанной ФОП.</Item>
					<Item>Заменяет прежнюю логику разделения чеков на наличные/безналичные (КассаБезналичных), обеспечивая более гибкую группировку.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-02-11">Создание справочника ФОП для группировки позицій фіскальних чеків за формами оплат. Додано предвизначений елемент "Готівка".</Record>
			</Block>
		</Object>
	</Catalogs>

    <Documents>
		<Object name="КассоваяСмена" synonym="Кассовая смена">
        
        <Block name="Purpose">
            <Content>
                Документ, фиксирующий период работы (аналог Z-отчета). 
                Смена — понятие сугубо для чеков ККМ. Содержит детализацию по чекам ККМ (с привязкой к кассам) и фискальным чекам.
                Ограничивает возможность пробития чеков: чеки можно бить только в рамках ОТКРЫТОЙ смены.
            </Content>
        </Block>

        <Block name="DataModel">
            <Fields>
                <Field type="StandardAttribute" name="Дата">Дата открытия смены (стандартный реквизит).</Field>
                <Field type="StandardAttribute" name="Номер">Номер документа (стандартный реквизит).</Field>
                <Field type="Header" name="ДатаНачала" type_val="Дата">Время открытия смены.</Field>
                <Field type="Header" name="ДатаОкончания" type_val="Дата">Время закрытия смены.</Field>
                <Field type="Header" name="Статус" type_val="Перечисление.СтатусыКассовойСмены">Значения: Открыта, Закрыта.</Field>
            </Fields>
            <TabularSections>
                <TabularSection name="ЧекиККМ">
                    <Field name="Касса" type_val="Справочник.Кассы">Касса, на которой пробит чек.</Field>
                    <Field name="ЧекККМ" type_val="Документ.ЧекККМ">Ссылка на документ чека ККМ.</Field>
                    <Field name="Сумма" type_val="Число(15,2)">Сумма чека.</Field>
                    <Field name="СуммаСкидки" type_val="Число(15,2)">Сумма скидки по чеку.</Field>
                </TabularSection>
                <TabularSection name="ФискальныеЧеки">
                    <Field name="ВидОперации" type_val="Перечисление.ВидыОперацийФискальногоЧека">Вид операции фискального чека: Продажа, Возврат, Внесение, Изъятие, Z-отчет.</Field>
                    <Field name="ФОП" type_val="Справочник.ФОП">Форма оплаты фискального чека.</Field>
                    <Field name="ФискальныйНомер" type_val="Строка(50)">Фискальный номер чека от ПРРО/ГНС.</Field>
                    <Field name="Сумма" type_val="Число(15,2)">Сумма фискального чека.</Field>
                    <Field name="ФискальныйЧек" type_val="Документ.ФискальныйЧек">Ссылка на документ фискального чека.</Field>
                </TabularSection>
            </TabularSections>
        </Block>

        <Block name="Logic">
            <Items>
                <Item event="ПередЗаписью">
                    Контроль уникальности: запрещено наличие более одной открытой смены одновременно.
                </Item>
                <Item event="ОбработкаПроверкиЗаполнения">
                    Обязательные поля: ДатаНачала. Для закрытых смен обязательно поле ДатаОкончания.
                    ДатаОкончания не может быть раньше ДатаНачала.
                </Item>
                <Item event="РМК">
                    При запуске РМК ищется смена со статусом "Открыта". Если не найдена — предлагается создать новую.
                    Кнопка "Закрыть смену" доступна в РМК. После закрытия предлагается открыть новую смену.
                </Item>
                <Item event="Метод.ЗакрытьСмену">
                    Устанавливает ДатаОкончания = ТекущаяДатаСеанса(), меняет Статус на "Закрыта", проводит документ.
                </Item>
            </Items>
        </Block>

        <Block name="Interface">
            <Items>
                <Item>Форма документа содержит кнопку "Закрыть смену" (доступна только для открытых смен).</Item>
                <Item>После закрытия смены таблицы ЧекиККМ, ФискальныеЧеки и поле ДатаНачала становятся доступны только для просмотра.</Item>
            </Items>
        </Block>

        <Block name="History">
            <Record date="2025-10-01">Создание объекта.</Record>
            <Record date="2026-01-15">Изменение типа "Статус" со Строки на Перечисление. Переименование "КассаККМ" -> "Касса".</Record>
            <Record date="2026-01-24">Реализован механизм закрытия смены: добавлен модуль объекта с контролем уникальности, форма документа с кнопкой закрытия, интеграция с РМК.</Record>
            <Record date="2026-02-11">Переработка структуры: убран реквизит Касса из шапки. Добавлены ТЧ ЧекиККМ (Касса, ЧекККМ, Сумма, СуммаСкидки) и ФискальныеЧеки (ФОП, ФискальныйНомер, Сумма, ФискальныйЧек). Контроль уникальности теперь глобальный (не более 1 открытой смены).</Record>
            <Record date="2026-02-12">Добавлен реквизит ВидОперации (Перечисление.ВидыОперацийФискальногоЧека) в ТЧ ФискальныеЧеки. Значения: Продажа, Возврат, Внесение, Изъятие, ZОтчет.</Record>
        </Block>
    </Object>

		<Object name="ЧекККМ" synonym="Розничный чек">
			
			<Block name="Purpose">
				<Content>
					Фиксация факта розничной продажи. Списывает товары со склада, фиксирует выручку и генерирует фискальный номер.
				</Content>
			</Block>

			<Block name="DataModel">
				<Fields>
					<Field type="Header" name="КассоваяСмена" type_val="Документ.КассоваяСмена">Связь со сменой.</Field>
					<Field type="Header" name="Касса" type_val="Справочник.Кассы">Касса пробития.</Field>
					<Field type="Header" name="Склад" type_val="Справочник.Склады">Склад списания остатков.</Field>
					<Field type="Header" name="СуммаДокумента" type_val="Число(15,2)">Итоговая сумма.</Field>
					<Field type="Header" name="ДисконтнаяКарта" type_val="Справочник.ДисконтныеКарты">Дисконтная карта клиента (опционально).</Field>
					<Field type="Header" name="Статус" type_val="Перечисление.СтатусыЧекаККМ">Пробит, Аннулирован, Отложен.</Field>
					
					<Field type="TabularSection" name="Товары.Номенклатура" type_val="Справочник.Номенклатура">Товар.</Field>
					<Field type="TabularSection" name="Товары.Количество" type_val="Число(15,3)">Количество.</Field>
					<Field type="TabularSection" name="Товары.Цена" type_val="Число(15,2)">Цена продажи.</Field>
					<Field type="TabularSection" name="Товары.Сумма" type_val="Число(15,2)">Сумма строки.</Field>
					<Field type="TabularSection" name="Товары.СуммаСкидки" type_val="Число(15,2)">Сумма скидки на товар.</Field>
					<Field type="TabularSection" name="Товары.АкцизнаяМарка" type_val="Строка(200)">Код маркировки (Обязателен для акциза).</Field>
					<Field type="TabularSection" name="Товары.НалоговаяГруппа" type_val="Справочник.НалоговыеГруппы">Ставка НДС для чека.</Field>

					<Field type="TabularSection" name="Оплата.ВидОплаты" type_val="Перечисление.ВидыОплаты">Наличные / Безналичные / Бонусы.</Field>
					<Field type="TabularSection" name="Оплата.Сумма" type_val="Число(15,2)">Сумма оплаты.</Field>
				</Fields>
			</Block>

			<Block name="Logic">
				<Items>
					<Item event="ОбработкаПроведения">
						Формирует движения: Расход по регистру "ОстаткиТоваров", Приход по регистру "Продажи".
					</Item>
					<Item event="Контроль">
						Если товар имеет флаг "ТребуетАкцизнуюМарку", поле "Товары.АкцизнаяМарка" должно быть заполнено.
					</Item>
				</Items>
			</Block>

			<Block name="Interface">
				<Items>
					<Item>Основная форма работы — Обработка "РабочееМестоКассира" (РМК), а не форма документа.</Item>
					<Item>Перед пробитием вызывается диалог выбора метода оплаты (Нал/Карта).</Item>
				</Items>
			</Block>

			<Block name="History">
				<Record date="2025-10-10">Базовая версия.</Record>
				<Record date="2026-01-15">Адаптация под Украину: Добавлены поля "ФискальныйНомер" (вместо Признака), "АкцизнаяМарка", "НалоговаяГруппа".</Record>
			</Block>
		</Object>
		
		<Object name="ПриходТовара" synonym="Приход товара">
			<Block name="Purpose">
				<Content>Отражение поступления товаров от поставщика на склад.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Header" name="Контрагент" type_val="Справочник.Контрагенты">Поставщик.</Field>
					<Field type="Header" name="Склад" type_val="Справочник.Склады">Место приемки.</Field>
					<Field type="Header" name="ВходящийНомер" type_val="Строка(20)">Номер накладной поставщика.</Field>
					<Field type="Header" name="СуммаДокумента" type_val="Число(15,2)">Общая сумма.</Field>
					<Field type="TabularSection" name="Товары.Штрихкод" type_val="Строка(200)">Штрихкод для поиска товара.</Field>
					<Field type="TabularSection" name="Товары.Номенклатура" type_val="Справочник.Номенклатура"/>
					<Field type="TabularSection" name="Товары.Количество" type_val="Число(15,3)"/>
					<Field type="TabularSection" name="Товары.Цена" type_val="Число(15,2)">Закупочная цена.</Field>
					<Field type="TabularSection" name="Товары.Сумма" type_val="Число(15,2)"/>
					<Field type="TabularSection" name="Товары.ЦенаРозничнаяТекущая" type_val="Число(15,2)">Текущая розничная цена товара.</Field>
					<Field type="TabularSection" name="Товары.ЦенаРозничнаяНовая" type_val="Число(15,2)">Для быстрой переоценки.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item event="ОбработкаПроведения">Движения: Приход по "ОстаткиТоваров", Приход по "Взаиморасчеты" (увеличение долга перед поставщиком), Запись закупочной цены в "ЦеныНоменклатуры" с типом цен "Закупочная".</Item>
					<Item event="ОбработкаПроведения">Автоматическая переоценка: если заполнено поле "ЦенаРозничнаяНовая" (> 0), создаётся запись в регистре "ЦеныНоменклатуры" с основным типом цен из настроек.</Item>
					<Item event="ТоварыШтрихкодПриИзменении">При вводе штрихкода производится поиск товара в регистре "Штрихкоды", автозаполнение поля "Номенклатура" и перевод фокуса на "Количество".</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
				<Record date="2026-01-25">Добавлена автоматическая переоценка розничных цен при проведении документа. При заполнении поля "ЦенаРозничнаяНовая" создаются движения по регистру "ЦеныНоменклатуры".</Record>
				<Record date="2026-01-25">Добавлена колонка "Штрихкод" для работы со сканером. Реализован поиск товара по штрихкоду с автоматическим переходом на поле "Количество".</Record>
				<Record date="2026-01-29">Изменена логика записи закупочных цен: вместо отдельного регистра "ЦеныЗакупки" используется "ЦеныНоменклатуры" с типом цен "Закупочная".</Record>
			</Block>
		</Object>

		<Object name="СписаниеТовара" synonym="Списание товара">
			<Block name="Purpose">
				<Content>Списание товаров (порча, инвентаризация, собственные нужды).</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Header" name="Склад" type_val="Справочник.Склады"/>
					<Field type="TabularSection" name="Товары.Штрихкод" type_val="Строка(200)">Штрихкод для поиска товара.</Field>
					<Field type="TabularSection" name="Товары.Номенклатура" type_val="Справочник.Номенклатура"/>
					<Field type="TabularSection" name="Товары.Количество" type_val="Число(15,3)"/>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item event="ОбработкаПроведения">Движения: Расход по "ОстаткиТоваров".</Item>
					<Item event="ПриИзменении">Клиентский контроль при изменении количества товара - проверка против остатков на складе и предупреждение/сокращение при превышении доступного остатка.</Item>
					<Item event="ТоварыШтрихкодПриИзменении">При вводе штрихкода производится поиск товара в регистре "Штрихкоды", автозаполнение поля "Номенклатура" и сброс количества для переввода.</Item>
					<Item event="ПередЗаписью">Серверный контроль наличия обязательных реквизитов (Склад, Товары).</Item>
					<Item event="Контроль">Если константа "КонтролироватьОстатки" = Истина, проверяет наличие товара на складе при проведении документа.</Item>
				</Items>
			</Block>
			<Block name="Interface">
				<Items>
					<Item>Форма документа с таблицей товаров, где каждое изменение количества проверяется против остатков.</Item>
					<Item>При попытке списать больше остатка, система показывает предупреждение и сокращает количество до доступного остатка.</Item>
					<Item>Поле "Штрихкод" в таблице товаров позволяет быстро найти товар по его штрихкоду из регистра.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
				<Record date="2026-01-25">Добавлен контроль по остатку: клиентский контроль при редактировании количества в табличной части, серверный контроль при записи и проведении.</Record>
				<Record date="2026-01-25">Добавлено поле "Штрихкод" в таблицу "Товары" с функционалом поиска товара по штрихкоду из регистра "Штрихкоды" (по аналогии с документом "ПриходТовара").</Record>
			</Block>
		</Object>

		<Object name="ИнвентаризацияТоваров" synonym="Инвентаризация товаров">
			<Block name="Purpose">
				<Content>Фиксация фактического наличия товаров для сравнения с учетным.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Header" name="Склад" type_val="Справочник.Склады"/>
					<Field type="TabularSection" name="Товары.Номенклатура" type_val="Справочник.Номенклатура"/>
					<Field type="TabularSection" name="Товары.УчетноеКоличество" type_val="Число(15,3)">Остаток по программе.</Field>
					<Field type="TabularSection" name="Товары.ФактическоеКоличество" type_val="Число(15,3)">Остаток по факту.</Field>
					<Field type="TabularSection" name="Товары.Отклонение" type_val="Число(15,3)">Разница.</Field>
					<Field type="TabularSection" name="Товары.Штрихкод" type_val="Строка(200)">Штрихкод для поиска товара.</Field>
					<Field type="TabularSection" name="Товары.Цена" type_val="Число(15,2)">Закупочная цена товара.</Field>
					<Field type="TabularSection" name="Товары.Сумма" type_val="Число(15,2)">Сумма факт.кол-во × Цена.</Field>
					<Field type="TabularSection" name="Товары.СуммаНедостачиИзлишков" type_val="Число(15,2)">Сумма (Отклонение × Цена).</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Не делает движений (является основанием для Списания/Оприходования).</Item>
					<Item event="Заполнение">Автозаполнение учетными количествами на дату документа.</Item>
					<Item>Поиск товара по штрихкоду (синхронный с регистром Штрихкоды).</Item>
					<Item>Автоматический расчет отклонения и сумм недостачи/излишков.</Item>
					<Item>Сохранение фактических количеств при повторном заполнении по остаткам.</Item>
					<Item>Товары с нулевыми остатками, но введенными фактическими количествами, сохраняются в ТЧ.</Item>
				</Items>
			</Block>
			<Block name="Interface">
				<Items>
					<Item>Команда "Заполнить" - загружает товары по остаткам склада на дату документа.</Item>
					<Item>Команда "Напечатать результат" - формирует печатную форму переучета (ПОКА НЕ РЕАЛИЗОВАНА ПОЛНОСТЬЮ).</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
				<Record date="2026-01-25">Добавлены поля Штрихкод, Цена, Сумма, СуммаНедостачиИзлишков. Реализована логика поиска по штрихкоду, автоматический расчет отклонений и сумм. Добавлена команда печати результатов (пока не полностью реализована).</Record>
			</Block>
		</Object>

		<Object name="Переоценка" synonym="Переоценка">
			<Block name="Purpose">
				<Content>Установка новых цен продаж.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Header" name="ТипЦен" type_val="Справочник.ТипыЦен"/>
					<Field type="TabularSection" name="Товары.Штрихкод" type_val="Строка(50)">Штрихкод для поиска номенклатуры.</Field>
					<Field type="TabularSection" name="Товары.Номенклатура" type_val="Справочник.Номенклатура"/>
					<Field type="TabularSection" name="Товары.СтараяЦена" type_val="Число(15,3)">Текущая цена до переоценки (только для просмотра).</Field>
					<Field type="TabularSection" name="Товары.Цена" type_val="Число(15,3)">Новая цена.</Field>
					<Field type="TabularSection" name="Товары.ПроцентИзменения" type_val="Число(10,2)">Процент изменения цены от старой (только для просмотра).</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item event="ПриСозданииНаСервере">Автозаполнение реквизита "ТипЦен" из настроек по умолчанию (НастройкиПоУмолчанию.ПолучитьОсновнойТипЦен()) при создании нового документа.</Item>
					<Item event="ТоварыШтрихкодПриИзменении">Поиск номенклатуры по штрихкоду в регистре сведений "Штрихкоды". При нахождении заполняется номенклатура, старая цена и новая цена (равная старой).</Item>
					<Item event="ТоварыНоменклатураПриИзменении">Получение текущей цены номенклатуры из регистра "ЦеныНоменклатуры" и заполнение поля "СтараяЦена". Если новая цена = 0, устанавливается равной старой.</Item>
					<Item event="ТоварыЦенаПриИзменении">Автоматический расчёт процента изменения цены по формуле: ((НоваяЦена - СтараяЦена) / СтараяЦена) * 100.</Item>
					<Item event="ОбработкаПроведения">Запись в периодический регистр сведений "ЦеныНоменклатуры".</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
				<Record date="2026-01-25">Добавлены реквизиты: "Штрихкод", "СтараяЦена", "ПроцентИзменения". Реализован поиск по штрихкоду и автоматический расчёт процента изменения цены. Добавлено автозаполнение типа цены из настроек по умолчанию.</Record>
			</Block>
		</Object>

		<Object name="ФискальныйЧек" synonym="Фискальный чек">
			<Block name="Purpose">
				<Content>Технический документ, сохраняющий ответ от фискального регистратора/ПРРО.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Header" name="ДокументОснование" type_val="Документ.ЧекККМ">Чек ККМ, который был пробит.</Field>
					<Field type="Header" name="ФискальныйНомер" type_val="Строка(50)">Номер от ПРРО/ГНС.</Field>
					<Field type="Header" name="НомерЧекаККМ" type_val="Строка(50)">Внутренний номер чека.</Field>
					<Field type="Header" name="Сумма" type_val="Число(15,2)">Итоговая сумма чека.</Field>
					<Field type="Header" name="Оборудование" type_val="Справочник.КассовоеОборудование">ККТ, выполнившая фискализацию.</Field>
					<Field type="TabularSection" name="Товары.Номенклатура" type_val="Справочник.Номенклатура">Товар.</Field>
					<Field type="TabularSection" name="Товары.Количество" type_val="Число(15,3)">Количество.</Field>
					<Field type="TabularSection" name="Товары.Цена" type_val="Число(15,2)">Цена.</Field>
					<Field type="TabularSection" name="Товары.Сумма" type_val="Число(15,2)">Сумма строки.</Field>
					<Field type="TabularSection" name="Товары.СуммаСкидки" type_val="Число(15,2)">Сумма скидки.</Field>
					<Field type="TabularSection" name="Товары.АкцизнаяМарка" type_val="Строка(200)">Акцизная марка.</Field>
					<Field type="TabularSection" name="Товары.НалоговаяГруппа" type_val="Справочник.НалоговыеГруппы">Налоговая группа.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Создается программно при успешной фискализации чека. Один ФискальныйЧек соответствует одному ЧекККМ.</Item>
					<Item>Оборудование (ККТ) берётся из реквизита Касса.Оборудование документа-основания (ЧекККМ). Распределение по НалоговаяГруппа через регистр НастройкиРаспределенияПродаж более не применяется.</Item>
					<Item>Не делает движений по складским регистрам (это делает ЧекККМ).</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
				<Record date="2026-02-11">Переработана логика фискализации: один ФискальныйЧек на один ЧекККМ, оборудование берётся из карточки кассы (Касса.Оборудование) вместо распределения через НастройкиРаспределенияПродаж.</Record>
			</Block>
		</Object>

		<Object name="ПриходныйКассовыйОрдер" synonym="Приходный кассовый ордер">
			<Block name="Purpose">
				<Content>Поступление наличных денежных средств в кассу.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="StandardAttribute" name="Дата">Дата поступления (стандартный реквизит).</Field>
					<Field type="StandardAttribute" name="Номер">Номер документа (стандартный реквизит).</Field>
					<Field type="Header" name="Касса" type_val="Справочник.Кассы">Касса, в которую поступили деньги.</Field>
					<Field type="Header" name="СуммаДокумента" type_val="Число(15,2)">Сумма поступления.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item event="ОбработкаПроведения">Приход по регистру "ДенежныеСредства".</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
				<Record date="2026-01-17">Дополнение спецификации полной структурой согласно стандарту.</Record>
				<Record date="2026-02-11">Реализация: XML-структура, модуль объекта (проведение по ДенежныеСредства), форма документа. Деплой.</Record>
			</Block>
		</Object>

		<Object name="РасходныйКассовыйОрдер" synonym="Расходный кассовый ордер">
			<Block name="Purpose">
				<Content>Выдача наличных денежных средств из кассы.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="StandardAttribute" name="Дата">Дата выдачи (стандартный реквизит).</Field>
					<Field type="StandardAttribute" name="Номер">Номер документа (стандартный реквизит).</Field>
					<Field type="Header" name="Касса" type_val="Справочник.Кассы">Касса, из которой выданы деньги.</Field>
					<Field type="Header" name="СуммаДокумента" type_val="Число(15,2)">Сумма выдачи.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item event="ОбработкаПроведения">Расход по регистру "ДенежныеСредства".</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
				<Record date="2026-01-17">Дополнение спецификации полной структурой согласно стандарту.</Record>
				<Record date="2026-02-11">Реализация: XML-структура, модуль объекта (проведение по ДенежныеСредства), форма документа. Деплой.</Record>
			</Block>
		</Object>

		<Object name="ВозвратТовараОтПокупателя" synonym="Возврат товара от покупателя">
			<Block name="Purpose">
				<Content>Оформление возврата товара от клиента. Поддерживает два режима: фискальный возврат (с пробитием чека) и внутренний возврат (только влияет на остатки). Возврат можно оформить свободно (выбрать товар вручную) или по конкретному чеку.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="StandardAttribute" name="Дата">Дата возврата.</Field>
					<Field type="StandardAttribute" name="Номер">Номер документа.</Field>
					<Field type="Header" name="ДокументОснование" type_val="Документ.ЧекККМ">Чек, по которому произведена продажа (опционально).</Field>
					<Field type="Header" name="Склад" type_val="Справочник.Склады">Склад, на который возвращается товар.</Field>
					<Field type="Header" name="ФискальныйВозврат" type_val="Булево">Признак фискального возврата (с пробитием чека возврата).</Field>
					<Field type="TabularSection" name="Товары">Товары для возврата.</Field>
					<Field type="TabularSection" name="Товары.Номенклатура" type_val="Справочник.Номенклатура">Номенклатура товара.</Field>
					<Field type="TabularSection" name="Товары.Количество" type_val="Число(15,3)">Количество к возврату.</Field>
					<Field type="TabularSection" name="Товары.Цена" type_val="Число(15,2)">Цена товара.</Field>
					<Field type="TabularSection" name="Товары.Сумма" type_val="Число(15,2)">Сумма возврата.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item event="ОбработкаЗаполнения">Если основание - Документ.ЧекККМ, заполняет товары из чека и склад из чека. Иначе (свободный возврат) - заполняет склад из НастройкиПоУмолчанию.ПолучитьОсновнойСклад().</Item>
					<Item event="ОбработкаПроведения">1. Приход товаров по регистру "ОстаткиТоваров". 2. Если ФискальныйВозврат=Истина, сторнирование продаж в регистре "Продажи".</Item>
				</Items>
			</Block>
			<Block name="Forms">
				<Items>
					<Item name="ФормаВыбораРежимаВозврата">Форма выбора режима возврата (по чеку или свободный) с выбором типа (фискальный/внутренний).</Item>
				</Items>
			</Block>
			<Block name="Integration">
				<Items>
					<Item context="РМК">Вызывается через кнопку "ВОЗВРАТ" в форме РабочееМестоКассира. Предлагает выбор режима, затем открывает форму документа.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
				<Record date="2026-01-17">Дополнение спецификации полной структурой согласно стандарту.</Record>
				<Record date="2026-01-24">Реализация возврата товара: добавлены реквизиты (Склад, ФискальныйВозврат, ДокументОснование), табличная часть Товары, модуль объекта с проведением, формы выбора режима и чека, интеграция с РМК.</Record>
				<Record date="2026-01-24">Исправлена регистрация формы ФормаВыбораРежимаВозврата: добавлены записи в ConfigDumpInfo.xml для формы и всех реквизитов документа.</Record>
				<Record date="2026-01-24">Добавлена логика автозаполнения склада из НастройкиПоУмолчанию для свободного возврата.</Record>
				<Record date="2026-01-25">ИСПРАВЛЕНИЕ: Добавлена регистрация документа как регистратора для регистров накопления "ОстаткиТоваров" и "Продажи". Без этого метод Движения.ОстаткиТоваров недоступен при проведении.</Record>
			</Block>
		</Object>
	</Documents>

    <Enums>
	
		<Object name="ВидыНоменклатуры" synonym="Виды номенклатуры">
			<Block name="Purpose"><Content>Разделение типов запасов.</Content></Block>
			<Block name="DataModel">
				<Fields><Field name="Значения">Товар, Услуга.</Field></Fields>
			</Block>
		</Object>

		<Object name="СтавкиНДС" synonym="Ставки НДС">
			<Block name="Purpose"><Content>Ставки налогообложения (Адаптация: Украина).</Content></Block>
			<Block name="DataModel">
				<Fields><Field name="Значения">НДС20 (20%), НДС7 (7%), НДС0 (0%), БезНДС.</Field></Fields>
			</Block>
			<Block name="History"><Record date="2026-01-15">Добавлены ставки 7% и 0%.</Record></Block>
		</Object>

		<Object name="СтатусыЧекаККМ" synonym="Статусы чека">
			<Block name="Purpose"><Content>Жизненный цикл чека.</Content></Block>
			<Block name="DataModel">
				<Fields><Field name="Значения">Пробит, Отложен, Аннулирован.</Field></Fields>
			</Block>
		</Object>
    
		<Object name="СтатусыКассовойСмены" synonym="Статусы смены">
			<Block name="Purpose"><Content>Жизненный цикл смены (Z-отчет).</Content></Block>
			<Block name="DataModel">
				<Fields><Field name="Значения">Открыта, Закрыта.</Field></Fields>
			</Block>
			<Block name="History"><Record date="2026-01-15">Объект создан для исправления ошибки типизации в РМК.</Record></Block>
		</Object>

		<Object name="ВидыОплаты" synonym="Виды оплаты">
			<Block name="Purpose"><Content>Способы расчета, поддерживаемые ККМ и кассиром.</Content></Block>
			<Block name="DataModel">
				<Fields><Field name="Значения">Наличные, Безналичные, Бонусы.</Field></Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Наличные: оплата наличными деньгами с зарегистрированием в ПРРО.</Item>
					<Item>Безналичные: оплата картой или переводом; требует авторизации.</Item>
					<Item>Бонусы: оплата за счет бонусных баллов дисконтной карты (Перечисление.ВидыОплаты = Бонусы).</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-17">Обновление видов оплаты: Карта -> Безналичные; добавлены Бонусы для поддержки дисконтных карт.</Record>
			</Block>
		</Object>

		<Object name="ТипыОборудования" synonym="Типы оборудования">
			<Block name="Purpose">
				<Content>Список поддерживаемых видов периферийного оборудования.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field name="Значения">СканерШтрихкода, ПринтерЧеков, ККТ.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Определяет логику работы в "МенеджерОборудования".</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
			</Block>
		</Object>

		<Object name="ЕдиницыИзмерения" synonym="Единицы измерения">
			<Block name="Purpose">
				<Content>Стандартные единицы для номенклатуры.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field name="Значения">шт, кг, л, м.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Используется для вывода в печатные формы.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
			</Block>
		</Object>

		<Object name="ПорядкиОкругленияЦен" synonym="Порядки округления цен">
			<Block name="Purpose">
				<Content>Варианты алгоритмов округления.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field name="Значения">Окр001 (0.01), Окр010 (0.10), Окр050 (0.50), Окр100 (1.00), ОкрВБольшую.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Используется в алгоритмах расчета цен.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
			</Block>
		</Object>

		<Object name="ВидыКасс" synonym="Виды касс">
			<Block name="Purpose">
				<Content>Разделяет кассы на наличные и банковские счета. При оплате через кассу вида "Банковский счет" запрашивается подтверждение.</Content>
			</Block>
			<Block name="DataModel">
				<Values>
					<Value name="Наличная">Касса для наличных расчётов.</Value>
					<Value name="БанковскийСчет">Касса привязанная к банковскому счёту. При оплате требуется подтверждение.</Value>
				</Values>
			</Block>
			<Block name="History">
				<Record date="2026-02-11">Создание перечисления для разделения касс на наличные и банковские счета.</Record>
			</Block>
		</Object>

		<Object name="ВидыОперацийФискальногоЧека" synonym="Виды операций фискального чека">
			<Block name="Purpose">
				<Content>Определяет тип операции в фискальном чеке: продажа, возврат, внесение денежных средств, изъятие или Z-отчет.</Content>
			</Block>
			<Block name="DataModel">
				<Values>
					<Value name="Продажа">Операция продажи товаров.</Value>
					<Value name="Возврат">Операция возврата товаров.</Value>
					<Value name="Внесение">Операция внесения денежных средств в кассу.</Value>
					<Value name="Изъятие">Операция изъятия денежных средств из кассы.</Value>
					<Value name="ZОтчет">Закрытие кассовой смены (Z-отчет).</Value>
				</Values>
			</Block>
			<Block name="History">
				<Record date="2026-02-12">Создание перечисления для классификации операций фискальных чеков.</Record>
			</Block>
		</Object>
	</Enums>

    <DataProcessors>
		<Object name="РабочееМестоКассира" synonym="РМК (Рабочее место кассира)">
        
			<Block name="Purpose">
				<Content>
					Основной рабочий интерфейс кассира для подбора товаров, управления текущей группой номенклатуры 
					и оформления чеков. Поддерживает быстрый поиск по штрихкодам и артикулам с асинхронной обработкой платежей.
				</Content>
			</Block>

			<Block name="DataModel">
				<Fields>
					<Field type="Attribute" name="ТекущаяГруппа" type_val="Справочник.Номенклатура">Текущая выбранная группа товаров для фильтрации и быстрого доступа.</Field>
					<Field type="Attribute" name="ПолеПоискаТовара" type_val="Строка(100)">Основной поиск: Штрихкод, Артикул или наименование товара (synonym: "Штрихкод (основной)").</Field>
					<Field type="Attribute" name="ПолеПоискаТовара2" type_val="Строка">Дополнительный поиск: Альтернативный штрихкод или артикул (synonym: "Штрихкод (дополнительный)").</Field>
					<Field type="Attribute" name="Касса" type_val="Справочник.Кассы">Контекст: Касса текущей сессии.</Field>
					<Field type="Attribute" name="КассоваяСмена" type_val="Документ.КассоваяСмена">Контекст: Открытая кассовая смена.</Field>
					<Field type="Attribute" name="РежимРаботы" type_val="Строка(20)">Режим работы кассы: "Продажа" или "Возврат". По умолчанию "Продажа".</Field>
					<Field type="Attribute" name="ЧекДляВозврата" type_val="Документ.ЧекККМ">Ссылка на чек-основание при возврате по чеку.</Field>
					<Field type="TabularSection" name="ТЧ.Номенклатура" type_val="Справочник.Номенклатура">Товар, добавленный в корзину.</Field>
					<Field type="TabularSection" name="ТЧ.Количество" type_val="Число">Количество товара.</Field>
					<Field type="TabularSection" name="ТЧ.Цена" type_val="Число">Розничная цена за единицу.</Field>
					<Field type="TabularSection" name="ТЧ.Сумма" type_val="Число">Итоговая сумма строки (Количество × Цена).</Field>
					<Field type="TabularSection" name="ТЧ.АкцизнаяМарка" type_val="Строка(200)">Код акцизной марки (для подакцизного товара).</Field>
				</Fields>
			</Block>

			<Block name="Logic">
				<Items>
					<Item event="ПриОткрытии">
						Проверка наличия открытой смены. Если смена закрыта — асинхронный диалог "Открыть смену?". 
						При отказе окно кассира блокируется; при согласии открывается документ КассоваяСмена.
						Инициализация режима работы в "Продажа".
					</Item>
					<Item event="ПодборТовара">
						Использует модуль ОбщегоНазначения.НайтиТоварыПоШтрихкоду() для поиска товара 
						по основному и дополнительному штрихкоду через регистр Штрихкоды.
						Если товар требует акциз (`Номенклатура.ТребуетАкцизнуюМарку`), открывается окно ввода акцизной марки.
						Товар добавляется в ТЧ только при успешном вводе всех требуемых параметров.
						В режиме возврата товары добавляются для последующего возврата.
					</Item>
					<Item event="Оплата">
						Кнопка "РАССЧИТАТЬ"/"ОФОРМИТЬ ВОЗВРАТ" вызывает асинхронный диалог выбора вида оплаты.
						В режиме "Продажа": создается документ ЧекККМ с соответствующей суммой и типом оплаты.
						В режиме "Возврат": создается документ ВозвратТовараОтПокупателя с указанием способа возврата денег.
					</Item>
					<Item event="ПереключениеРежима">
						Кнопка "ВОЗВРАТ" переключает в режим возврата. Предлагает два варианта:
						1. "Свободный возврат" — ручной ввод товаров для возврата.
						2. "Возврат по чеку" — открывает форму выбора чека, затем заполняет ТЧ товарами из чека.
						Кнопка "ПРОДАЖА" возвращает в режим продажи.
						При переключении между режимами требуется очистка ТЧ.
					</Item>
				</Items>
			</Block>

			<Block name="Interface">
				<Items>
					<Item>Динамическая панель быстрых товаров (кнопки товаров из текущей группы ТекущаяГруппа).</Item>
					<Item>Адаптивная подстановка размера шрифта и кнопок под разрешение экрана ККМ/планшета.</Item>
					<Item>Перехват ввода сканером штрихкодов с автоматической трансляцией в ПолеПоискаТовара.</Item>
					<Item>Асинхронные всплывающие диалоги (Оповещение с CallbackDescription) для платежей и акцизных марок.</Item>
				</Items>
			</Block>

			<Block name="Dependencies">
				<Items>
					<Item>Модуль ОбщегоНазначения: НайтиТоварыПоШтрихкоду(), ПолучитьРозничнуюЦену().</Item>
					<Item>Модуль МенеджерОборудования: ПодключитьСканер(), НапечататьЧек().</Item>
					<Item>Регистр Штрихкоды: поиск товаров по штрихкодам.</Item>
					<Item>Регистр ЦеныНоменклатуры: получение розничных цен.</Item>
					<Item>Документ ЧекККМ: регистрация продаж и создание движений в Продажи.</Item>
				</Items>
			</Block>

			<Block name="History">
				<Record date="2025-10-15">Внедрение глобального поиска по Штрихкоды и динамической панели быстрых товаров.</Record>
				<Record date="2026-01-15">Адаптация под Украину: поддержка акцизных марок, логика смены, интеграция с ККМ.</Record>
				<Record date="2026-01-17">Обновление описания реквизитов, асинхронная обработка платежей, расширенный поиск товара.</Record>
				<Record date="2026-01-21">Добавлен перенос текста на кнопках товаров: названия длиннее 20 символов разбиваются по словам и отображаются на нескольких строках (функция ПреобразоватьТекстДляКнопки).</Record>
				<Record date="2026-01-24">Исправлены обращения к несуществующему реквизиту Объект.Склад: заменены на вызов функции ПолучитьСкладРозница() во всех местах передачи склада в параметры форм возврата.</Record>
				<Record date="2026-01-24">Оптимизация: добавлен реквизит формы "Склад", который инициализируется один раз при открытии формы из регистра НастройкиПоУмолчанию.ПолучитьОсновнойСклад(). Функция ПолучитьСкладРозница() теперь также использует регистр настроек.</Record>
				<Record date="2026-01-24">Реализация режимов работы кассы: добавлены реквизиты РежимРаботы и ЧекДляВозврата, команды переключения режимов (ВОЗВРАТ/ПРОДАЖА). При возврате: выбор между свободным возвратом и возвратом по чеку. При возврате по чеку ТЧ заполняется товарами из выбранного чека. Кнопка РАССЧИТАТЬ меняет поведение в зависимости от режима.</Record>
				<Record date="2026-01-25">ИСПРАВЛЕНИЕ: Добавлен вызов РассчитатьИтоги() после заполнения ТЧ товарами из чека при возврате по чеку. Теперь после выбора чека итоговая сумма корректно отображается на форме.</Record>
				<Record date="2026-02-11">Переработка фискализации: позиции чека теперь группируются по ФОП (Справочник.ФОП) из номенклатуры вместо прежнего разделения наличные/безналичные. Для каждой уникальной ФОП создаётся отдельный фискальный чек. Удалена настройка КассаБезналичных.</Record>
			</Block>
		</Object>

		<Object name="ЗаполнениеНоменклатуры" synonym="Заполнение номенклатуры">
        
			<Block name="Purpose">
				<Content>
					Административная обработка для массового заполнения, импорта и актуализации справочника Номенклатура.
					Используется для начального завоза товаров, обновления прайсов и переоценки.
				</Content>
			</Block>

			<Block name="Logic">
				<Items>
					<Item event="Импорт">
						Загрузка товаров из файла (CSV, Excel) с маппингом полей на реквизиты Номенклатуры.
						Поддерживает как создание новых позиций, так и обновление существующих по коду/артикулу.
					</Item>
					<Item event="ОбновлениеЦен">
						Массовое обновление цен товаров через регистр ЦеныНоменклатуры.
						Позволяет применять разные цены по типам цен (Розничная, Оптовая и т.д.).
					</Item>
					<Item event="Переоценка">
						Логика создания документов Переоценка при изменении прайсов.
						Автоматический расчет разниц между старой и новой ценой.
					</Item>
				</Items>
			</Block>

			<Block name="Interface">
				<Items>
					<Item>Форма загрузки файла с предпросмотром данных до подтверждения.</Item>
					<Item>Диалоги выбора критериев обновления (по дате изменения, по коду товара, полное обновление).</Item>
					<Item>Отчет о результатах обработки (добавлено/обновлено/ошибок).</Item>
				</Items>
			</Block>

			<Block name="Dependencies">
				<Items>
					<Item>Справочник Номенклатура: создание и обновление позиций.</Item>
					<Item>Регистр ЦеныНоменклатуры: обновление цен по типам.</Item>
					<Item>Документ Переоценка: логика массовой переоценки товаров.</Item>
					<Item>Справочник ТипыЦен: для маппинга типов цен из файла.</Item>
				</Items>
			</Block>

			<Block name="History">
				<Record date="2026-01-17">Добавление в спецификацию административной обработки загрузки и актуализации номенклатуры.</Record>
			</Block>
		</Object>

		<Object name="ТестовоеЗаполнениеЦен" synonym="Тестовое заполнение цен и штрихкодов">
        
			<Block name="Purpose">
				<Content>
					Вспомогательная обработка для автоматического заполнения тестовыми данными номенклатуры.
					Основные возможности: 
					1. Создание документов Переоценка с рандомными ценами для всей номенклатуры.
					2. Заполнение регистра Штрихкоды случайными 12-значными кодами для каждого товара.
				</Content>
			</Block>

			<Block name="DataModel">
				<Fields>
					<Field type="Attribute" name="МинимальнаяЦена" type_val="Число(10,0)">Нижняя граница диапазона для генерирования случайных цен (по умолчанию 10).</Field>
					<Field type="Attribute" name="МаксимальнаяЦена" type_val="Число(10,0)">Верхняя граница диапазона для генерирования случайных цен (по умолчанию 1000).</Field>
				</Fields>
			</Block>

			<Block name="Logic">
				<Items>
					<Item method="СоздатьПереоценкуКоманда" type="command">
						Асинхронная команда на форме.
						Создает документ Переоценка со сгенерированными случайными ценами для всей номенклатуры
						в диапазоне [МинимальнаяЦена, МаксимальнаяЦена].
						После создания документ проводится автоматически.
						Возвращает сообщение об успешном создании.
					</Item>
					<Item method="ЗаполнитьШтрихкодыКоманда" type="command">
						Асинхронная команда на форме.
						Запрашивает подтверждение пользователя.
						Для каждого товара в справочнике Номенклатура:
						1. Генерирует уникальный 12-значный штрихкод (числовая строка).
						2. Удаляет старые штрихкоды товара из регистра Штрихкоды.
						3. Записывает новый штрихкод в регистр Штрихкоды.
						При невозможности создать уникальный код за 100 попыток используется UUID.
						Возвращает количество обработанных товаров.
					</Item>
					<Item method="СгенерироватьУникальныйШтрихкод(Генератор)">
						Вспомогательная функция на сервере.
						Генерирует случайный 12-значный штрихкод и проверяет его уникальность в регистре Штрихкоды.
						Если генерация за 100 попыток не дала уникального кода, возвращает UUID-строку.
					</Item>
				</Items>
			</Block>

			<Block name="Interface">
				<Items>
					<Item>Две кнопки на форме: "Создать переоценку" и "Заполнить штрихкоды".</Item>
					<Item>Поля ввода для МинимальнаяЦена и МаксимальнаяЦена.</Item>
					<Item>Асинхронные диалоги подтверждения действий и уведомления о результатах.</Item>
				</Items>
			</Block>

			<Block name="Dependencies">
				<Items>
					<Item>Справочник Номенклатура: получение списка товаров.</Item>
					<Item>Документ Переоценка: создание и проведение документов переоценки.</Item>
					<Item>Регистр Штрихкоды: запись и удаление штрихкодов товаров.</Item>
				</Items>
			</Block>

			<Block name="History">
				<Record date="2026-01-20">Создание обработки для тестового заполнения цен.</Record>
				<Record date="2026-01-20">Добавление функционала заполнения штрихкодов случайными кодами для всей номенклатуры.</Record>
			</Block>
		</Object>
		
		<Object name="УправлениеНастройками" synonym="Управление настройками">
			<Block name="Purpose">
				<Content>Обработка с формой для удобного редактирования настроек по умолчанию из регистра НастройкиПоУмолчанию.</Content>
			</Block>
			<Block name="Interface">
				<Items>
					<Item>Форма содержит две вкладки: "Настройки заполнения" и "Настройки РМК".</Item>
					<Item>Вкладка "Настройки заполнения" - редактирование ОсновнойСклад, ОсновнойПоставщик, ОсновнаяКасса, ОсновнойТипЦен, ПорядокОкругленияЦен, КонтролироватьОстаткиПриСписании, ФискальныйРежим (вкл/откл фискальные продажи).</Item>
					<Item>Вкладка "Настройки РМК" - настройка панели быстрых товаров: количество кнопок в колонке/ряду, ширина и высота кнопок (в пиксели).</Item>
					<Item>Кнопка "Сохранить" - записывает изменения в регистр НастройкиПоУмолчанию.</Item>
					<Item>Кнопка "Закрыть" - закрывает форму без сохранения.</Item>
				</Items>
			</Block>
			<Block name="Logic">
				<Items>
					<Item method="ПриСозданииНаСервере">Загружает текущие значения из регистра НастройкиПоУмолчанию в реквизиты формы.</Item>
					<Item method="СохранитьНастройки">Записывает значения из формы в регистр (очищает старую запись и создает новую).</Item>
					<Item method="ИнициализироватьЗначенияПоУмолчанию">Заполняет недостающие настройки значениями по умолчанию (первые элементы справочников для ссылочных полей, предустановленные константы для остальных). Проверяет каждую настройку индивидуально.</Item>
					<Item>При обнаружении хотя бы одной пустой настройки автоматически вызывается инициализация и сохранение дефолтных значений в БД.</Item>
				</Items>
			</Block>
			<Block name="Dependencies">
				<Items>
					<Item>РегистрСведений.НастройкиПоУмолчанию - чтение и запись настроек.</Item>
					<Item>Справочники: Склады, Кассы, Контрагенты, ТипыЦен - для выбора значений.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-21">Создание обработки для централизованного управления настройками по умолчанию.</Record>
				<Record date="2026-01-21">Добавлены настройки РМК в отдельную вкладку: ширина и высота кнопок товаров.</Record>
				<Record date="2026-01-29">Улучшена инициализация: проверяется каждая настройка индивидуально, автоматическое сохранение дефолтных значений при первом запуске. Гарантируется отсутствие ошибок при работе с пустыми настройками.</Record>
				<Record date="2026-02-11">Добавлена настройка ФискальныйРежим (CheckBox) на вкладку "Настройки заполнения". Позволяет включать/отключать фискальные продажи (печать чеков на ККМ). По умолчанию включен.</Record>
			</Block>
		</Object>

		<Object name="ИмпортНоменклатуры" synonym="Импорт номенклатуры">
			<Block name="Purpose">
				<Content>
					Обработка для импорта номенклатуры из файлов Excel. 
					Позволяет загружать структуру справочника (группы и элементы) с автоматическим созданием иерархии 
					и настройкой соответствия единиц измерения между файлом и системой.
				</Content>
			</Block>

			<Block name="DataModel">
				<Fields>
					<Field type="Attribute" name="ПутьКФайлу" type_val="Строка">Путь к Excel файлу для импорта.</Field>
					<Field type="TabularSection" name="СоответствиеЕдиницИзмерения">Таблица соответствия единиц измерения из файла к системным значениям.</Field>
					<Field type="TabularSection" name="СоответствиеЕдиницИзмерения.ЕдиницаИзФайла" type_val="Строка(50)">Единица измерения из файла (текстовое значение).</Field>
					<Field type="TabularSection" name="СоответствиеЕдиницИзмерения.ЕдиницаВСистеме" type_val="Перечисление.ЕдиницыИзмерения">Соответствующее значение перечисления системы (шт, кг, л, м).</Field>
				</Fields>
			</Block>

			<Block name="Logic">
				<Items>
					<Item method="ЗаполнитьЕдиницыИзмеренияИзФайла">
						Считывает уникальные единицы измерения из столбца "Единица измерения" Excel файла 
						и заполняет первую колонку табличной части СоответствиеЕдиницИзмерения.
						Пользователь вручную выбирает соответствующие системные единицы во второй колонке.
					</Item>
					<Item method="ВыполнитьИмпорт">
						Выполняет полный импорт номенклатуры по алгоритму:
						1. Создание групп номенклатуры с соблюдением иерархии (по полям Родитель.Код, Родитель.Наименование).
						2. Создание элементов номенклатуры с указанием группы-родителя и единицы измерения из соответствия.
						Возвращает структуру результата: Успешно (Булево), СообщениеОбОшибке (Строка), КоличествоЗагружено (Число).
					</Item>
					<Item method="ПолучитьДанныеИзExcel">
						Вспомогательная функция, читает данные из Excel через COM-объект.
						Ожидаемые колонки файла (порядок фиксирован):
						A: ЭтоГруппа (да/истина/true/1 = группа, иначе элемент)
						B: Код
						C: Наименование
						D: Название на этикетке (зарезервировано, не используется в текущей версии)
						E: Единица измерения
						F: Родитель.Код
						G: Родитель.Наименование
						Возвращает таблицу значений с этими полями.
					</Item>
					<Item method="СоздатьГруппы">
						Обрабатывает строки с ЭтоГруппа=Истина, создает группы номенклатуры в транзакции.
						Группы создаются в порядке возрастания РодительКод для обеспечения корректной иерархии.
						Поиск существующих групп выполняется по коду.
					</Item>
					<Item method="СоздатьНоменклатуру">
						Обрабатывает строки с ЭтоГруппа=Ложь, создает элементы номенклатуры в транзакции.
						Устанавливает родителя по коду группы, единицу измерения из соответствия.
						Поиск существующих элементов выполняется по коду.
					</Item>
				</Items>
			</Block>

			<Block name="Interface">
				<Items>
					<Item>Поле "Путь к файлу" с кнопкой "Выбрать файл" для диалога выбора Excel файла.</Item>
					<Item>Кнопка "Загрузить единицы измерения" - заполняет табличную часть СоответствиеЕдиницИзмерения.</Item>
					<Item>Табличная часть для редактирования соответствий единиц измерения (две колонки: ЕдиницаИзФайла, ЕдиницаВСистеме).</Item>
					<Item>Кнопка "Выполнить импорт" - запускает процесс создания номенклатуры.</Item>
				</Items>
			</Block>

			<Block name="Dependencies">
				<Items>
					<Item>Справочник Номенклатура: создание групп и элементов с иерархией.</Item>
					<Item>Перечисление ЕдиницыИзмерения: маппинг единиц измерения из файла.</Item>
					<Item>COM-объект Excel.Application: чтение данных из XLSX файлов.</Item>
				</Items>
			</Block>

			<Block name="History">
				<Record date="2026-02-01">Создание обработки импорта номенклатуры из Excel с поддержкой иерархии, соответствия единиц измерения и проверки существующих элементов по коду.</Record>
			</Block>
		</Object>

		<Object name="ТестРеквизитов" synonym="Тест реквизитов">
			<Block name="Purpose">
				<Content>
					Тестовая обработка для демонстрации и проверки работы с различными типами реквизитов в платформе 1С:Enterprise 8.3.
					Содержит примеры всех основных типов данных: строковые, числовые, булевы, даты, ссылочные типы, перечисления, хранилище значений.
					Используется для проверки корректности XML-структуры метаданных и валидации документации.
				</Content>
			</Block>

			<Block name="DataModel">
				<Fields>
					<Field type="Attribute" name="СтроковыйРеквизит" type_val="Строка(100)">Пример строкового реквизита переменной длины до 100 символов.</Field>
					<Field type="Attribute" name="ЧисловойРеквизит" type_val="Число(15,2)">Пример числового реквизита с двумя знаками после запятой. Допускает отрицательные значения.</Field>
					<Field type="Attribute" name="БулевРеквизит" type_val="Булево">Пример булева реквизита (Истина/Ложь).</Field>
					<Field type="Attribute" name="ДатаВремя" type_val="Дата">Пример реквизита типа дата и время с точностью до секунды.</Field>
					<Field type="Attribute" name="СправочникНоменклатура" type_val="Справочник.Номенклатура">Пример ссылки на справочник Номенклатура.</Field>
					<Field type="Attribute" name="ПеречислениеЕдиницыИзмерения" type_val="Перечисление.ЕдиницыИзмерения">Пример ссылки на перечисление ЕдиницыИзмерения.</Field>
					<Field type="Attribute" name="ХранилищеЗначения" type_val="ХранилищеЗначения">Пример реквизита типа ХранилищеЗначения для хранения произвольных структурированных данных.</Field>
					<Field type="Attribute" name="МножественныйТип" type_val="Справочник.Номенклатура, Справочник.Контрагенты">Пример реквизита с несколькими допустимыми типами значений.</Field>
					<Field type="Attribute" name="МногострочныйТекст" type_val="Строка (неограниченная)">Пример многострочного текстового реквизита неограниченной длины с поддержкой расширенного редактирования.</Field>
				</Fields>
			</Block>

			<Block name="Logic">
				<Items>
					<Item>Обработка не содержит функциональной логики. Используется только для проверки структуры метаданных.</Item>
				</Items>
			</Block>

			<Block name="Interface">
				<Items>
					<Item>Обработка не имеет пользовательского интерфейса (форм).</Item>
				</Items>
			</Block>

			<Block name="Dependencies">
				<Items>
					<Item>Справочник Номенклатура: используется как тип данных реквизита.</Item>
					<Item>Справочник Контрагенты: используется в множественном типе.</Item>
					<Item>Перечисление ЕдиницыИзмерения: используется как тип данных реквизита.</Item>
				</Items>
			</Block>

			<Block name="History">
				<Record date="2026-02-10">Создание тестовой обработки с примерами всех основных типов реквизитов для проверки эффективности обновленной документации и XML-шаблонов.</Record>
			</Block>
		</Object>
	
	</DataProcessors>

    <InformationRegisters>
	
		<Object name="НастройкиПоУмолчанию" synonym="Настройки по умолчанию">
			<Block name="Purpose">
				<Content>Централизованное хранилище настроек по умолчанию для документов и форм. Заменяет разрозненные константы единым регистром сведений.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Dimension" name="ИмяНастройки" type_val="Справочник.НастройкиПоУмолчанию">Ключевое поле - ссылка на справочник элемента настройки.</Field>
					<Field type="Resource" name="Значение" type_val="Строка (неограниченная)">Сериализованное значение настройки (используется ЗначениеВСтрокуВнутр/ЗначениеИзСтрокиВнутр для хранения любых типов данных).</Field>
					<!-- Исторические поля (объявлены для совместимости, в текущей версии не используются) -->
					<Field type="Resource" name="ОсновнойСклад" type_val="Справочник.Склады" deprecated="true">Склад по умолчанию для новых документов. УСТАРЕЛО - используется через поле Значение.</Field>
					<Field type="Resource" name="ОсновнойПоставщик" type_val="Справочник.Контрагенты" deprecated="true">Поставщик по умолчанию для приходных документов. УСТАРЕЛО - используется через поле Значение.</Field>
					<Field type="Resource" name="ОсновнаяКасса" type_val="Справочник.Кассы" deprecated="true">Касса по умолчанию для кассовых операций. УСТАРЕЛО - используется через поле Значение.</Field>
					<Field type="Resource" name="ОсновнойТипЦен" type_val="Справочник.ТипыЦен" deprecated="true">Тип цен по умолчанию для продаж. УСТАРЕЛО - используется через поле Значение.</Field>
					<Field type="Resource" name="ПорядокОкругленияЦен" type_val="Перечисление.ПорядкиОкругленияЦен" deprecated="true">Правило округления цен. УСТАРЕЛО - используется через поле Значение.</Field>
					<Field type="Resource" name="КонтролироватьОстаткиПриСписании" type_val="Булево" deprecated="true">Флаг контроля остатков при списании. УСТАРЕЛО - используется через поле Значение.</Field>
					<Field type="Resource" name="КоличествоКнопокВКолонке" type_val="Число(2,0)">Количество кнопок в вертикальной колонке панели товаров РМК. Значение по умолчанию: 4.</Field>
					<Field type="Resource" name="КоличествоКнопокВРяду" type_val="Число(2,0)">Количество кнопок в горизонтальном ряду панели товаров РМК. Значение по умолчанию: 3.</Field>
					<Field type="Resource" name="ШиринаКнопок" type_val="Число(2,0)">Ширина кнопок товаров на панели РМК в пиксели. Значение по умолчанию: 100.</Field>
					<Field type="Resource" name="ВысотаКнопок" type_val="Число(2,0)">Высота кнопок товаров на панели РМК в пиксели. Значение по умолчанию: 80.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Непериодический регистр - хранит неограниченное количество записей Key-Value.</Item>
					<Item>Для чтения используется серверный API модуль НастройкиПоУмолчанию (методы ПолучитьХхх).</Item>
					<Item>Для редактирования используется обработка УправлениеНастройками.</Item>
					<Item>Параметры РМК (КоличествоКнопокВКолонке, КоличествоКнопокВРяду, ШиринаКнопок, ВысотаКнопок) загружаются один раз при открытии формы для оптимизации.</Item>
				</Items>
			</Block>
			<Block name="Interface">
				<Items>
					<Item>Обработка УправлениеНастройками предоставляет удобную форму для изменения всех настроек (разделена на вкладки: Заполнение, РМК).</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-21">Создание регистра для централизации настроек по умолчанию.</Record>
				<Record date="2026-01-21">Добавлены параметры РМК: КоличествоКнопокВКолонке и КоличествоКнопокВРяду. Миграция архитектуры на Key-Value с сериализацией.</Record>
				<Record date="2026-01-21">Добавлены настройки для адаптивного отображения кнопок РМК: ШиринаКнопок и ВысотаКнопок (в пиксели).</Record>
				<Record date="2026-01-28">Изменен тип поля Значение с составного типа на Строку (неограниченная). Реализована сериализация через ЗначениеВСтрокуВнутр() при записи и ЗначениеИзСтрокиВнутр() при чтении для универсального хранения любых типов данных.</Record>
			</Block>
		</Object>
	
		<Object name="Штрихкоды" synonym="Штрихкоды номенклатуры">
			<Block name="Purpose">
				<Content>Хранение штрихкодов для идентификации товаров сканером.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Dimension" name="Штрихкод" type_val="Строка(200)">Ключевое поле поиска штрихкода.</Field>
					<Field type="Dimension" name="Номенклатура" type_val="Справочник.Номенклатура">Товар, которому принадлежит штрихкод.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Допускаются неуникальные штрихкоды (коллизии). Механизм поиска обрабатывает это выводом списка выбора.</Item>
				</Items>
			</Block>
		</Object>

		<Object name="ЦеныНоменклатуры" synonym="Цены номенклатуры">
			<Block name="Purpose">
				<Content>Периодический регистр сведений (в пределах дня) для хранения цен товаров по разным типам.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="StandardAttribute" name="Период" type_val="Дата">Дата установки цены (стандартный реквизит).</Field>
					<Field type="StandardAttribute" name="Регистратор" type_val="Документ.Переоценка">Документ, создающий записи регистра (стандартный реквизит).</Field>
					<Field type="Dimension" name="Номенклатура" type_val="Справочник.Номенклатура">Товар.</Field>
					<Field type="Dimension" name="ТипЦен" type_val="Справочник.ТипыЦен">Вид цены (Розничная, Закупочная, Минимальная).</Field>
					<Field type="Resource" name="Цена" type_val="Число(15,2)">Стоимость товара.</Field>
				</Fields>
			</Block>
		</Object>

		<Object name="НастройкиРаспределенияПродаж" synonym="Настройки распределения продаж" status="Устаревший">
			<Block name="Purpose">
				<Content>УСТАРЕВШИЙ. Матрица распределения: связь между кассой и налоговой группой товара для выбора подходящего оборудования (ККТ). Регистр более не используется для распределения фискальных чеков. Оборудование теперь указывается непосредственно в карточке кассы (Справочник.Кассы.Оборудование).</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Dimension" name="Касса" type_val="Справочник.Кассы">Касса, на которой происходит продажа.</Field>
					<Field type="Dimension" name="НалоговаяГруппа" type_val="Справочник.НалоговыеГруппы">Налоговая группа товара (для маршрутизации на правильное ККТ).</Field>
					<Field type="Resource" name="Оборудование" type_val="Справочник.КассовоеОборудование">Оборудование (ККТ), которое должно быть использовано.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>УСТАРЕВШИЙ. Ранее использовался при пробитии чека для маршрутизации и выбора оборудования фискализации. Заменён реквизитом Оборудование в Справочник.Кассы.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
				<Record date="2026-02-11">Помечен как устаревший. Оборудование теперь указывается в карточке кассы (Справочник.Кассы.Оборудование). Распределение по НалоговаяГруппа более не применяется.</Record>
			</Block>
		</Object>
    </InformationRegisters>

    <AccumulationRegisters>
		<Object name="ОстаткиТоваров" synonym="Остатки товаров">
			<Block name="Purpose">
				<Content>Учет количественных остатков товаров на складах (регистр остатков).</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Dimension" name="Склад">Справочник.Склады - место хранения товара.</Field>
					<Field type="Dimension" name="Номенклатура">Справочник.Номенклатура - товар или услуга.</Field>
					<Field type="Resource" name="Количество">Число(15,4) - количественный остаток товара на складе.</Field>
				</Fields>
				<Registers>
					<RegisterType>Balance</RegisterType>
					<EnableTotalsSplitting>true</EnableTotalsSplitting>
				</Registers>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Регистраторы: ПриходТовара, ЧекККМ, СписаниеТовара, ИнвентаризацияТоваров.</Item>
					<Item>Движения по приходу: ПриходТовара, ИнвентаризацияТоваров (излишки).</Item>
					<Item>Движения по расходу: ЧекККМ, СписаниеТовара, ИнвентаризацияТоваров (недостачи).</Item>
					<Item>Контроль отрицательных остатков регулируется константой КонтролироватьОстаткиПриСписании.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2025-10-01">Создание регистра.</Record>
				<Record date="2026-01-17">Дополнение спецификации полной структурой согласно стандарту.</Record>
			</Block>
		</Object>

		<Object name="Продажи" synonym="Продажи (Обороты)">
			<Block name="Purpose">
				<Content>Регистр накопления (обороты) для фиксации выручки, себестоимости и аналитики продаж по товарам, кассам, сменам, сотрудникам.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Dimension" name="Номенклатура" type_val="Справочник.Номенклатура">Проданный товар.</Field>
					<Field type="Dimension" name="Касса" type_val="Справочник.Кассы">Касса, на которой была продажа.</Field>
					<Field type="Dimension" name="КассоваяСмена" type_val="Документ.КассоваяСмена">Смена, в рамках которой прошла продажа.</Field>
					<Field type="Dimension" name="Сотрудник" type_val="Справочник.Пользователи">Кассир, проводивший операцию.</Field>
					<Field type="Resource" name="Количество" type_val="Число(15,3)">Проданное количество.</Field>
					<Field type="Resource" name="Сумма" type_val="Число(15,2)">Выручка от продажи.</Field>
					<Field type="Resource" name="Себестоимость" type_val="Число(15,2)">Закупочная стоимость проданного товара.</Field>
				</Fields>
				<Registers>
					<RegisterType>Turnovers</RegisterType>
					<EnableTotalsSplitting>true</EnableTotalsSplitting>
				</Registers>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Заполняется документом ЧекККМ при проведении.</Item>
					<Item>Обеспечивает аналитику продаж по товарам, кассирам, сменам для отчетности.</Item>
					<Item>Себестоимость берется из регистра ЦеныНоменклатуры с типом цен "Закупочная" на дату продажи.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2025-10-01">Создание регистра.</Record>
				<Record date="2026-01-17">Дополнение спецификации полной структурой согласно стандарту.</Record>
				<Record date="2026-01-29">Изменена логика получения себестоимости: вместо регистра "ЦеныЗакупки" используется "ЦеныНоменклатуры" с типом цен "Закупочная".</Record>
			</Block>
		</Object>
	
		<Object name="ДенежныеСредства" synonym="Денежные средства">
			<Block name="Purpose">
				<Content>Учет наличных денежных средств по кассам ККМ (регистр остатков).</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Dimension" name="Касса">Справочник.Кассы - кассовый аппарат.</Field>
					<Field type="Resource" name="Сумма">Число(15,3) - остаток денежных средств в кассе.</Field>
				</Fields>
				<Registers>
					<RegisterType>Balance</RegisterType>
					<EnableTotalsSplitting>true</EnableTotalsSplitting>
				</Registers>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Регистраторы: ПриходныйКассовыйОрдер, РасходныйКассовыйОрдер, ЧекККМ.</Item>
					<Item>Приход: ПриходныйКассовыйОрдер (инкассация, выручка), ЧекККМ (оплата наличными).</Item>
					<Item>Расход: РасходныйКассовыйОрдер (инкассация, расходы).</Item>
					<Item>Положительный остаток означает наличие денег в кассе.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
				<Record date="2026-01-17">Дополнение спецификации полной структурой согласно стандарту.</Record>
			</Block>
		</Object>

		<Object name="Взаиморасчеты" synonym="Взаиморасчеты">
			<Block name="Purpose">
				<Content>Учет задолженности перед поставщиками и контрагентами (регистр остатков).</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Dimension" name="Контрагент">Справочник.Контрагенты - поставщик или клиент.</Field>
					<Field type="Resource" name="Сумма">Число(15,3) - сумма задолженности.</Field>
				</Fields>
				<Registers>
					<RegisterType>Balance</RegisterType>
					<EnableTotalsSplitting>true</EnableTotalsSplitting>
				</Registers>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Регистратор: ПриходТовара (при поступлении товаров от поставщика).</Item>
					<Item>Приход: ПриходТовара - возникновение долга перед поставщиком.</Item>
					<Item>Расход: Оплата поставщику (документы оплаты).</Item>
					<Item>Положительный остаток - наш долг перед контрагентом.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
				<Record date="2026-01-17">Дополнение спецификации полной структурой согласно стандарту.</Record>
			</Block>
		</Object>

		<Object name="ПродажиПоДисконтнымКартам" synonym="Продажи по дисконтным картам">
			<Block name="Purpose">
				<Content>Программа лояльности: сбор аналитики покупок в разрезе дисконтных карт лояльности.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Dimension" name="ДисконтнаяКарта">Справочник.ДисконтныеКарты - карта лояльности клиента.</Field>
					<Field type="Resource" name="Сумма">Число(15,3) - сумма покупок по карте.</Field>
				</Fields>
				<Registers>
					<RegisterType>Balance</RegisterType>
					<EnableTotalsSplitting>true</EnableTotalsSplitting>
				</Registers>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Регистратор: ЧекККМ (при пробитии чека с дисконтной картой).</Item>
					<Item>Записывается при проведении ЧекККМ с указанной дисконтной картой.</Item>
					<Item>Служит для построения отчетов по программе лояльности и начисления бонусов.</Item>
					<Item>Накопительные данные для аналитики по картам лояльности и клиентам.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
				<Record date="2026-01-17">Дополнение спецификации полной структурой согласно стандарту.</Record>
			</Block>
		</Object>
    </AccumulationRegisters>

    <CommonModules>
		<Object name="ОбщегоНазначенияКлиент" synonym="Общего назначения (Клиент)">
		
			<Block name="Purpose">
				<Content>Клиентский модуль с глобальными алгоритмами для работы с интерфейсом, доступный из любой формы.</Content>
			</Block>
			<Block name="Logic">
				<Items>
					<Item method="НайтиИОбработатьТовар(Штрихкод, Оповещение)">
						Асинхронная точка входа для поиска товара.
						1. Вызывает серверный метод ОбщегоНазначения.НайтиТовар(Штрихкод).
						2. Если найдено несколько - показывает список выбора.
						3. Возвращает результат через ОписаниеОповещения.
					</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2025-10-15">Создан для реализации архитектуры "Тонкий клиент".</Record>
				<Record date="2026-01-17">Дополнение спецификации полной структурой согласно стандарту.</Record>
			</Block>
		</Object>
		
		<Object name="ОбщегоНазначения" synonym="Общего назначения">
			<Block name="Purpose">
				<Content>
					Серверный модуль для глобальных алгоритмов системы. 
					Содержит логику поиска товара, ценообразования и получения настроек оборудования.
				</Content>
			</Block>

			<Block name="Logic">
				<Items>
					<Item method="НайтиТовар(СтрокаПоиска)">
						Универсальный поиск товара (возвращает Ссылку, Массив или Неопределено).
						Алгоритм:
						1. Ищет точное совпадение в регистре "Штрихкоды".
						2. Если не найдено — ищет по полям "Код" ИЛИ "Артикул" в справочнике "Номенклатура".
						3. Если найдено несколько товаров с одинаковым штрихкодом — возвращает массив для выбора.
					</Item>
					<Item method="НайтиТоварыПоШтрихкоду(Штрихкод, ДатаАктуальности)">
						Вспомогательная функция. Возвращает массив структур с данными товаров (Номенклатура, Цена, Представление) по точному совпадению штрихкода.
						Используется для отображения красивого списка с ценами.
					</Item>
					<Item method="ПолучитьНастройкиСканера()">
						Ищет в справочнике "КассовоеОборудование" первое активное устройство с типом "СканерШтрихкода" и возвращает структуру параметров подключения (ДрайверID, Порт, Скорость и др.).
						Возвращает структуру {ДрайверID, Параметры} или Неопределено если оборудование не настроено.
					</Item>
					<Item method="ПолучитьРозничнуюЦену(Дата, Номенклатура)">
						Получает срез последних цен из регистра "ЦеныНоменклатуры" по типу цен с наименованием "Розничная".
						Возвращает число (цена) или 0 если цена не установлена.
					</Item>
				</Items>
			</Block>

			<Block name="History">
				<Record date="2026-01-15">Создание модуля. Реализация поиска и функций работы с БД.</Record>
				<Record date="2026-01-17">Дополнение спецификации полной структурой согласно стандарту.</Record>
			</Block>
		</Object>
		<Object name="МенеджерОборудования" synonym="Менеджер оборудования">
			<Block name="Purpose">
				<Content>Клиентский модуль управления драйверами периферийного оборудования (сканеры, ККТ, весы).</Content>
			</Block>
			<Block name="Logic">
				<Items>
					<Item method="ПодключитьСканер()">
						Инициализация драйвера сканера штрихкодов.
						Поддерживает:
						1. COM-драйверы (старые, через Scanner.ScanOPOS).
						2. AddIn-компоненты (новые, асинхронные).
						Настраивает параметры из справочника "КассовоеОборудование" (номер COM-порта, скорость, т.д.).
						При получении события от сканера передает данные в форму через механизм Оповестить().
					</Item>
					<Item method="ОбработчикСобытияСканирования(Данные)">
						Callback для обработки события сканирования (запуск при считывании штрихкода).
						Передает данные активной форме через Оповестить().
					</Item>
					<Item method="ПослеПодключенияКомпоненты(Подключено, ДопПараметры)">
						Callback асинхронного подключения AddIn-компоненты сканера.
						Завершает инициализацию драйвера после загрузки компоненты.
					</Item>
					<Item method="НапечататьЧек(ОборудованиеСсылка, ДанныеЧека)">
						Отправка данных чека на печать через ККТ.
						Использует кэш драйверов для оптимизации повторных печатей.
					</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание модуля.</Record>
				<Record date="2026-01-17">Дополнение спецификации полной структурой согласно стандарту.</Record>
			</Block>
		</Object>
    </CommonModules>

	<FutureWorkItems>
		<Section name="РМК - Обработка акцизных товаров">
			<Description>
				Проработка функционала для корректной работы с товарами, требующими акцизных марок.
			</Description>
			<Items>
				<Item priority="High">
					<Title>Разделение товаров с акцизными марками при вводе в чек</Title>
					<Description>
						Когда пользователь вводит несколько штук (количество > 1) товара, который требует акцизную марку (ТребуетАкцизнуюМарку = Истина),
						система должна автоматически разделять такой товар в табличной части на отдельные строки по одной штуке каждая.
						
						Это необходимо для корректного учёта акцизных марок - каждая единица товара должна иметь свою марку.
					</Description>
					<Implementation>
						<Step>При добавлении товара в чек проверить флаг "ТребуетАкцизнуюМарку"</Step>
						<Step>Если флаг установлен и Количество > 1, то разделить на несколько строк</Step>
						<Step>Каждая строка будет содержать 1 единицу товара</Step>
						<Step>Цена и сумма должны быть пересчитаны для каждой отдельной строки</Step>
						<Step>При этом скидки должны быть распределены корректно между разделёнными строками</Step>
					</Implementation>
					<Affected>
						<Object>Документ.ЧекККМ</Object>
						<Object>Форма РМК (табличная часть Товары)</Object>
						<Object>Справочник.Номенклатура (реквизит ТребуетАкцизнуюМарку)</Object>
					</Affected>
					<Status>Запланирован</Status>
					<PlannedDate>Q2 2026</PlannedDate>
				</Item>
				<Item priority="Medium">
					<Title>UI для ввода акцизных марок в РМК</Title>
					<Description>
						Разработать интерфейс для сканирования/ввода кодов акцизных марок непосредственно в РМК 
						при работе с товарами, требующими акцизных марок.
						
						Должна быть возможность:
						- Сканировать марку штрихкодом
						- Вводить код марки вручную
						- Проверять уникальность марки в пределах одного чека
						- Сохранять коды марок в линии товара для последующего фискального учёта
					</Description>
					<Status>Запланирован</Status>
					<PlannedDate>Q2 2026</PlannedDate>
				</Item>
				<Item priority="Medium">
					<Title>Фискальная отчётность по акцизным товарам</Title>
					<Description>
						Добавить отчёты и аналитику по акцизным товарам:
						- Отчёт по количеству проданных акцизных товаров с кодами марок
						- Проверка соответствия количества скан-кодов количеству товара
						- Анализ остатков по акцизным товарам
					</Description>
					<Status>Запланирован</Status>
					<PlannedDate>Q3 2026</PlannedDate>
				</Item>
			</Items>
		</Section>
	</FutureWorkItems>

	<History>
		<Record date="2026-02-11">Реализация функционала ФОП (Форма оплати платежу):
			1. Создан новый справочник "ФОП" (Catalogs.ФОП) с предопределённым элементом "Готівка" для группировки позицій фіскальних чеків за формами оплат.
			2. Добавлен реквизит ФОП (Справочник.ФОП) в справочник Номенклатура — визначає, в який фіскальний чек потрапить товар.
			3. Переработан модуль формы РабочееМестоКассира: фіскальні чеки тепер групуються за ФОП замість попереднього розділення готівка/безготівка.
			4. Удалена настройка КассаБезналичных из обработки УправлениеНастройками и модуля НастройкиПоУмолчанию.
			5. Справочник ФОП добавлен в подсистемы: Все, Настройки, Финансы.
			6. Исправлены множественные проблемы целостности конфигурации (дублирование UUID, отсутствующие декларации форм, файлы-сироты).
			7. База данных пересоздана из-за ранее существовавших повреждений структуры.
		</Record>
	</History>

</Configuration>


