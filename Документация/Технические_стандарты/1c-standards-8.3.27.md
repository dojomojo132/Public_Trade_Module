# Стандарты разработки 1С:Enterprise 8.3.27

> **Версия:** 8.3.27  
> **Дата обновления:** 2026-01-24  
> **Источники:** [ИТС 1С](https://its.1c.ru/db/v8std), [BSL Language Server](https://1c-syntax.github.io/bsl-language-server/)

---

## 1. КРИТИЧЕСКИЕ ТРЕБОВАНИЯ

### 1.1 Асинхронность (ОБЯЗАТЕЛЬНО с 8.3.24+)

#### ✅ ПРАВИЛЬНО: Асинх/Ждать (рекомендуется)
```bsl
&НаКлиенте
Асинх Процедура ОткрытьФормуТовара(Команда)
    ПараметрыФормы = Новый Структура("Ключ", ТекущийТовар);
    Результат = Ждать ОткрытьФормуАсинх("Справочник.Номенклатура.ФормаОбъекта", ПараметрыФормы);
    Если Результат <> Неопределено Тогда
        ОбновитьДанные();
    КонецЕсли;
КонецПроцедуры
```

#### ✅ ПРАВИЛЬНО: ОписаниеОповещения (для совместимости)
```bsl
&НаКлиенте
Процедура ЗадатьВопросПользователю()
    Оповещение = Новый ОписаниеОповещения("ПослеОтветаНаВопрос", ЭтотОбъект);
    ПоказатьВопрос(Оповещение, "Продолжить операцию?", РежимДиалогаВопрос.ДаНет);
КонецПроцедуры

&НаКлиенте
Процедура ПослеОтветаНаВопрос(Результат, ДопПараметры) Экспорт
    Если Результат = КодВозвратаДиалога.Да Тогда
        ВыполнитьОперацию();
    КонецЕсли;
КонецПроцедуры
```

#### ❌ ЗАПРЕЩЕНО: Модальные вызовы
```bsl
// ОШИБКА! НЕ ИСПОЛЬЗОВАТЬ!
Ответ = Вопрос("Продолжить?", РежимДиалогаВопрос.ДаНет);
ВыбранныйФайл = ОткрытьФайл();
ВыбранноеЗначение = ОткрытьФормуМодально(...);
Предупреждение("Текст");
ВвестиЧисло(...);
ВвестиСтроку(...);
ВвестиДату(...);
ВвестиЗначение(...);
```

| Модальный метод | Асинхронная замена |
|-----------------|-------------------|
| `Вопрос()` | `ПоказатьВопрос()` / `ВопросАсинх()` |
| `Предупреждение()` | `ПоказатьПредупреждение()` / `ПредупреждениеАсинх()` |
| `ОткрытьФормуМодально()` | `ОткрытьФорму()` / `ОткрытьФормуАсинх()` |
| `ВвестиЧисло()` | `ПоказатьВводЧисла()` / `ВвестиЧислоАсинх()` |
| `ВвестиСтроку()` | `ПоказатьВводСтроки()` / `ВвестиСтрокуАсинх()` |
| `ВвестиДату()` | `ПоказатьВводДаты()` / `ВвестиДатуАсинх()` |

---

## 2. ДИРЕКТИВЫ КОМПИЛЯЦИИ

| Директива | Контекст | Назначение |
|-----------|----------|------------|
| `&НаКлиенте` | Тонкий/Веб-клиент | UI-логика, оповещения |
| `&НаСервере` | Сервер (с контекстом формы) | Работа с реквизитами формы |
| `&НаСервереБезКонтекста` | Сервер (без формы) | Чистые функции, запросы |
| `&НаКлиентеНаСервереБезКонтекста` | Оба | Утилиты, форматирование |
| `&НаКлиентеНаСервере` | Оба (с контекстом) | Редко используется |

### 2.1 Правила размещения директив
```bsl
// ПРАВИЛЬНО: директива на отдельной строке перед методом
&НаСервереБезКонтекста
Функция ПолучитьДанные()
    // ...
КонецФункции

// НЕПРАВИЛЬНО: директива на той же строке
&НаСервереБезКонтекста Функция ПолучитьДанные()  // ОШИБКА!
```

---

## 3. ИМЕНОВАНИЕ (Стандарт ИТС)

### 3.1 Объекты метаданных
- **Язык:** Русский
- **Стиль:** CamelCase (ВерблюжийРегистр)
- **Максимальная длина:** 80 символов

| Тип объекта | Пример | Антипример |
|-------------|--------|------------|
| Справочник | `Номенклатура` | `nomenclature`, `Товар1` |
| Документ | `ЧекККМ` | `check_kkm`, `Чек_ККМ` |
| Регистр накопления | `ОстаткиТоваров` | `остатки_товаров` |
| Общий модуль | `ОбщегоНазначения` | `CommonModule` |

### 3.2 Постфиксы общих модулей
| Постфикс | Назначение | Пример |
|----------|------------|--------|
| `Клиент` | Только клиент | `ОбщегоНазначенияКлиент` |
| `ВызовСервера` | Серверные вызовы с клиента | `ОбщегоНазначенияВызовСервера` |
| `КлиентСервер` | Клиент и сервер | `ОбщегоНазначенияКлиентСервер` |
| `ПовтИсп` | Повторное использование | `ОбщегоНазначенияПовтИсп` |
| `ПолныеПрава` | Привилегированный режим | `ОбщегоНазначенияПолныеПрава` |
| `Глобальный` | Глобальный модуль | `ОбщегоНазначенияГлобальный` |

### 3.3 Переменные и параметры
```bsl
// ПРАВИЛЬНО: осмысленные имена в CamelCase
Перем ТекущийОстаток;
Перем МассивТоваров;
Перем СтруктураПараметров;

// НЕПРАВИЛЬНО
Перем x;           // Однобуквенные имена
Перем tmp;         // Неинформативные имена
Перем остаток1;    // Цифры в конце без смысла
Перем current_balance;  // Латиница
```

### 3.4 Процедуры и функции
```bsl
// ПРАВИЛЬНО: глагол + существительное
Функция ПолучитьОстатокТовара(Номенклатура, Склад)
Процедура ЗаполнитьТаблицуТоваров(ТаблицаТоваров)
Функция РассчитатьСуммуДокумента(Документ)

// Обработчики событий: Префикс описывает событие
Процедура ПриИзменении(Элемент)
Процедура ПередЗаписью(Отказ, РежимЗаписи)
Процедура ПослеЗаписи(ПараметрыЗаписи)

// НЕПРАВИЛЬНО
Функция Получить()              // Неполное имя
Функция GetBalance()            // Латиница
Функция получить_остаток()      // Snake_case
```

---

## 4. СТРУКТУРА МОДУЛЯ

### 4.1 Стандартные области (регионы)
```bsl
#Область ОписаниеПеременных
// Объявления переменных модуля
#КонецОбласти

#Область ПрограммныйИнтерфейс
// Экспортные процедуры и функции для вызова из других модулей
#КонецОбласти

#Область СлужебныйПрограммныйИнтерфейс
// Экспортные процедуры для вызова только из данной подсистемы
#КонецОбласти

#Область ОбработчикиСобытийФормы
// ПриСозданииНаСервере, ПриОткрытии и т.д.
#КонецОбласти

#Область ОбработчикиСобытийЭлементовШапкиФормы
// Обработчики элементов вне таблиц
#КонецОбласти

#Область ОбработчикиСобытийЭлементовТаблицыФормы<ИмяТаблицы>
// Обработчики для конкретной таблицы формы
#КонецОбласти

#Область ОбработчикиКомандФормы
// Обработчики команд формы
#КонецОбласти

#Область СлужебныеПроцедурыИФункции
// Внутренние процедуры и функции модуля
#КонецОбласти

#Область Инициализация
// Код инициализации модуля
#КонецОбласти
```

### 4.2 Правила размещения кода
- Экспортные методы — в области `ПрограммныйИнтерфейс`
- Неэкспортные методы — в области `СлужебныеПроцедурыИФункции`
- Код вне областей — **ЗАПРЕЩЕН** (диагностика `CodeOutOfRegion`)

---

## 5. ОФОРМЛЕНИЕ КОДА

### 5.1 Описание процедур и функций
```bsl
// Получает остаток товара на указанном складе.
//
// Параметры:
//  Номенклатура - СправочникСсылка.Номенклатура - товар для расчета остатка.
//  Склад - СправочникСсылка.Склады - склад для расчета.
//  Дата - Дата - дата, на которую рассчитывается остаток.
//         По умолчанию - текущая дата.
//
// Возвращаемое значение:
//  Число - остаток товара в единицах хранения.
//
// Пример:
//  Остаток = ПолучитьОстатокТовара(Товар, Склад, ТекущаяДата());
//
&НаСервереБезКонтекста
Функция ПолучитьОстатокТовара(Номенклатура, Склад, Дата = Неопределено) Экспорт
    // ...
КонецФункции
```

### 5.2 Форматирование
```bsl
// Отступы: табуляция (1 таб = 4 пробела)
// Максимальная длина строки: 120 символов

// Перенос параметров
Запрос.УстановитьПараметр("Номенклатура", Номенклатура);
Запрос.УстановитьПараметр("Склад", Склад);
Запрос.УстановитьПараметр("Дата", Дата);

// Перенос в запросе
Запрос.Текст = 
"ВЫБРАТЬ
|   Остатки.Номенклатура,
|   Остатки.Склад,
|   Остатки.КоличествоОстаток
|ИЗ
|   РегистрНакопления.ОстаткиТоваров.Остатки(&Дата,
|       Номенклатура = &Номенклатура
|       И Склад = &Склад) КАК Остатки";
```

### 5.3 Пробелы
```bsl
// ПРАВИЛЬНО: пробелы вокруг операторов
Сумма = Количество * Цена;
Если А = Б Тогда
Для Индекс = 0 По Массив.Количество() - 1 Цикл

// ПРАВИЛЬНО: пробел после запятой
ВызватьМетод(Параметр1, Параметр2, Параметр3);

// НЕПРАВИЛЬНО
Сумма=Количество*Цена;
Если А=Б Тогда
ВызватьМетод(Параметр1,Параметр2,Параметр3);
```

### 5.4 Точка с запятой
```bsl
// Каждый оператор должен заканчиваться точкой с запятой
Переменная = 1;
ВызватьМетод();
Возврат Результат;
```

---

## 6. РАБОТА С ЗАПРОСАМИ

### 6.1 Оформление текста запроса
```bsl
Запрос = Новый Запрос;
Запрос.Текст = 
"ВЫБРАТЬ
|   Товары.Ссылка КАК Товар,
|   Товары.Наименование КАК Наименование,
|   ЕСТЬNULL(Остатки.КоличествоОстаток, 0) КАК Остаток
|ИЗ
|   Справочник.Номенклатура КАК Товары
|       ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ОстаткиТоваров.Остатки(
|           &Дата,
|           Склад = &Склад) КАК Остатки
|       ПО Товары.Ссылка = Остатки.Номенклатура
|ГДЕ
|   НЕ Товары.ЭтоГруппа
|   И НЕ Товары.ПометкаУдаления
|УПОРЯДОЧИТЬ ПО
|   Наименование";
```

### 6.2 Обязательные правила запросов
| Правило | Диагностика |
|---------|-------------|
| Всегда указывать псевдонимы полей | `AssignAliasFieldsInQuery` |
| Использовать `ЕСТЬNULL` для соединений | `FieldsFromJoinsWithoutIsNull` |
| Не использовать `ВЫБРАТЬ ПЕРВЫЕ` без `УПОРЯДОЧИТЬ ПО` | `SelectTopWithoutOrderBy` |
| Не выполнять запросы в цикле | `CreateQueryInCycle` |
| Использовать `ОБЪЕДИНИТЬ ВСЕ` вместо `ОБЪЕДИНИТЬ` | `UnionAll` |
| Не использовать `ПОЛНОЕ ВНЕШНЕЕ СОЕДИНЕНИЕ` | `FullOuterJoinQuery` |
| Не соединять с вложенными запросами | `JoinWithSubQuery` |
| Не соединять с виртуальными таблицами | `JoinWithVirtualTable` |
| Передавать параметры в виртуальные таблицы | `VirtualTableCallWithoutParameters` |

### 6.3 Антипаттерны запросов
```bsl
// ❌ НЕПРАВИЛЬНО: запрос в цикле
Для Каждого Товар Из СписокТоваров Цикл
    Запрос = Новый Запрос("ВЫБРАТЬ...");  // ОШИБКА!
    Запрос.УстановитьПараметр("Товар", Товар);
КонецЦикла;

// ✅ ПРАВИЛЬНО: один запрос со списком
Запрос = Новый Запрос;
Запрос.Текст = "ВЫБРАТЬ... ГДЕ Товар В (&СписокТоваров)";
Запрос.УстановитьПараметр("СписокТоваров", СписокТоваров);
```

---

## 7. ТРАНЗАКЦИИ

### 7.1 Правильное использование
```bsl
НачатьТранзакцию();
Попытка
    // Операции с данными
    БлокировкаДанных = Новый БлокировкаДанных;
    ЭлементБлокировки = БлокировкаДанных.Добавить("РегистрНакопления.ОстаткиТоваров");
    ЭлементБлокировки.Режим = РежимБлокировкиДанных.Исключительный;
    БлокировкаДанных.Заблокировать();
    
    // ... операции записи ...
    
    ЗафиксироватьТранзакцию();
Исключение
    ОтменитьТранзакцию();
    // Обработка исключения
    ВызватьИсключение;
КонецПопытки;
```

### 7.2 Обязательные правила транзакций
| Правило | Диагностика |
|---------|-------------|
| `НачатьТранзакцию()` перед `Попытка` | `BeginTransactionBeforeTryCatch` |
| `ЗафиксироватьТранзакцию()` внутри `Попытка` | `CommitTransactionOutsideTryCatch` |
| `ОтменитьТранзакцию()` в `Исключение` | `WrongUseOfRollbackTransactionMethod` |
| Парность вызовов | `PairingBrokenTransaction` |

---

## 8. БЕЗОПАСНОСТЬ

### 8.1 Запрещённые конструкции
| Конструкция | Диагностика | Риск |
|-------------|-------------|------|
| `Выполнить()` с переменной | `ExecuteExternalCode` | Выполнение произвольного кода |
| `Вычислить()` с внешними данными | `ExecuteExternalCode` | Инъекция кода |
| Хардкод паролей | `UsingHardcodeSecretInformation` | Утечка данных |
| Хардкод IP-адресов | `UsingHardcodeNetworkAddress` | Уязвимость конфигурации |
| Хардкод путей к файлам | `UsingHardcodePath` | Непереносимость |
| `УстановитьПривилегированныйРежим(Истина)` | `SetPrivilegedMode` | Обход прав |
| `УстановитьБезопасныйРежим(Ложь)` | `DisableSafeMode` | Обход безопасности |

### 8.2 Проверка прав
```bsl
// ❌ НЕПРАВИЛЬНО: РольДоступна
Если РольДоступна("Администратор") Тогда  // ОШИБКА!

// ✅ ПРАВИЛЬНО: ПравоДоступа
Если ПравоДоступа("Изменение", Метаданные.Справочники.Номенклатура) Тогда
```

---

## 9. КЛИЕНТ-СЕРВЕРНОЕ ВЗАИМОДЕЙСТВИЕ

### 9.1 Минимизация серверных вызовов
```bsl
// ❌ НЕПРАВИЛЬНО: много вызовов сервера
&НаКлиенте
Процедура Обработать()
    Данные1 = ПолучитьДанные1НаСервере();  // Вызов 1
    Данные2 = ПолучитьДанные2НаСервере();  // Вызов 2
    Данные3 = ПолучитьДанные3НаСервере();  // Вызов 3
КонецПроцедуры

// ✅ ПРАВИЛЬНО: один вызов
&НаКлиенте
Процедура Обработать()
    ВсеДанные = ПолучитьВсеДанныеНаСервере();  // Один вызов
КонецПроцедуры

&НаСервереБезКонтекста
Функция ПолучитьВсеДанныеНаСервере()
    Результат = Новый Структура;
    Результат.Вставить("Данные1", ПолучитьДанные1());
    Результат.Вставить("Данные2", ПолучитьДанные2());
    Результат.Вставить("Данные3", ПолучитьДанные3());
    Возврат Результат;
КонецФункции
```

### 9.2 Правила передачи данных
| Правило | Диагностика |
|---------|-------------|
| Не передавать большие объёмы данных | `TransferringParametersBetweenClientAndServer` |
| Использовать `&НаСервереБезКонтекста` где возможно | — |
| Кешировать повторно используемые данные | `CachedPublic` |

---

## 10. УСТАРЕВШИЕ МЕТОДЫ

### 10.1 Устаревшие глобальные методы
| Устаревший метод | Замена | Диагностика |
|------------------|--------|-------------|
| `ТекущаяДата()` | `ОбщегоНазначения.ТекущаяДатаСеанса()` | `DeprecatedCurrentDate` |
| `Найти()` | `СтрНайти()` | `DeprecatedFind` |
| `Сообщить()` | `ОбщегоНазначения.СообщитьПользователю()` | `DeprecatedMessage` |
| `ПолучитьФорму()` | `ОткрытьФорму()` | `GetFormMethod` |

### 10.2 Устаревшие свойства
| Устаревшее | Замена | Диагностика |
|------------|--------|-------------|
| `ЭтаФорма` | `ЭтотОбъект` | `UsingThisForm` |
| Тип `УправляемаяФорма` | `ФормаКлиентскогоПриложения` | `DeprecatedTypeManagedForm` |

---

## 11. ПРОВЕДЕНИЕ ДОКУМЕНТОВ

### 11.1 Стандартная структура
```bsl
Процедура ОбработкаПроведения(Отказ, РежимПроведения)
    
    // 1. Инициализация движений
    Движения.ОстаткиТоваров.Записывать = Истина;
    Движения.Продажи.Записывать = Истина;
    
    // 2. Формирование движений
    Для Каждого СтрокаТовары Из Товары Цикл
        // Движение по остаткам
        Движение = Движения.ОстаткиТоваров.Добавить();
        Движение.ВидДвижения = ВидДвиженияНакопления.Расход;
        Движение.Период = Дата;
        Движение.Номенклатура = СтрокаТовары.Номенклатура;
        Движение.Склад = Склад;
        Движение.Количество = СтрокаТовары.Количество;
        
        // Движение по продажам
        ДвижениеПродажи = Движения.Продажи.Добавить();
        ДвижениеПродажи.Период = Дата;
        ДвижениеПродажи.Номенклатура = СтрокаТовары.Номенклатура;
        ДвижениеПродажи.Количество = СтрокаТовары.Количество;
        ДвижениеПродажи.Сумма = СтрокаТовары.Сумма;
    КонецЦикла;
    
    // 3. Контроль остатков
    Если Константы.КонтролироватьОстаткиПриСписании.Получить() Тогда
        КонтрольОстатков(Отказ);
    КонецЕсли;
    
КонецПроцедуры
```

### 11.2 Проверка в обработчиках объектов
```bsl
// ОБЯЗАТЕЛЬНО: проверка ОбменДанными.Загрузка
Процедура ПередЗаписью(Отказ)
    Если ОбменДанными.Загрузка Тогда
        Возврат;
    КонецЕсли;
    
    // Бизнес-логика
КонецПроцедуры
```

---

## 12. ДИАГНОСТИКИ BSL LANGUAGE SERVER

### 12.1 Критические (блокирующие)
| Код | Описание |
|-----|----------|
| `ParseError` | Ошибка разбора кода |
| `ProcedureReturnsValue` | Процедура возвращает значение |
| `CommonModuleAssign` | Присвоение общему модулю |
| `ThisObjectAssign` | Присвоение ЭтотОбъект |
| `ForbiddenMetadataName` | Запрещённое имя метаданных |
| `MissingCommonModuleMethod` | Отсутствует метод общего модуля |
| `ServerSideExportFormMethod` | Серверный экспортный метод формы |

### 12.2 Критические (производительность)
| Код | Описание |
|-----|----------|
| `CreateQueryInCycle` | Запрос в цикле |
| `NestedStatements` | Слишком глубокая вложенность |
| `CognitiveComplexity` | Высокая когнитивная сложность |
| `CyclomaticComplexity` | Высокая цикломатическая сложность |

### 12.3 Важные (стандарты)
| Код | Описание |
|-----|----------|
| `UsingSynchronousCalls` | Синхронные вызовы |
| `UsingModalWindows` | Модальные окна |
| `UsingGoto` | Оператор Перейти |
| `CommentedCode` | Закомментированный код |
| `EmptyCodeBlock` | Пустой блок кода |
| `MissingParameterDescription` | Нет описания параметров |
| `MissingReturnedValueDescription` | Нет описания возврата |
| `PublicMethodsDescription` | Нет описания публичного метода |

### 12.4 Конфигурация BSL LS (.bsl-language-server.json)
```json
{
  "diagnostics": {
    "computeTrigger": "onSave",
    "parameters": {
      "LineLength": {
        "maxLineLength": 120
      },
      "MethodSize": {
        "maxMethodSize": 200
      },
      "CognitiveComplexity": {
        "threshold": 15
      },
      "CyclomaticComplexity": {
        "threshold": 20
      },
      "NumberOfParams": {
        "maxNumberOfParams": 7
      },
      "NumberOfOptionalParams": {
        "maxNumberOfOptionalParams": 3
      }
    }
  }
}
```

---

## 13. ЧЕКЛИСТ ПРОВЕРКИ КОДА

### Перед коммитом
- [ ] Нет модальных вызовов
- [ ] Асинхронные методы используют `Асинх`/`Ждать`
- [ ] Все методы имеют директивы компиляции
- [ ] Код размещён в стандартных областях
- [ ] Экспортные методы имеют описание
- [ ] Нет запросов в циклах
- [ ] Транзакции оформлены правильно
- [ ] Нет хардкода паролей/путей/адресов
- [ ] Проверка `ОбменДанными.Загрузка` в обработчиках
- [ ] BSL LS не показывает критических ошибок

---

## 14. ССЫЛКИ НА ИСТОЧНИКИ

### Официальные стандарты 1С
- [Система стандартов ИТС](https://its.1c.ru/db/v8std)
- [Соглашения при написании кода](https://its.1c.ru/db/v8std/browse/13/-1/31)
- [Оформление модулей](https://its.1c.ru/db/v8std/browse/13/-1/31/32)
- [Структура модуля](https://its.1c.ru/db/v8std/content/455/hdoc)
- [Описание процедур и функций](https://its.1c.ru/db/v8std/content/453/hdoc)
- [Правила образования имен переменных](https://its.1c.ru/db/v8std/content/454/hdoc)
- [Транзакции: правила использования](https://its.1c.ru/db/v8std/content/783/hdoc)

### Документация платформы
- [Платформа 8.3.27](https://its.1c.ru/db/v8327doc)

### Инструменты анализа кода
- [BSL Language Server](https://1c-syntax.github.io/bsl-language-server/)
- [Диагностики BSL LS](https://1c-syntax.github.io/bsl-language-server/diagnostics/)
- [Конфигурирование BSL LS](https://1c-syntax.github.io/bsl-language-server/features/ConfigurationFile/)

---

> **Примечание:** Этот документ основан на официальных стандартах 1С (ИТС) и правилах BSL Language Server версии 0.28.1. При расхождении приоритет имеют официальные стандарты ИТС.
