<?xml version="1.0" encoding="UTF-8"?>
<Configuration name="PTM - Public Trade Module" version="1.0.3" country="Ukraine">

    <Description>
        Полная техническая спецификация конфигурации.
        Является ЕДИНЫМ ИСТОЧНИКОМ ПРАВДЫ для разработки.
	</Description>

	<SessionParameters>
	
        <Object name="ТекущийПользователь">
            <Block name="Purpose"><Content>Хранит ссылку на справочник "Пользователи" для текущего сеанса.</Content></Block>
            <Block name="DataModel"><Fields><Field type="Type" type_val="Справочник.Пользователи"/></Fields></Block>
        </Object>
        <Object name="ТекущаяКасса">
            <Block name="Purpose"><Content>Кэширует кассу, к которой привязано рабочее место (чтобы не выбирать каждый раз).</Content></Block>
            <Block name="DataModel"><Fields><Field type="Type" type_val="Справочник.Кассы"/></Fields></Block>
        </Object>
    </SessionParameters>
	
	<Constants>
	
		<Object name="ОсновнойСклад" synonym="Основной склад (для подстановки)">
			<Block name="Purpose">
				<Content>Значение по умолчанию для заполнения склада в новых чеках.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field name="Тип" type="Справочник.Склады">Ссылка на склад.</Field>
				</Fields>
			</Block>
		</Object>
		
		<Object name="ПорядокОкругленияЦен" synonym="Порядок округления цен">
			<Block name="Purpose">
				<Content>Глобальная настройка точности расчета цен в документах.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field name="Значение" type="Перечисление.ПорядкиОкругленияЦен">Правило округления.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Используется в обработке "ЗаполнениеНоменклатуры" и при расчете скидок в РМК.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание константы.</Record>
			</Block>
		</Object>

		<Object name="КонтролироватьОстаткиПриСписании" synonym="Контролировать остатки при списании">
			<Block name="Purpose">
				<Content>Флаг, включающий жесткий контроль отрицательных остатков.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field name="Значение" type="Булево">Истина - запрещать списание в минус.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Проверяется в модуле объекта документов (ЧекККМ, СписаниеТовара) перед записью движений.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание константы.</Record>
			</Block>
		</Object>

		<Object name="ОсновнойПоставщик" synonym="Основной поставщик">
			<Block name="Purpose">
				<Content>Значение по умолчанию для подстановки в документы закупки.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field name="Значение" type="Справочник.Контрагенты">Ссылка на поставщика.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Автозаполнение поля "Контрагент" в документе "ПриходТовара" при создании нового.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание константы.</Record>
			</Block>
		</Object>
		
	</Constants>

	<Subsystems>
        <Object name="Продажи" synonym="Розничные продажи">
            <Block name="Purpose"><Content>Группировка объектов для кассира.</Content></Block>
            <Block name="Composition">
                <Content>Док.ЧекККМ, Док.КассоваяСмена, Обработка.РабочееМестоКассира, Спр.Номенклатура.</Content>
            </Block>
        </Object>
        <Object name="Настройки" synonym="НСИ и Администрирование">
            <Block name="Purpose"><Content>Группировка для администратора/товароведа.</Content></Block>
            <Block name="Composition">
                <Content>Спр.Кассы, Спр.Склады, Спр.НалоговыеГруппы, Регистры.</Content>
            </Block>
        </Object>
		<Object name="Торговля" synonym="Торговля">
			<Block name="Purpose">
				<Content>Основной раздел для менеджеров и кассиров. Группирует функционал продаж и работы с клиентами.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field>Состав: Док.ЧекККМ, Док.КассоваяСмена, Спр.Контрагенты, Спр.НалоговыеГруппы, Спр.КассовоеОборудование.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Определяет видимость объектов в интерфейсе раздела "Торговля".</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Добавлена для группировки торговых операций.</Record>
			</Block>
		</Object>
		<Object name="Склад" synonym="Склад">
			<Block name="Purpose">
				<Content>Раздел для кладовщиков. Группирует функционал учета запасов.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field>Состав: Спр.Склады, Док.ПриходТовара, Док.СписаниеТовара, Док.ИнвентаризацияТоваров, Отчет.ОстаткиТоваров.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Определяет видимость объектов в интерфейсе раздела "Склад".</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Добавлена для группировки складских операций.</Record>
			</Block>
		</Object>
		<Object name="Фискал" synonym="Фискал">
			<Block name="Purpose">
				<Content>Служебная подсистема для объектов взаимодействия с торговым оборудованием.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field>Состав: Док.ФискальныйЧек, Спр.КассовоеОборудование, Обработка.РМК.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Используется для настройки прав доступа к фискальным функциям.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Выделена в отдельную подсистему для удобства администрирования.</Record>
			</Block>
		</Object>
    </Subsystems>

    <Catalogs>
		<Object name="Номенклатура" synonym="Товары и услуги">
			
			<Block name="Purpose">
				<Content>
					Центральный справочник для хранения информации о товарах и услугах. 
					Используется во всех товароучетных документах и РМК.
				</Content>
			</Block>

			<Block name="DataModel">
				<Fields>
					<Field name="Артикул" type="Строка(25)">Уникальный артикул производителя.</Field>
					<Field name="Код" type="Строка(11)">Внутренний код (генерируется автоматически).</Field>
					<Field name="ЕдиницаИзмерения" type="Справочник.ЕдиницыИзмерения">Базовая единица учета.</Field>
					<Field name="СтавкаНДС" type="Перечисление.СтавкиНДС">20%, 7%, 0%, Без НДС.</Field>
					<Field name="КодУКТЗЕД" type="Строка(20)">Код ВЭД (Обязателен для акцизных товаров в Украине).</Field>
					<Field name="ТребуетАкцизнуюМарку" type="Булево">Флаг контроля маркировки в РМК.</Field>
					<Field name="НалоговаяГруппа" type="Справочник.НалоговыеГруппы">Группа налогообложения для ПРРО.</Field>
					<Field name="ПроцентНаценки" type="Число(5,2)">Плановая наценка для авторасчета цен.</Field>
				</Fields>
			</Block>

			<Block name="Logic">
				<Items>
					<Item event="ПередЗаписью">
						Автозаполнение: Если поле "Артикул" не заполнено, в него копируется значение поля "Код".
					</Item>
					<Item event="Контроль">
						При установке флага "ТребуетАкцизнуюМарку" проверка заполненности "КодУКТЗЕД".
					</Item>

				</Items>
			</Block>

			<Block name="Interface">
				<Items>
					<Item>
						Форма списка: Реализован быстрый поиск по вхождению строки в Наименование/Артикул/Штрихкод.
					</Item>
				</Items>
			</Block>

			<Block name="History">
				<Record date="2025-10-15">Реализовано автозаполнение Артикула из Кода.</Record>
				<Record date="2025-10-20">Добавлены реквизиты для ПРРО (КодУКТЗЕД, НалоговаяГруппа).</Record>
			</Block>
		</Object>

		<Object name="Кассы" synonym="Кассовые аппараты">
			
			<Block name="Purpose">
				<Content>
					Места проведения расчетов. Разделяет денежные потоки и смены по физическим устройствам.
				</Content>
			</Block>

			<Block name="DataModel">
				<Fields>
					<Field name="Наименование" type="Строка(50)">Название кассы (пр. "Касса №1").</Field>
					<Field name="ФискальныйНомерПРРО" type="Строка(20)">ID кассы на сервере налоговой (опционально).</Field>
				</Fields>
			</Block>

			<Block name="Logic">
				<Items>
					<Item>Используется как разделитель учета в регистре "ДенежныеСредства".</Item>
					<Item>Обязателен для заполнения в документе "КассоваяСмена".</Item>
				</Items>
			</Block>

			<Block name="History">
				<Record date="2025-10-01">Создание базовой структуры.</Record>
			</Block>
		</Object>

		<Object name="Склады" synonym="Склады и магазины">
			<Block name="Purpose">
				<Content>Места хранения товарных остатков.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field name="ТипСклада" type="Перечисление.ТипыСкладов">Розничный / Оптовый.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Разделитель учета в регистре "ОстаткиТоваров".</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2025-10-01">Создание базовой структуры.</Record>
			</Block>
		</Object>

		<Object name="НалоговыеГруппы" synonym="Налоговые группы (ПРРО)">
			<Block name="Purpose">
				<Content>
					Хранение буквенных обозначений ставок НДС для фискального чека (А, Б, В...).
					Необходимо для маппинга ставок 1С на ставки фискального регистратора.
				</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field name="Буква" type="Строка(1)">Код ставки (А, Б, В, Г...).</Field>
					<Field name="Ставка" type="Число(5,2)">Процент налога.</Field>
				</Fields>
			</Block>
			<Block name="History">
				<Record date="2025-10-20">Добавлен в рамках адаптации под законодательство Украины.</Record>
			</Block>
		</Object>
	
		<Object name="Пользователи" synonym="Список пользователей">
            <Block name="Purpose">
                <Content>Список физических лиц, работающих с системой (для авторизации).</Content>
            </Block>
            <Block name="DataModel">
                <Fields>
                    <Field name="Наименование" type="Строка(100)">ФИО.</Field>
                    <Field name="ИдентификаторПользователяИБ" type="УникальныйИдентификатор">Связь с пользователем платформы.</Field>
					<Field name="РазрешитьПродажуВМинус" type="Булево">Право на проведение чека при недостатке остатка.</Field>
					<Field name="РазрешитьРучныеСкидки" type="Булево">Право на редактирование цены/скидки в чеке.</Field>
                </Fields>
            </Block>
			<Block name="History">
				<Record date="2026-01-15">Добавлены флаги дополнительных прав (продажа в минус, скидки).</Record>
			</Block>
        </Object>
		
		<Object name="Контрагенты" synonym="Контрагенты">
			<Block name="Purpose">
				<Content>Справочник для хранения списка поставщиков и покупателей.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field name="Наименование" type="Строка(100)">Название контрагента.</Field>
					</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Используется как аналитика в регистре "Взаиморасчеты".</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
			</Block>
		</Object>

		<Object name="КассовоеОборудование" synonym="Кассовое оборудование">
			<Block name="Purpose">
				<Content>Хранение настроек подключения внешнего оборудования (ККТ, Сканеры, Принтеры).</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field name="ТипОборудования" type="Перечисление.ТипыОборудования">Вид устройства.</Field>
					<Field name="ДрайверID" type="Строка(100)">Идентификатор драйвера в системе (AddIn).</Field>
					<Field name="ПараметрыПодключения" type="ХранилищеЗначения">Сериализованные настройки (порт, скорость и т.д.).</Field>
					<Field name="Порт" type="Число(2)">Номер COM-порта (устаревает).</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Используется общим модулем "МенеджерОборудования" для инициализации драйвера при запуске РМК.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
			</Block>
		</Object>

		<Object name="ТипыЦен" synonym="Типы цен">
			<Block name="Purpose">
				<Content>Классификатор видов цен (Закупочная, Розничная, Оптовая).</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field name="Наименование" type="Строка(50)">Название типа цены.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Используется как разделитель в регистре "ЦеныНоменклатуры".</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
			</Block>
		</Object>

		<Object name="ДисконтныеКарты" synonym="Дисконтные карты">
			<Block name="Purpose">
				<Content>Реестр выданных карт лояльности.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field name="Код" type="Строка(9)">Номер карты (штрихкод/магнитная полоса).</Field>
					<Field name="ВладелецКарты" type="Справочник.Контрагенты">Клиент (опционально).</Field>
					<Field name="ВидКарты" type="Справочник.ВидыДисконтныхКарт">Ссылка на вид.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Поиск по Коду в РМК при сканировании карты.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
			</Block>
		</Object>

		<Object name="ВидыДисконтныхКарт" synonym="Виды дисконтных карт">
			<Block name="Purpose">
				<Content>Группировка дисконтных карт (Например: "Золотая", "Серебряная").</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field name="Наименование" type="Строка(50)">Название вида.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Служит для аналитики продаж.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
			</Block>
		</Object>
	</Catalogs>

    <Documents>
		<Object name="КассоваяСмена" synonym="Кассовая смена">
        
        <Block name="Purpose">
            <Content>
                Документ, фиксирующий период работы кассы (аналог Z-отчета). 
                Ограничивает возможность пробития чеков: чеки можно бить только в рамках ОТКРЫТОЙ смены.
            </Content>
        </Block>

        <Block name="DataModel">
            <Fields>
                <Field type="Header" name="Касса" type_val="Справочник.Кассы">Физическая касса, по которой открыта смена.</Field>
                <Field type="Header" name="ДатаНачала" type_val="Дата">Время открытия смены.</Field>
                <Field type="Header" name="ДатаОкончания" type_val="Дата">Время закрытия смены.</Field>
                <Field type="Header" name="Статус" type_val="Перечисление.СтатусыКассовойСмены">Значения: Открыта, Закрыта.</Field>
            </Fields>
        </Block>

        <Block name="Logic">
            <Items>
                <Item event="Контроль">
                    Запрещено проведение двух открытых смен по одной Кассе одновременно.
                </Item>
                <Item event="РМК">
                    При запуске РМК ищется смена со статусом "Открыта". Если не найдена — предлагается создать новую.
                </Item>
            </Items>
        </Block>

        <Block name="History">
            <Record date="2025-10-01">Создание объекта.</Record>
            <Record date="2026-01-15">Изменение типа "Статус" со Строки на Перечисление. Переименование "КассаККМ" -> "Касса".</Record>
        </Block>
    </Object>

		<Object name="ЧекККМ" synonym="Розничный чек">
			
			<Block name="Purpose">
				<Content>
					Фиксация факта розничной продажи. Списывает товары со склада, фиксирует выручку и генерирует фискальный номер.
				</Content>
			</Block>

			<Block name="DataModel">
				<Fields>
					<Field type="Header" name="КассоваяСмена" type_val="Документ.КассоваяСмена">Связь со сменой.</Field>
					<Field type="Header" name="Касса" type_val="Справочник.Кассы">Касса пробития.</Field>
					<Field type="Header" name="Склад" type_val="Справочник.Склады">Склад списания остатков.</Field>
					<Field type="Header" name="СуммаДокумента" type_val="Число(15,2)">Итоговая сумма.</Field>
					<Field type="Header" name="ФискальныйНомер" type_val="Строка(50)">Уникальный номер от сервера ПРРО/ГНС.</Field>
					<Field type="Header" name="Статус" type_val="Перечисление.СтатусыЧекаККМ">Пробит, Аннулирован, Отложен.</Field>
					
					<Field type="TabularSection" name="Товары.Номенклатура" type_val="Справочник.Номенклатура">Товар.</Field>
					<Field type="TabularSection" name="Товары.Количество" type_val="Число(15,3)">Количество.</Field>
					<Field type="TabularSection" name="Товары.Цена" type_val="Число(15,2)">Цена продажи.</Field>
					<Field type="TabularSection" name="Товары.Сумма" type_val="Число(15,2)">Сумма строки.</Field>
					<Field type="TabularSection" name="Товары.АкцизнаяМарка" type_val="Строка(200)">Код маркировки (Обязателен для акциза).</Field>
					<Field type="TabularSection" name="Товары.НалоговаяГруппа" type_val="Справочник.НалоговыеГруппы">Ставка НДС для чека.</Field>

					<Field type="TabularSection" name="Оплата.ВидОплаты" type_val="Перечисление.ВидыОплаты">Наличные / Карта.</Field>
					<Field type="TabularSection" name="Оплата.Сумма" type_val="Число(15,2)">Сумма оплаты.</Field>
				</Fields>
			</Block>

			<Block name="Logic">
				<Items>
					<Item event="ОбработкаПроведения">
						Формирует движения: Расход по регистру "ОстаткиТоваров", Приход по регистру "Продажи".
					</Item>
					<Item event="Контроль">
						Если товар имеет флаг "ТребуетАкцизнуюМарку", поле "Товары.АкцизнаяМарка" должно быть заполнено.
					</Item>
				</Items>
			</Block>

			<Block name="Interface">
				<Items>
					<Item>Основная форма работы — Обработка "РабочееМестоКассира" (РМК), а не форма документа.</Item>
					<Item>Перед пробитием вызывается диалог выбора метода оплаты (Нал/Карта).</Item>
				</Items>
			</Block>

			<Block name="History">
				<Record date="2025-10-10">Базовая версия.</Record>
				<Record date="2026-01-15">Адаптация под Украину: Добавлены поля "ФискальныйНомер" (вместо Признака), "АкцизнаяМарка", "НалоговаяГруппа".</Record>
			</Block>
		</Object>
		
		<Object name="ПриходТовара" synonym="Приход товара">
			<Block name="Purpose">
				<Content>Отражение поступления товаров от поставщика на склад.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Header" name="Контрагент" type_val="Справочник.Контрагенты">Поставщик.</Field>
					<Field type="Header" name="Склад" type_val="Справочник.Склады">Место приемки.</Field>
					<Field type="Header" name="ВходящийНомер" type_val="Строка(20)">Номер накладной поставщика.</Field>
					<Field type="Header" name="СуммаДокумента" type_val="Число(15,2)">Общая сумма.</Field>
					<Field type="TabularSection" name="Товары.Номенклатура" type_val="Справочник.Номенклатура"/>
					<Field type="TabularSection" name="Товары.Количество" type_val="Число(15,3)"/>
					<Field type="TabularSection" name="Товары.Цена" type_val="Число(15,2)">Закупочная цена.</Field>
					<Field type="TabularSection" name="Товары.Сумма" type_val="Число(15,2)"/>
					<Field type="TabularSection" name="Товары.ЦенаРозничнаяНовая" type_val="Число(15,2)">Для быстрой переоценки.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item event="ОбработкаПроведения">Движения: Приход по "ОстаткиТоваров", Приход по "Взаиморасчеты" (увеличение долга перед поставщиком), Запись в "ЦеныЗакупки".</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
			</Block>
		</Object>

		<Object name="СписаниеТовара" synonym="Списание товара">
			<Block name="Purpose">
				<Content>Списание товаров (порча, инвентаризация, собственные нужды).</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Header" name="Склад" type_val="Справочник.Склады"/>
					<Field type="TabularSection" name="Товары.Номенклатура" type_val="Справочник.Номенклатура"/>
					<Field type="TabularSection" name="Товары.Количество" type_val="Число(15,3)"/>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item event="ОбработкаПроведения">Движения: Расход по "ОстаткиТоваров".</Item>
					<Item event="Контроль">Если константа "КонтролироватьОстатки" = Истина, проверяет наличие товара на складе.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
			</Block>
		</Object>

		<Object name="ИнвентаризацияТоваров" synonym="Инвентаризация товаров">
			<Block name="Purpose">
				<Content>Фиксация фактического наличия товаров для сравнения с учетным.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Header" name="Склад" type_val="Справочник.Склады"/>
					<Field type="TabularSection" name="Товары.Номенклатура" type_val="Справочник.Номенклатура"/>
					<Field type="TabularSection" name="Товары.УчетноеКоличество" type_val="Число(15,3)">Остаток по программе.</Field>
					<Field type="TabularSection" name="Товары.ФактическоеКоличество" type_val="Число(15,3)">Остаток по факту.</Field>
					<Field type="TabularSection" name="Товары.Отклонение" type_val="Число(15,3)">Разница.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Не делает движений (является основанием для Списания/Оприходования).</Item>
					<Item event="Заполнение">Автозаполнение учетными количествами на дату документа.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
			</Block>
		</Object>

		<Object name="Переоценка" synonym="Переоценка">
			<Block name="Purpose">
				<Content>Установка новых цен продаж.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Header" name="ТипЦен" type_val="Справочник.ТипыЦен"/>
					<Field type="TabularSection" name="Товары.Номенклатура" type_val="Справочник.Номенклатура"/>
					<Field type="TabularSection" name="Товары.Цена" type_val="Число(15,2)"/>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item event="ОбработкаПроведения">Запись в периодический регистр сведений "ЦеныНоменклатуры".</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
			</Block>
		</Object>

		<Object name="ФискальныйЧек" synonym="Фискальный чек">
			<Block name="Purpose">
				<Content>Технический документ, сохраняющий ответ от фискального регистратора/ПРРО.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Header" name="ДокументОснование" type_val="Документ.ЧекККМ"/>
					<Field type="Header" name="ФискальныйНомер" type_val="Строка(50)"/>
					<Field type="Header" name="Оборудование" type_val="Справочник.КассовоеОборудование"/>
					<Field type="TabularSection" name="Товары" type_val="Аналогично ЧекуККМ"/>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Создается программно при успешной фискализации чека.</Item>
					<Item>Не делает движений по складским регистрам.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
			</Block>
		</Object>

		<Object name="ПриходныйКассовыйОрдер" synonym="Приходный кассовый ордер">
			<Block name="Purpose">
				<Content>Поступление наличных денежных средств в кассу.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Header" name="Касса" type_val="Справочник.Кассы"/>
					<Field type="Header" name="СуммаДокумента" type_val="Число(15,2)"/>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item event="ОбработкаПроведения">Приход по регистру "ДенежныеСредства".</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
			</Block>
		</Object>

		<Object name="РасходныйКассовыйОрдер" synonym="Расходный кассовый ордер">
			<Block name="Purpose">
				<Content>Выдача наличных денежных средств из кассы.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Header" name="Касса" type_val="Справочник.Кассы"/>
					<Field type="Header" name="СуммаДокумента" type_val="Число(15,2)"/>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item event="ОбработкаПроведения">Расход по регистру "ДенежныеСредства".</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
			</Block>
		</Object>

		<Object name="ВозвратТовараОтПокупателя" synonym="Возврат товара от покупателя">
			<Block name="Purpose">
				<Content>Оформление возврата товара от клиента (не в рамках смены РМК).</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Header" name="ДокументОснование" type_val="Документ.ЧекККМ"/>
					<Field type="TabularSection" name="Товары" type_val="Список возвращаемых товаров"/>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item event="ОбработкаПроведения">Приход по "ОстаткиТоваров", Сторнирование продаж.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
			</Block>
		</Object>
	</Documents>

    <Enums>
	
		<Object name="ВидыНоменклатуры" synonym="Виды номенклатуры">
			<Block name="Purpose"><Content>Разделение типов запасов.</Content></Block>
			<Block name="DataModel">
				<Fields><Field name="Значения">Товар, Услуга.</Field></Fields>
			</Block>
		</Object>

		<Object name="СтавкиНДС" synonym="Ставки НДС">
			<Block name="Purpose"><Content>Ставки налогообложения (Адаптация: Украина).</Content></Block>
			<Block name="DataModel">
				<Fields><Field name="Значения">НДС20 (20%), НДС7 (7%), НДС0 (0%), БезНДС.</Field></Fields>
			</Block>
			<Block name="History"><Record date="2026-01-15">Добавлены ставки 7% и 0%.</Record></Block>
		</Object>

		<Object name="СтатусыЧекаККМ" synonym="Статусы чека">
			<Block name="Purpose"><Content>Жизненный цикл чека.</Content></Block>
			<Block name="DataModel">
				<Fields><Field name="Значения">Пробит, Отложен, Аннулирован.</Field></Fields>
			</Block>
		</Object>
    
		<Object name="СтатусыКассовойСмены" synonym="Статусы смены">
			<Block name="Purpose"><Content>Жизненный цикл смены (Z-отчет).</Content></Block>
			<Block name="DataModel">
				<Fields><Field name="Значения">Открыта, Закрыта.</Field></Fields>
			</Block>
			<Block name="History"><Record date="2026-01-15">Объект создан для исправления ошибки типизации в РМК.</Record></Block>
		</Object>

		<Object name="ВидыОплаты" synonym="Виды оплаты">
			<Block name="Purpose"><Content>Способы расчета.</Content></Block>
			<Block name="DataModel">
				<Fields><Field name="Значения">Наличные, Карта.</Field></Fields>
			</Block>
		</Object>

		<Object name="ТипыОборудования" synonym="Типы оборудования">
			<Block name="Purpose">
				<Content>Список поддерживаемых видов периферийного оборудования.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field name="Значения">СканерШтрихкода, ПринтерЧеков, ККТ.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Определяет логику работы в "МенеджерОборудования".</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
			</Block>
		</Object>

		<Object name="ЕдиницыИзмерения" synonym="Единицы измерения">
			<Block name="Purpose">
				<Content>Стандартные единицы для номенклатуры.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field name="Значения">шт, кг, л, м.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Используется для вывода в печатные формы.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
			</Block>
		</Object>

		<Object name="ПорядкиОкругленияЦен" synonym="Порядки округления цен">
			<Block name="Purpose">
				<Content>Варианты алгоритмов округления.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field name="Значения">Окр001 (0.01), Окр010 (0.10), Окр050 (0.50), Окр100 (1.00), ОкрВБольшую.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Используется в алгоритмах расчета цен.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
			</Block>
		</Object>
	</Enums>

    <DataProcessors>
		<Object name="РабочееМестоКассира" synonym="РМК (Касса)">
        
			<Block name="Purpose">
				<Content>
					Основной рабочий интерфейс кассира. Обеспечивает подбор товаров, расчет скидок (в перспективе) 
					и оформление чеков без прямого доступа к документам.
				</Content>
			</Block>

			<Block name="DataModel">
				<Fields>
					<Field type="Header" name="Касса" type_val="Справочник.Кассы">Контекст: Текущая касса сеанса.</Field>
					<Field type="Header" name="КассоваяСмена" type_val="Документ.КассоваяСмена">Контекст: Текущая открытая смена.</Field>
					<Field type="TabularSection" name="ТЧ.Номенклатура" type_val="Справочник.Номенклатура">Товар в корзине.</Field>
					<Field type="TabularSection" name="ТЧ.Количество" type_val="Число">Количество.</Field>
					<Field type="TabularSection" name="ТЧ.Цена" type_val="Число">Цена продажи.</Field>
					<Field type="TabularSection" name="ТЧ.Сумма" type_val="Число">Сумма строки.</Field>
					<Field type="TabularSection" name="ТЧ.АкцизнаяМарка" type_val="Строка(200)">Введенный код маркировки.</Field>
				</Fields>
			</Block>

			<Block name="Logic">
				<Items>
					<Item event="ПриОткрытии">
						Проверка наличия открытой смены. Если нет — диалог "Открыть смену?". 
						Если отказ — работа блокируется.
					</Item>
					<Item event="ПодборТовара">
						Используется глобальный поиск (Штрихкод -> Артикул).
						Если товар требует акциз (`Номенклатура.ТребуетАкцизнуюМарку`), открывается окно ввода марки.
						Товар без марки в чек не добавляется.
					</Item>
					<Item event="Оплата">
						Кнопка "Рассчитать" вызывает модальное окно выбора вида оплаты (Наличные / Карта).
						После выбора создается документ "ЧекККМ".
					</Item>
				</Items>
			</Block>

			<Block name="Interface">
				<Items>
					<Item>Динамическая панель "Быстрые товары" (кнопки на экране).</Item>
					<Item>Адаптация под сканер штрихкодов (перехват ввода).</Item>
				</Items>
			</Block>

			<Block name="History">
				<Record date="2025-10-15">Внедрение глобального поиска и панели быстрых товаров.</Record>
				<Record date="2026-01-15">Адаптация под Украину: Логика акцизных марок, Интерактивное открытие смены.</Record>
			</Block>
		</Object>
	
	</DataProcessors>

    <InformationRegisters>
		<Object name="Штрихкоды" synonym="Штрихкоды номенклатуры">
			<Block name="Purpose">
				<Content>Хранение штрихкодов для идентификации товаров сканером.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field name="Штрихкод" type="Строка(200)">Ключевое поле поиска.</Field>
					<Field name="Владелец" type="Справочник.Номенклатура, Справочник.Кассы">Объект, которому принадлежит код.</Field>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Допускаются неуникальные штрихкоды (коллизии). Механизм поиска обрабатывает это выводом списка выбора.</Item>
				</Items>
			</Block>
		</Object>

		<Object name="ЦеныНоменклатуры" synonym="Цены номенклатуры">
			<Block name="Purpose">
				<Content>Хранение розничных цен. Периодический (в пределах дня).</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field name="Период" type="Дата">Дата установки цены.</Field>
					<Field name="Номенклатура" type="Справочник.Номенклатура">Товар.</Field>
					<Field name="Цена" type="Число(15,2)">Стоимость.</Field>
				</Fields>
			</Block>
		</Object>

		<Object name="ЦеныЗакупки" synonym="Цены закупки">
			<Block name="Purpose">
				<Content>Хранение истории закупочных цен (Last Price).</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Dimension" name="Номенклатура"/>
					<Field type="Resource" name="Цена"/>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Записывается при проведении документа "ПриходТовара".</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
			</Block>
		</Object>

		<Object name="НастройкиРаспределенияПродаж" synonym="Настройки распределения продаж">
			<Block name="Purpose">
				<Content>Матрица распределения: Какая касса с каким фискальным регистратором работает.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Dimension" name="Касса"/>
					<Field type="Dimension" name="НалоговаяГруппа"/>
					<Field type="Resource" name="Оборудование"/>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Используется при пробитии чека для выбора оборудования.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
			</Block>
		</Object>
    </InformationRegisters>

    <AccumulationRegisters>
		<Object name="ОстаткиТоваров" synonym="Остатки товаров">
			<Block name="Purpose">
				<Content>Учет количественных остатков на складах.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Dimension" name="Склад">Место хранения.</Field>
					<Field type="Dimension" name="Номенклатура">Товар.</Field>
					<Field type="Resource" name="Количество">Остаток.</Field>
				</Fields>
			</Block>
		</Object>

		<Object name="Продажи" synonym="Продажи (Обороты)">
			<Block name="Purpose">
				<Content>Фиксация выручки и себестоимости.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Resource" name="Сумма">Выручка.</Field>
					<Field type="Resource" name="Себестоимость">Закупочная стоимость.</Field>
				</Fields>
			</Block>
		</Object>
	
		<Object name="ДенежныеСредства" synonym="Денежные средства">
			<Block name="Purpose">
				<Content>Учет наличных денег в кассах ККМ.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Dimension" name="Касса"/>
					<Field type="Resource" name="Сумма"/>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Остатки.</Item>
					<Item>Двигается ПКО, РКО, Чеками ККМ.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
			</Block>
		</Object>

		<Object name="Взаиморасчеты" synonym="Взаиморасчеты">
			<Block name="Purpose">
				<Content>Учет долгов перед поставщиками.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Dimension" name="Контрагент"/>
					<Field type="Resource" name="Сумма"/>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Остатки.</Item>
					<Item>Приход - долг перед поставщиком, Расход - оплата.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
			</Block>
		</Object>

		<Object name="ПродажиПоДисконтнымКартам" synonym="Продажи по дисконтным картам">
			<Block name="Purpose">
				<Content>Аналитика покупок в разрезе карт лояльности.</Content>
			</Block>
			<Block name="DataModel">
				<Fields>
					<Field type="Dimension" name="ДисконтнаяКарта"/>
					<Field type="Resource" name="Сумма"/>
				</Fields>
			</Block>
			<Block name="Logic">
				<Items>
					<Item>Обороты.</Item>
					<Item>Записывается при проведении Чека ККМ с указанной картой.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание объекта.</Record>
			</Block>
		</Object>
    </AccumulationRegisters>

    <CommonModules>
		<Object name="ОбщегоНазначенияКлиент" synonym="Общего назначения (Клиент)">
		
			<Block name="Purpose">
				<Content>Глобальные клиентские алгоритмы, доступные из любой формы.</Content>
			</Block>
			<Block name="Logic">
				<Items>
					<Item method="НайтиИОбработатьТовар(Штрихкод, Оповещение)">
						Входная точка алгоритма поиска.
						1. Ищет штрихкод. 
						2. Если найдено несколько — открывает список выбора. 
						3. Если не найдено — ищет по Артикулу/Коду.
						4. Возвращает ссылку в ОбработчикОповещения.
					</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2025-10-15">Создан для реализации архитектуры "Тонкий клиент".</Record>
			</Block>
		</Object>
		
		<Object name="ОбщегоНазначения" synonym="Общего назначения">
			<Block name="Purpose">
				<Content>
					Серверный модуль для глобальных алгоритмов системы. 
					Содержит логику поиска товара, ценообразования и получения настроек оборудования.
				</Content>
			</Block>

			<Block name="Logic">
				<Items>
					<Item method="НайтиТовар(СтрокаПоиска)">
						Универсальный поиск товара (возвращает Ссылку, Массив или Неопределено).
						Алгоритм:
						1. Ищет точное совпадение в регистре "Штрихкоды".
						2. Если не найдено — ищет по полям "Код" ИЛИ "Артикул" в справочнике "Номенклатура".
					</Item>
					<Item method="НайтиТоварыПоШтрихкоду(Штрихкод, ДатаАктуальности)">
						Вспомогательная функция. Возвращает массив структур с данными товаров (Номенклатура, Цена, Представление) по точному совпадению штрихкода.
					</Item>
					<Item method="ПолучитьНастройкиСканера()">
						Ищет в справочнике "КассовоеОборудование" первое активное устройство с типом "СканерШтрихкода" и возвращает структуру параметров подключения (Порт, Скорость и др.).
					</Item>
					<Item method="ПолучитьРозничнуюЦену(Дата, Номенклатура)">
						Получает срез последних цен из регистра "ЦеныНоменклатуры" по типу цен с наименованием "Розничная".
					</Item>
				</Items>
			</Block>

			<Block name="History">
				<Record date="2026-01-15">Создание модуля. Реализация поиска и функций работы с БД.</Record>
			</Block>
		</Object>
		<Object name="МенеджерОборудования" synonym="Менеджер оборудования">
			<Block name="Purpose">
				<Content>Серверная логика управления драйверами оборудования.</Content>
			</Block>
			<Block name="Logic">
				<Items>
					<Item method="ПодключитьОборудование">Инициализация драйвера по ID.</Item>
					<Item method="ФискализироватьЧек">Отправка XML-пакета чека на устройство.</Item>
				</Items>
			</Block>
			<Block name="History">
				<Record date="2026-01-15">Создание модуля.</Record>
			</Block>
		</Object>
    </CommonModules>

</Configuration>


