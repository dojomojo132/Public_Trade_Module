Процедура ЗаполнитьДанные(КоличествоЭлементов, КоличествоГрупп, КоличествоЭлементовВГруппе) Экспорт
	ОчиститьДанные();
	МассивГрупп = СоздатьГруппы(КоличествоГрупп);
	СоздатьТовары(КоличествоЭлементов, МассивГрупп, КоличествоЭлементовВГруппе);
	СообщитьОбУспехе(КоличествоГрупп, КоличествоЭлементов);
КонецПроцедуры

Процедура ОчиститьДанные()
	Запрос = Новый Запрос;
	Запрос.Текст = "
	|ВЫБРАТЬ
	|	Номенклатура.Ссылка
	|ИЗ
	|	Справочник.Номенклатура КАК Номенклатура
	|ГДЕ
	|	НЕ Номенклатура.Предопределенный
	|";
	
	РезультатЗапроса = Запрос.Выполнить();
	ВыборкаДетальныхЗаписей = РезультатЗапроса.Выбрать();
	

	Пока ВыборкаДетальныхЗаписей.Следующий() Цикл
		Объект = ВыборкаДетальныхЗаписей.Ссылка.ПолучитьОбъект();
		Попытка
			Объект.Удалить();
		Исключение
			Объект.ПометкаУдаления(Истина);
		КонецПопытки;
	КонецЦикла;
КонецПроцедуры



Функция СоздатьГруппы(КоличествоГрупп)
	ШаблоныНазванийГрупп = Новый Массив;
	ШаблоныНазванийГрупп.Добавить("Электроника");
	ШаблоныНазванийГрупп.Добавить("Одежда");
	ШаблоныНазванийГрупп.Добавить("Продукты");
	ШаблоныНазванийГрупп.Добавить("Мебель");
	ШаблоныНазванийГрупп.Добавить("Книги");
	ШаблоныНазванийГрупп.Добавить("Спорт");
	ШаблоныНазванийГрупп.Добавить("Игрушки");
	ШаблоныНазванийГрупп.Добавить("Бытовая техника");
	ШаблоныНазванийГрупп.Добавить("Автотовары");
	ШаблоныНазванийГрупп.Добавить("Канцтовары");
	
	МассивГрупп = Новый Массив;
	
	Для Инд = 1 По КоличествоГрупп Цикл
		НовыйОбъект = Справочники.Номенклатура.СоздатьГруппу();
		
		Если Инд <= ШаблоныНазванийГрупп.Количество() Тогда
			НовыйОбъект.Наименование = ШаблоныНазванийГрупп[Инд - 1];
		Иначе
			НовыйОбъект.Наименование = "Группа " + Формат(Инд, "ЧЦ=3; ЧВН=; ЧГ=0");
		КонецЕсли;
		
		НовыйОбъект.Код = Формат(Инд, "ЧЦ=5; ЧВН=; ЧГ=");
		
		Попытка
			НовыйОбъект.Записать();
			МассивГрупп.Добавить(НовыйОбъект.Ссылка);
		Исключение
			Сообщить("Ошибка создания группы " + НовыйОбъект.Наименование + ": " + ОписаниеОшибки());
		КонецПопытки;
	КонецЦикла;
	
	Возврат МассивГрупп;
КонецФункции

Процедура СоздатьТовары(КоличествоЭлементов, МассивГрупп, КоличествоЭлементовВГруппе)
	Если МассивГрупп.Количество() = 0 Тогда
		Сообщить("Не найдено групп номенклатуры!");
		Возврат;
	КонецЕсли;
	
	ЕдиницыИзмерения = Новый Массив;
	ЕдиницыИзмерения.Добавить(Перечисления.ЕдиницыИзмерения.шт);
	ЕдиницыИзмерения.Добавить(Перечисления.ЕдиницыИзмерения.кг);
	ЕдиницыИзмерения.Добавить(Перечисления.ЕдиницыИзмерения.л);
	ЕдиницыИзмерения.Добавить(Перечисления.ЕдиницыИзмерения.м);
	
	СтавкиНДС = Новый Массив;
	СтавкиНДС.Добавить(Перечисления.СтавкиНДС.БезНДС);
	СтавкиНДС.Добавить(Перечисления.СтавкиНДС.НДС20);
	СтавкиНДС.Добавить(Перечисления.СтавкиНДС.НДС7);
	СтавкиНДС.Добавить(Перечисления.СтавкиНДС.НДС0);
	
	НалоговыеГруппы = ПолучитьНалоговыеГруппы();
	
	ТекущаяГруппа = 0;
	ЭлементовВТекущейГруппе = 0;
	
	Для НомерТовара = 1 По КоличествоЭлементов Цикл
		НовыйОбъект = Справочники.Номенклатура.СоздатьЭлемент();
		
		// Распределение по группам согласно КоличествоЭлементовВГруппе
		Если ЭлементовВТекущейГруппе >= КоличествоЭлементовВГруппе Тогда
			ТекущаяГруппа = ТекущаяГруппа + 1;
			ЭлементовВТекущейГруппе = 0;
			
			// Если закончились группы, начинаем сначала
			Если ТекущаяГруппа >= МассивГрупп.Количество() Тогда
				ТекущаяГруппа = 0;
			КонецЕсли;
		КонецЕсли;
		
		НовыйОбъект.Родитель = МассивГрупп[ТекущаяГруппа];
		НовыйОбъект.Наименование = СформироватьНазваниеТовара(НомерТовара);
		ЭлементовВТекущейГруппе = ЭлементовВТекущейГруппе + 1;
		НовыйОбъект.Код = Формат(300 + НомерТовара, "ЧЦ=5; ЧВН=; ЧГ=");
		НовыйОбъект.Артикул = "ART" + Формат(НомерТовара, "ЧЦ=6; ЧВН=; ЧГ=0");
		НовыйОбъект.ЕдиницаИзмерения = ЕдиницыИзмерения[(НомерТовара - 1) % ЕдиницыИзмерения.Количество()];
		НовыйОбъект.СтавкаНДС = СтавкиНДС[(НомерТовара - 1) % СтавкиНДС.Количество()];
		
		Если НалоговыеГруппы.Количество() > 0 Тогда
			НовыйОбъект.НалоговаяГруппа = НалоговыеГруппы[(НомерТовара - 1) % НалоговыеГруппы.Количество()];
		КонецЕсли;
		
		НовыйОбъект.КодУКТЗЕД = Формат(1234567890 + НомерТовара, "ЧЦ=10; ЧВН=; ЧГ=");
		НовыйОбъект.ТребуетАкцизнуюМарку = (НомерТовара % 10 = 0);
		НовыйОбъект.ПроцентНаценки = 10 + (НомерТовара % 50);
		
		Попытка
			НовыйОбъект.Записать();
		Исключение
			Сообщить("Ошибка создания товара №" + НомерТовара + ": " + ОписаниеОшибки());
		КонецПопытки;
	КонецЦикла;
КонецПроцедуры

Функция ПолучитьНалоговыеГруппы()
	Запрос = Новый Запрос;
	Запрос.Текст = "
	|ВЫБРАТЬ
	|	НалоговыеГруппы.Ссылка
	|ИЗ
	|	Справочник.НалоговыеГруппы КАК НалоговыеГруппы
	|ГДЕ
	|	НЕ НалоговыеГруппы.ПометкаУдаления
	|";
	
	РезультатЗапроса = Запрос.Выполнить();
	ВыборкаГрупп = РезультатЗапроса.Выбрать();
	
	МассивГрупп = Новый Массив;
	Пока ВыборкаГрупп.Следующий() Цикл
		МассивГрупп.Добавить(ВыборкаГрупп.Ссылка);
	КонецЦикла;
	
	Возврат МассивГрупп;
КонецФункции

Функция СформироватьНазваниеТовара(НомерТовара)
	ТипыТоваров = Новый Массив;
	ТипыТоваров.Добавить("Товар");
	ТипыТоваров.Добавить("Изделие");
	ТипыТоваров.Добавить("Продукт");
	ТипыТоваров.Добавить("Устройство");
	ТипыТоваров.Добавить("Компонент");
	
	НазванияТоваров = Новый Массив;
	НазванияТоваров.Добавить("Стандартный");
	НазванияТоваров.Добавить("Премиум");
	НазванияТоваров.Добавить("Эконом");
	НазванияТоваров.Добавить("Профессиональный");
	НазванияТоваров.Добавить("Универсальный");
	
	ТипТовара = ТипыТоваров[(НомерТовара - 1) % ТипыТоваров.Количество()];
	НазваниеТовара = НазванияТоваров[(НомерТовара - 1) % НазванияТоваров.Количество()];
	
	Возврат ТипТовара + " " + НазваниеТовара + " №" + Формат(НомерТовара, "ЧЦ=3; ЧВН=; ЧГ=0");
КонецФункции

Процедура СообщитьОбУспехе(КоличествоГрупп, КоличествоЭлементов)
	Сообщить("Номенклатура успешно заполнена! Создано: " + Формат(КоличествоГрупп, "ЧГ=0") + " групп, " + Формат(КоличествоЭлементов, "ЧГ=0") + " товаров.");
КонецПроцедуры
Процедура ОбработкаПроверкиЗаполнения(Отказ, ПроверяемыеРеквизиты)
	// Вставить содержимое обработчика.
КонецПроцедуры
