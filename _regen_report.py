# -*- coding: utf-8 -*-
"""Regenerate report with proper random UUIDs"""
import pathlib
import uuid

# Generate PROPER random UUIDs
REPORT_UUID = str(uuid.uuid4())
OBJ_TYPE_ID = str(uuid.uuid4())
OBJ_VALUE_ID = str(uuid.uuid4())
MGR_TYPE_ID = str(uuid.uuid4())
MGR_VALUE_ID = str(uuid.uuid4())
FORM_UUID = str(uuid.uuid4())

print(f"Report UUID:    {REPORT_UUID}")
print(f"Obj TypeId:     {OBJ_TYPE_ID}")
print(f"Obj ValueId:    {OBJ_VALUE_ID}")
print(f"Mgr TypeId:     {MGR_TYPE_ID}")
print(f"Mgr ValueId:    {MGR_VALUE_ID}")
print(f"Form UUID:      {FORM_UUID}")

# Generate random configVersion (32hex + 00000000)
import secrets
def random_cv():
    return secrets.token_hex(16) + "00000000"

CV_REPORT = random_cv()
CV_OBJMOD = random_cv()
CV_FORM = random_cv()
CV_FORMCONTENT = random_cv()

BASE = pathlib.Path(r"D:\Git\Public_Trade_Module\Конфигурация")
COPY = pathlib.Path(r"D:\Git\Public_Trade_Module\Конфигурация\Проверка")

# === 1. Report XML ===
report_xml = f'''<?xml version="1.0" encoding="UTF-8"?>
<MetaDataObject xmlns="http://v8.1c.ru/8.3/MDClasses" xmlns:app="http://v8.1c.ru/8.2/managed-application/core" xmlns:cfg="http://v8.1c.ru/8.1/data/enterprise/current-config" xmlns:cmi="http://v8.1c.ru/8.2/managed-application/cmi" xmlns:ent="http://v8.1c.ru/8.1/data/enterprise" xmlns:lf="http://v8.1c.ru/8.2/managed-application/logform" xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows" xmlns:xen="http://v8.1c.ru/8.3/xcf/enums" xmlns:xpr="http://v8.1c.ru/8.3/xcf/predef" xmlns:xr="http://v8.1c.ru/8.3/xcf/readable" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="2.20">
\t<Report uuid="{REPORT_UUID}">
\t\t<InternalInfo>
\t\t\t<xr:GeneratedType name="ReportObject.\u0421\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a\u041d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u044b" category="Object">
\t\t\t\t<xr:TypeId>{OBJ_TYPE_ID}</xr:TypeId>
\t\t\t\t<xr:ValueId>{OBJ_VALUE_ID}</xr:ValueId>
\t\t\t</xr:GeneratedType>
\t\t\t<xr:GeneratedType name="ReportManager.\u0421\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a\u041d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u044b" category="Manager">
\t\t\t\t<xr:TypeId>{MGR_TYPE_ID}</xr:TypeId>
\t\t\t\t<xr:ValueId>{MGR_VALUE_ID}</xr:ValueId>
\t\t\t</xr:GeneratedType>
\t\t</InternalInfo>
\t\t<Properties>
\t\t\t<Name>\u0421\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a\u041d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u044b</Name>
\t\t\t<Synonym>
\t\t\t\t<v8:item>
\t\t\t\t\t<v8:lang>ru</v8:lang>
\t\t\t\t\t<v8:content>\u0421\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a \u043d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u044b</v8:content>
\t\t\t\t</v8:item>
\t\t\t</Synonym>
\t\t\t<Comment/>
\t\t\t<UseStandardCommands>true</UseStandardCommands>
\t\t\t<DefaultForm>Report.\u0421\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a\u041d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u044b.Form.\u0424\u043e\u0440\u043c\u0430\u041e\u0442\u0447\u0435\u0442\u0430</DefaultForm>
\t\t\t<AuxiliaryForm/>
\t\t\t<MainDataCompositionSchema/>
\t\t\t<DefaultSettingsForm/>
\t\t\t<AuxiliarySettingsForm/>
\t\t\t<DefaultVariantForm/>
\t\t\t<VariantsStorage/>
\t\t\t<SettingsStorage/>
\t\t\t<IncludeHelpInContents>false</IncludeHelpInContents>
\t\t\t<ExtendedPresentation/>
\t\t\t<Explanation/>
\t\t</Properties>
\t\t<ChildObjects>
\t\t\t<Form>\u0424\u043e\u0440\u043c\u0430\u041e\u0442\u0447\u0435\u0442\u0430</Form>
\t\t</ChildObjects>
\t</Report>
</MetaDataObject>
'''

# === 2. Form descriptor ===
form_descriptor_xml = f'''<?xml version="1.0" encoding="UTF-8"?>
<MetaDataObject xmlns="http://v8.1c.ru/8.3/MDClasses" xmlns:app="http://v8.1c.ru/8.2/managed-application/core" xmlns:cfg="http://v8.1c.ru/8.1/data/enterprise/current-config" xmlns:cmi="http://v8.1c.ru/8.2/managed-application/cmi" xmlns:ent="http://v8.1c.ru/8.1/data/enterprise" xmlns:lf="http://v8.1c.ru/8.2/managed-application/logform" xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows" xmlns:xen="http://v8.1c.ru/8.3/xcf/enums" xmlns:xpr="http://v8.1c.ru/8.3/xcf/predef" xmlns:xr="http://v8.1c.ru/8.3/xcf/readable" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="2.20">
\t<Form uuid="{FORM_UUID}">
\t\t<Properties>
\t\t\t<Name>\u0424\u043e\u0440\u043c\u0430\u041e\u0442\u0447\u0435\u0442\u0430</Name>
\t\t\t<Synonym>
\t\t\t\t<v8:item>
\t\t\t\t\t<v8:lang>ru</v8:lang>
\t\t\t\t\t<v8:content>\u0424\u043e\u0440\u043c\u0430 \u043e\u0442\u0447\u0435\u0442\u0430</v8:content>
\t\t\t\t</v8:item>
\t\t\t</Synonym>
\t\t\t<Comment/>
\t\t\t<FormType>Managed</FormType>
\t\t\t<IncludeHelpInContents>false</IncludeHelpInContents>
\t\t\t<UsePurposes>
\t\t\t\t<v8:Value xsi:type="app:ApplicationUsePurpose">PlatformApplication</v8:Value>
\t\t\t\t<v8:Value xsi:type="app:ApplicationUsePurpose">MobilePlatformApplication</v8:Value>
\t\t\t</UsePurposes>
\t\t\t<ExtendedPresentation/>
\t\t</Properties>
\t</Form>
</MetaDataObject>
'''

# === 3. Form.xml (compact format) ===
form_xml = '''<?xml version="1.0" encoding="UTF-8"?>
<Form xmlns="http://v8.1c.ru/8.3/xcf/logform" xmlns:app="http://v8.1c.ru/8.2/managed-application/core" xmlns:cfg="http://v8.1c.ru/8.1/data/enterprise/current-config" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcssch="http://v8.1c.ru/8.1/data-composition-system/schema" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:ent="http://v8.1c.ru/8.1/data/enterprise" xmlns:lf="http://v8.1c.ru/8.2/managed-application/logform" xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows" xmlns:xr="http://v8.1c.ru/8.3/xcf/readable" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="2.20">
\t<AutoCommandBar name="\u0424\u043e\u0440\u043c\u0430\u041a\u043e\u043c\u0430\u043d\u0434\u043d\u0430\u044f\u041f\u0430\u043d\u0435\u043b\u044c" id="-1">
\t\t<ChildItems>
\t\t\t<Button name="\u0424\u043e\u0440\u043c\u0430\u0421\u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u0442\u044c" id="1">
\t\t\t\t<Type>CommandBarButton</Type>
\t\t\t\t<CommandName>Form.Command.\u0421\u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u0442\u044c</CommandName>
\t\t\t\t<DefaultButton>true</DefaultButton>
\t\t\t\t<ExtendedTooltip name="\u0424\u043e\u0440\u043c\u0430\u0421\u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0420\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u043d\u0430\u044f\u041f\u043e\u0434\u0441\u043a\u0430\u0437\u043a\u0430" id="2"/>
\t\t\t</Button>
\t\t</ChildItems>
\t</AutoCommandBar>
\t<ChildItems>
\t\t<SpreadsheetDocumentField name="\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u041e\u0442\u0447\u0435\u0442\u0430" id="3">
\t\t\t<DataPath>\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u041e\u0442\u0447\u0435\u0442\u0430</DataPath>
\t\t\t<HorizontalStretch>true</HorizontalStretch>
\t\t\t<VerticalStretch>true</VerticalStretch>
\t\t\t<ContextMenu name="\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u041e\u0442\u0447\u0435\u0442\u0430\u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u043d\u043e\u0435\u041c\u0435\u043d\u044e" id="4"/>
\t\t\t<ExtendedTooltip name="\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u041e\u0442\u0447\u0435\u0442\u0430\u0420\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u043d\u0430\u044f\u041f\u043e\u0434\u0441\u043a\u0430\u0437\u043a\u0430" id="5"/>
\t\t</SpreadsheetDocumentField>
\t</ChildItems>
\t<Attributes>
\t\t<Attribute name="\u041e\u0442\u0447\u0435\u0442" id="1">
\t\t\t<Type>
\t\t\t\t<v8:Type>cfg:ReportObject.\u0421\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a\u041d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u044b</v8:Type>
\t\t\t</Type>
\t\t\t<MainAttribute>true</MainAttribute>
\t\t</Attribute>
\t\t<Attribute name="\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u041e\u0442\u0447\u0435\u0442\u0430" id="2">
\t\t\t<Title>
\t\t\t\t<v8:item>
\t\t\t\t\t<v8:lang>ru</v8:lang>
\t\t\t\t\t<v8:content>\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442</v8:content>
\t\t\t\t</v8:item>
\t\t\t</Title>
\t\t\t<Type>
\t\t\t\t<v8:Type>v8ui:SpreadsheetDocument</v8:Type>
\t\t\t</Type>
\t\t</Attribute>
\t</Attributes>
\t<Commands>
\t\t<Command name="\u0421\u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u0442\u044c" id="1">
\t\t\t<Title>
\t\t\t\t<v8:item>
\t\t\t\t\t<v8:lang>ru</v8:lang>
\t\t\t\t\t<v8:content>\u0421\u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u0442\u044c</v8:content>
\t\t\t\t</v8:item>
\t\t\t</Title>
\t\t\t<Action>\u0421\u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u0442\u044c</Action>
\t\t</Command>
\t</Commands>
</Form>
'''

# === 4. Form Module ===
form_module_bsl = '#\u041e\u0431\u043b\u0430\u0441\u0442\u044c \u041e\u0431\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0438\u041a\u043e\u043c\u0430\u043d\u0434\u0424\u043e\u0440\u043c\u044b\n\n&\u041d\u0430\u041a\u043b\u0438\u0435\u043d\u0442\u0435\n\u041f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u0430 \u0421\u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u0442\u044c(\u041a\u043e\u043c\u0430\u043d\u0434\u0430)\n\t\u0421\u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u041d\u0430\u0421\u0435\u0440\u0432\u0435\u0440\u0435();\n\u041a\u043e\u043d\u0435\u0446\u041f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u044b\n\n#\u041a\u043e\u043d\u0435\u0446\u041e\u0431\u043b\u0430\u0441\u0442\u0438\n\n#\u041e\u0431\u043b\u0430\u0441\u0442\u044c \u0421\u043b\u0443\u0436\u0435\u0431\u043d\u044b\u0435\u041f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u044b\u0418\u0424\u0443\u043d\u043a\u0446\u0438\u0438\n\n&\u041d\u0430\u0421\u0435\u0440\u0432\u0435\u0440\u0435\n\u041f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u0430 \u0421\u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u041d\u0430\u0421\u0435\u0440\u0432\u0435\u0440\u0435()\n\t\u041e\u0431\u044a\u0435\u043a\u0442\u041e\u0442\u0447\u0435\u0442\u0430 = \u0420\u0435\u043a\u0432\u0438\u0437\u0438\u0442\u0424\u043e\u0440\u043c\u044b\u0412\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435("\u041e\u0442\u0447\u0435\u0442");\n\t\u041e\u0431\u044a\u0435\u043a\u0442\u041e\u0442\u0447\u0435\u0442\u0430.\u0421\u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u041e\u0442\u0447\u0435\u0442(\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u041e\u0442\u0447\u0435\u0442\u0430);\n\u041a\u043e\u043d\u0435\u0446\u041f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u044b\n\n#\u041a\u043e\u043d\u0435\u0446\u041e\u0431\u043b\u0430\u0441\u0442\u0438\n'

# === 5. Object Module ===
object_module_bsl = '#\u041e\u0431\u043b\u0430\u0441\u0442\u044c \u041f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u043d\u044b\u0439\u0418\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\n\n\u041f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u0430 \u0421\u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u041e\u0442\u0447\u0435\u0442(\u0422\u0430\u0431\u0414\u043e\u043a) \u042d\u043a\u0441\u043f\u043e\u0440\u0442\n\t\n\t\u0422\u0430\u0431\u0414\u043e\u043a.\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c();\n\t\n\t\u0417\u0430\u043f\u0440\u043e\u0441 = \u041d\u043e\u0432\u044b\u0439 \u0417\u0430\u043f\u0440\u043e\u0441;\n\t\u0417\u0430\u043f\u0440\u043e\u0441.\u0422\u0435\u043a\u0441\u0442 =\n\t"\u0412\u042b\u0411\u0420\u0410\u0422\u042c\n\t|\u041d\u043e\u043c.\u0410\u0440\u0442\u0438\u043a\u0443\u043b \u041a\u0410\u041a \u0410\u0440\u0442\u0438\u043a\u0443\u043b,\n\t|\u041d\u043e\u043c.\u0421\u0441\u044b\u043b\u043a\u0430 \u041a\u0410\u041a \u041d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u0430,\n\t|\u041d\u043e\u043c.\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u041a\u0410\u041a \u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435,\n\t|\u041d\u043e\u043c.\u0415\u0434\u0438\u043d\u0438\u0446\u0430\u0418\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u044f \u041a\u0410\u041a \u0415\u0434\u0438\u043d\u0438\u0446\u0430\u0418\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u044f,\n\t|\u0415\u0421\u0422\u042cNULL(\u0426\u0435\u043d\u044b.\u0426\u0435\u043d\u0430, 0) \u041a\u0410\u041a \u0426\u0435\u043d\u0430,\n\t|\u0415\u0421\u0422\u042cNULL(\u041e\u0441\u0442\u0430\u0442\u043a\u0438.\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e\u041e\u0441\u0442\u0430\u0442\u043e\u043a, 0) \u041a\u0410\u041a \u041e\u0441\u0442\u0430\u0442\u043e\u043a\n\t|\u0418\u0417\n\t|\u0421\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a.\u041d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u0430 \u041a\u0410\u041a \u041d\u043e\u043c\n\t|\t\u041b\u0415\u0412\u041e\u0415 \u0421\u041e\u0415\u0414\u0418\u041d\u0415\u041d\u0418\u0415 \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0421\u0432\u0435\u0434\u0435\u043d\u0438\u0439.\u0426\u0435\u043d\u044b\u041d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u044b.\u0421\u0440\u0435\u0437\u041f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0445(, \u0422\u0438\u043f\u0426\u0435\u043d = &\u0422\u0438\u043f\u0426\u0435\u043d) \u041a\u0410\u041a \u0426\u0435\u043d\u044b\n\t|\t\u041f\u041e \u041d\u043e\u043c.\u0421\u0441\u044b\u043b\u043a\u0430 = \u0426\u0435\u043d\u044b.\u041d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u0430\n\t|\t\u041b\u0415\u0412\u041e\u0415 \u0421\u041e\u0415\u0414\u0418\u041d\u0415\u041d\u0418\u0415 \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u041d\u0430\u043a\u043e\u043f\u043b\u0435\u043d\u0438\u044f.\u041e\u0441\u0442\u0430\u0442\u043a\u0438\u0422\u043e\u0432\u0430\u0440\u043e\u0432.\u041e\u0441\u0442\u0430\u0442\u043a\u0438 \u041a\u0410\u041a \u041e\u0441\u0442\u0430\u0442\u043a\u0438\n\t|\t\u041f\u041e \u041d\u043e\u043c.\u0421\u0441\u044b\u043b\u043a\u0430 = \u041e\u0441\u0442\u0430\u0442\u043a\u0438.\u041d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u0430\n\t|\u0413\u0414\u0415\n\t|\u041d\u0415 \u041d\u043e\u043c.\u042d\u0442\u043e\u0413\u0440\u0443\u043f\u043f\u0430\n\t|\u0423\u041f\u041e\u0420\u042f\u0414\u041e\u0427\u0418\u0422\u042c \u041f\u041e\n\t|\u041d\u043e\u043c.\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435";\n\t\n\t\u0417\u0430\u043f\u0440\u043e\u0441.\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440("\u0422\u0438\u043f\u0426\u0435\u043d", \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438\u041f\u043e\u0423\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e.\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c\u041e\u0441\u043d\u043e\u0432\u043d\u043e\u0439\u0422\u0438\u043f\u0426\u0435\u043d());\n\t\n\t\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 = \u0417\u0430\u043f\u0440\u043e\u0441.\u0412\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c();\n\t\u0412\u044b\u0431\u043e\u0440\u043a\u0430 = \u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442.\u0412\u044b\u0431\u0440\u0430\u0442\u044c();\n\t\n\t\u0417\u0430\u043f\u0440\u043e\u0441\u0428\u041a = \u041d\u043e\u0432\u044b\u0439 \u0417\u0430\u043f\u0440\u043e\u0441;\n\t\u0417\u0430\u043f\u0440\u043e\u0441\u0428\u041a.\u0422\u0435\u043a\u0441\u0442 =\n\t"\u0412\u042b\u0411\u0420\u0410\u0422\u042c\n\t|\u0428\u0442\u0440\u0438\u0445\u043a\u043e\u0434\u044b.\u041d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u0430 \u041a\u0410\u041a \u041d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u0430,\n\t|\u0428\u0442\u0440\u0438\u0445\u043a\u043e\u0434\u044b.\u0428\u0442\u0440\u0438\u0445\u043a\u043e\u0434 \u041a\u0410\u041a \u0428\u0442\u0440\u0438\u0445\u043a\u043e\u0434\n\t|\u0418\u0417\n\t|\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0421\u0432\u0435\u0434\u0435\u043d\u0438\u0439.\u0428\u0442\u0440\u0438\u0445\u043a\u043e\u0434\u044b \u041a\u0410\u041a \u0428\u0442\u0440\u0438\u0445\u043a\u043e\u0434\u044b\n\t|\u0423\u041f\u041e\u0420\u042f\u0414\u041e\u0427\u0418\u0422\u042c \u041f\u041e\n\t|\u0428\u0442\u0440\u0438\u0445\u043a\u043e\u0434\u044b.\u041d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u0430,\n\t|\u0428\u0442\u0440\u0438\u0445\u043a\u043e\u0434\u044b.\u0428\u0442\u0440\u0438\u0445\u043a\u043e\u0434";\n\t\n\t\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0428\u041a = \u0417\u0430\u043f\u0440\u043e\u0441\u0428\u041a.\u0412\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c();\n\t\u0412\u044b\u0431\u043e\u0440\u043a\u0430\u0428\u041a = \u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0428\u041a.\u0412\u044b\u0431\u0440\u0430\u0442\u044c();\n\t\n\t\u0421\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0435\u0428\u041a = \u041d\u043e\u0432\u044b\u0439 \u0421\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0435;\n\t\u041f\u043e\u043a\u0430 \u0412\u044b\u0431\u043e\u0440\u043a\u0430\u0428\u041a.\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439() \u0426\u0438\u043a\u043b\n\t\t\u0422\u0435\u043a\u0443\u0449\u0438\u0435\u0428\u041a = \u0421\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0435\u0428\u041a[\u0412\u044b\u0431\u043e\u0440\u043a\u0430\u0428\u041a.\u041d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u0430];\n\t\t\u0415\u0441\u043b\u0438 \u0422\u0435\u043a\u0443\u0449\u0438\u0435\u0428\u041a = \u041d\u0435\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043e \u0422\u043e\u0433\u0434\u0430\n\t\t\t\u0421\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0435\u0428\u041a.\u0412\u0441\u0442\u0430\u0432\u0438\u0442\u044c(\u0412\u044b\u0431\u043e\u0440\u043a\u0430\u0428\u041a.\u041d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u0430, \u0412\u044b\u0431\u043e\u0440\u043a\u0430\u0428\u041a.\u0428\u0442\u0440\u0438\u0445\u043a\u043e\u0434);\n\t\t\u0418\u043d\u0430\u0447\u0435\n\t\t\t\u0421\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0435\u0428\u041a.\u0412\u0441\u0442\u0430\u0432\u0438\u0442\u044c(\u0412\u044b\u0431\u043e\u0440\u043a\u0430\u0428\u041a.\u041d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u0430, \u0422\u0435\u043a\u0443\u0449\u0438\u0435\u0428\u041a + ", " + \u0412\u044b\u0431\u043e\u0440\u043a\u0430\u0428\u041a.\u0428\u0442\u0440\u0438\u0445\u043a\u043e\u0434);\n\t\t\u041a\u043e\u043d\u0435\u0446\u0415\u0441\u043b\u0438;\n\t\u041a\u043e\u043d\u0435\u0446\u0426\u0438\u043a\u043b\u0430;\n\t\n\t\u0422\u0430\u0431\u0414\u043e\u043a.\u041e\u0431\u043b\u0430\u0441\u0442\u044c(1, 1, 1, 1).\u0422\u0435\u043a\u0441\u0442 = "\u0410\u0440\u0442\u0438\u043a\u0443\u043b";\n\t\u0422\u0430\u0431\u0414\u043e\u043a.\u041e\u0431\u043b\u0430\u0441\u0442\u044c(1, 2, 1, 2).\u0422\u0435\u043a\u0441\u0442 = "\u041d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u0430";\n\t\u0422\u0430\u0431\u0414\u043e\u043a.\u041e\u0431\u043b\u0430\u0441\u0442\u044c(1, 3, 1, 3).\u0422\u0435\u043a\u0441\u0442 = "\u0415\u0434. \u0438\u0437\u043c.";\n\t\u0422\u0430\u0431\u0414\u043e\u043a.\u041e\u0431\u043b\u0430\u0441\u0442\u044c(1, 4, 1, 4).\u0422\u0435\u043a\u0441\u0442 = "\u0426\u0435\u043d\u0430";\n\t\u0422\u0430\u0431\u0414\u043e\u043a.\u041e\u0431\u043b\u0430\u0441\u0442\u044c(1, 5, 1, 5).\u0422\u0435\u043a\u0441\u0442 = "\u041e\u0441\u0442\u0430\u0442\u043e\u043a";\n\t\u0422\u0430\u0431\u0414\u043e\u043a.\u041e\u0431\u043b\u0430\u0441\u0442\u044c(1, 6, 1, 6).\u0422\u0435\u043a\u0441\u0442 = "\u0428\u0442\u0440\u0438\u0445\u043a\u043e\u0434\u044b";\n\t\n\t\u041e\u0431\u043b\u0430\u0441\u0442\u044c\u0428\u0430\u043f\u043a\u0438 = \u0422\u0430\u0431\u0414\u043e\u043a.\u041e\u0431\u043b\u0430\u0441\u0442\u044c(1, 1, 1, 6);\n\t\u041e\u0431\u043b\u0430\u0441\u0442\u044c\u0428\u0430\u043f\u043a\u0438.\u0428\u0440\u0438\u0444\u0442 = \u041d\u043e\u0432\u044b\u0439 \u0428\u0440\u0438\u0444\u0442(, , \u0418\u0441\u0442\u0438\u043d\u0430);\n\t\n\t\u041d\u043e\u043c\u0435\u0440\u0421\u0442\u0440\u043e\u043a\u0438 = 2;\n\t\u041f\u043e\u043a\u0430 \u0412\u044b\u0431\u043e\u0440\u043a\u0430.\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439() \u0426\u0438\u043a\u043b\n\t\t\u0422\u0430\u0431\u0414\u043e\u043a.\u041e\u0431\u043b\u0430\u0441\u0442\u044c(\u041d\u043e\u043c\u0435\u0440\u0421\u0442\u0440\u043e\u043a\u0438, 1, \u041d\u043e\u043c\u0435\u0440\u0421\u0442\u0440\u043e\u043a\u0438, 1).\u0422\u0435\u043a\u0441\u0442 = \u0412\u044b\u0431\u043e\u0440\u043a\u0430.\u0410\u0440\u0442\u0438\u043a\u0443\u043b;\n\t\t\u0422\u0430\u0431\u0414\u043e\u043a.\u041e\u0431\u043b\u0430\u0441\u0442\u044c(\u041d\u043e\u043c\u0435\u0440\u0421\u0442\u0440\u043e\u043a\u0438, 2, \u041d\u043e\u043c\u0435\u0440\u0421\u0442\u0440\u043e\u043a\u0438, 2).\u0422\u0435\u043a\u0441\u0442 = \u0412\u044b\u0431\u043e\u0440\u043a\u0430.\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435;\n\t\t\u0422\u0430\u0431\u0414\u043e\u043a.\u041e\u0431\u043b\u0430\u0441\u0442\u044c(\u041d\u043e\u043c\u0435\u0440\u0421\u0442\u0440\u043e\u043a\u0438, 3, \u041d\u043e\u043c\u0435\u0440\u0421\u0442\u0440\u043e\u043a\u0438, 3).\u0422\u0435\u043a\u0441\u0442 = \u0421\u0442\u0440\u043e\u043a\u0430(\u0412\u044b\u0431\u043e\u0440\u043a\u0430.\u0415\u0434\u0438\u043d\u0438\u0446\u0430\u0418\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u044f);\n\t\t\u0422\u0430\u0431\u0414\u043e\u043a.\u041e\u0431\u043b\u0430\u0441\u0442\u044c(\u041d\u043e\u043c\u0435\u0440\u0421\u0442\u0440\u043e\u043a\u0438, 4, \u041d\u043e\u043c\u0435\u0440\u0421\u0442\u0440\u043e\u043a\u0438, 4).\u0422\u0435\u043a\u0441\u0442 = \u0424\u043e\u0440\u043c\u0430\u0442(\u0412\u044b\u0431\u043e\u0440\u043a\u0430.\u0426\u0435\u043d\u0430, "\u0427\u0426=15; \u0427\u0414\u0426=2; \u0427\u041d=0; \u0427\u0413=0");\n\t\t\u0422\u0430\u0431\u0414\u043e\u043a.\u041e\u0431\u043b\u0430\u0441\u0442\u044c(\u041d\u043e\u043c\u0435\u0440\u0421\u0442\u0440\u043e\u043a\u0438, 5, \u041d\u043e\u043c\u0435\u0440\u0421\u0442\u0440\u043e\u043a\u0438, 5).\u0422\u0435\u043a\u0441\u0442 = \u0424\u043e\u0440\u043c\u0430\u0442(\u0412\u044b\u0431\u043e\u0440\u043a\u0430.\u041e\u0441\u0442\u0430\u0442\u043e\u043a, "\u0427\u0426=15; \u0427\u0414\u0426=3; \u0427\u041d=0; \u0427\u0413=0");\n\t\t\n\t\t\u0428\u0442\u0440\u0438\u0445\u043a\u043e\u0434\u044b = \u0421\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0435\u0428\u041a[\u0412\u044b\u0431\u043e\u0440\u043a\u0430.\u041d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u0430];\n\t\t\u0415\u0441\u043b\u0438 \u0428\u0442\u0440\u0438\u0445\u043a\u043e\u0434\u044b = \u041d\u0435\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043e \u0422\u043e\u0433\u0434\u0430\n\t\t\t\u0428\u0442\u0440\u0438\u0445\u043a\u043e\u0434\u044b = "";\n\t\t\u041a\u043e\u043d\u0435\u0446\u0415\u0441\u043b\u0438;\n\t\t\u0422\u0430\u0431\u0414\u043e\u043a.\u041e\u0431\u043b\u0430\u0441\u0442\u044c(\u041d\u043e\u043c\u0435\u0440\u0421\u0442\u0440\u043e\u043a\u0438, 6, \u041d\u043e\u043c\u0435\u0440\u0421\u0442\u0440\u043e\u043a\u0438, 6).\u0422\u0435\u043a\u0441\u0442 = \u0428\u0442\u0440\u0438\u0445\u043a\u043e\u0434\u044b;\n\t\t\n\t\t\u041d\u043e\u043c\u0435\u0440\u0421\u0442\u0440\u043e\u043a\u0438 = \u041d\u043e\u043c\u0435\u0440\u0421\u0442\u0440\u043e\u043a\u0438 + 1;\n\t\u041a\u043e\u043d\u0435\u0446\u0426\u0438\u043a\u043b\u0430;\n\t\n\t\u0414\u043b\u044f \u041d\u043e\u043c\u0435\u0440\u041a\u043e\u043b\u043e\u043d\u043a\u0438 = 1 \u041f\u043e 6 \u0426\u0438\u043a\u043b\n\t\t\u0422\u0430\u0431\u0414\u043e\u043a.\u041e\u0431\u043b\u0430\u0441\u0442\u044c(1, \u041d\u043e\u043c\u0435\u0440\u041a\u043e\u043b\u043e\u043d\u043a\u0438, 1, \u041d\u043e\u043c\u0435\u0440\u041a\u043e\u043b\u043e\u043d\u043a\u0438).\u0428\u0438\u0440\u0438\u043d\u0430\u041a\u043e\u043b\u043e\u043d\u043a\u0438 = 20;\n\t\u041a\u043e\u043d\u0435\u0446\u0426\u0438\u043a\u043b\u0430;\n\t\u0422\u0430\u0431\u0414\u043e\u043a.\u041e\u0431\u043b\u0430\u0441\u0442\u044c(1, 2, 1, 2).\u0428\u0438\u0440\u0438\u043d\u0430\u041a\u043e\u043b\u043e\u043d\u043a\u0438 = 40;\n\t\u0422\u0430\u0431\u0414\u043e\u043a.\u041e\u0431\u043b\u0430\u0441\u0442\u044c(1, 6, 1, 6).\u0428\u0438\u0440\u0438\u043d\u0430\u041a\u043e\u043b\u043e\u043d\u043a\u0438 = 50;\n\t\n\u041a\u043e\u043d\u0435\u0446\u041f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u044b\n\n#\u041a\u043e\u043d\u0435\u0446\u041e\u0431\u043b\u0430\u0441\u0442\u0438\n'

# === Write all files === 
files = {
    "Reports/\u0421\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a\u041d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u044b.xml": report_xml,
    "Reports/\u0421\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a\u041d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u044b/Forms/\u0424\u043e\u0440\u043c\u0430\u041e\u0442\u0447\u0435\u0442\u0430.xml": form_descriptor_xml,
    "Reports/\u0421\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a\u041d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u044b/Forms/\u0424\u043e\u0440\u043c\u0430\u041e\u0442\u0447\u0435\u0442\u0430/Ext/Form.xml": form_xml,
}
bsl_files = {
    "Reports/\u0421\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a\u041d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u044b/Forms/\u0424\u043e\u0440\u043c\u0430\u041e\u0442\u0447\u0435\u0442\u0430/Ext/Form/Module.bsl": form_module_bsl,
    "Reports/\u0421\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a\u041d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u044b/Ext/ObjectModule.bsl": object_module_bsl,
}

for base_path in [BASE, COPY]:
    print(f"\n=== {base_path.name} ===")
    for rel_path, content in files.items():
        full_path = base_path / rel_path
        full_path.parent.mkdir(parents=True, exist_ok=True)
        full_path.write_text(content, encoding='utf-8')
        print(f"  XML: {pathlib.Path(rel_path).name}")
    for rel_path, content in bsl_files.items():
        full_path = base_path / rel_path
        full_path.parent.mkdir(parents=True, exist_ok=True)
        full_path.write_text(content, encoding='utf-8-sig')
        print(f"  BSL: {pathlib.Path(rel_path).name}")

# === Update ConfigDumpInfo.xml ===
import re

for base_path in [BASE, COPY]:
    cdi_path = base_path / "ConfigDumpInfo.xml"
    cdi = cdi_path.read_text(encoding='utf-8')
    
    # Remove old entries
    cdi = re.sub(r'\s*<Metadata name="Report\.СправочникНоменклатуры[^/]*/>',  '', cdi)  
    cdi = re.sub(r'\s*<Metadata name="Report\.СправочникНоменклатуры"[^>]*>\s*<Metadata name="Report\.СправочникНоменклатуры\.ObjectModule"[^/]*/>\s*</Metadata>', '', cdi)
    cdi = re.sub(r'\s*<Metadata name="Report\.СправочникНоменклатуры\.Form\.[^/]*/>',  '', cdi)
    
    # Add new entries before Role.Администратор
    new_entries = f'''
\t\t<Metadata name="Report.СправочникНоменклатуры" id="{REPORT_UUID}" configVersion="{CV_REPORT}">
\t\t\t<Metadata name="Report.СправочникНоменклатуры.ObjectModule" id="{REPORT_UUID}.0" configVersion="{CV_OBJMOD}"/>
\t\t</Metadata>
\t\t<Metadata name="Report.СправочникНоменклатуры.Form.ФормаОтчета" id="{FORM_UUID}" configVersion="{CV_FORM}"/>
\t\t<Metadata name="Report.СправочникНоменклатуры.Form.ФормаОтчета.Form" id="{FORM_UUID}.0" configVersion="{CV_FORMCONTENT}"/>'''
    
    cdi = cdi.replace(
        '\t\t<Metadata name="Role.Администратор"',
        f'{new_entries}\n\t\t<Metadata name="Role.Администратор"'
    )
    
    cdi_path.write_text(cdi, encoding='utf-8')
    print(f"\n  CDI updated: {base_path.name}")

print(f"\n\nUUIDs written:")
print(f"  Report: {REPORT_UUID}")
print(f"  Form:   {FORM_UUID}")
print("\nDone!")
