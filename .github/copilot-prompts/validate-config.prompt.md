# Валидация конфигурации перед загрузкой

## Когда использовать
- После создания/изменения ЛЮБЫХ объектов метаданных
- Перед загрузкой конфигурации в 1С:Предприятие
- При подозрении на ошибки целостности

## Алгоритм

### Шаг 1: Запуск скрипта валидации
```powershell
powershell -ExecutionPolicy Bypass -File "Документация\Валидация\validate-config.ps1"
```

### Шаг 2: Анализ результатов
Скрипт проверяет 7 стадий:
1. **Configuration.xml** — парсинг и извлечение объектов
2. **Файлы ↔ Реестр** — каждый объект из Configuration.xml имеет файл на диске и наоборот
3. **ConfigDumpInfo.xml** — каждый объект имеет запись с UUID
4. **XML структура** — InternalInfo, GeneratedType, корректность UUID
5. **Формы** — уникальность id, наличие ContextMenu/ExtendedTooltip/SearchStringAddition
6. **Файловая структура** — Form.xml и Module.bsl на месте для каждой формы
7. **Перекрёстные ссылки** — RegisterRecords, DefaultObjectForm указывают на существующие объекты

### Шаг 3: Исправление ошибок
Типичные ошибки и решения:

| Ошибка | Решение |
|--------|---------|
| `Файл не найден: Catalogs/Xxx.xml` | Создать XML объекта из шаблона |
| `Нет записи в ConfigDumpInfo` | Добавить `<Metadata name="..." id="..." configVersion="...">` |
| `Нет в Configuration.xml` | Добавить `<Catalog>Xxx</Catalog>` в `<ChildObjects>` |
| `id дублируется` в форме | Перенумеровать элементы формы |
| `Нет ContextMenu/ExtendedTooltip` | Добавить дочерние элементы (см. form-elements.md) |
| `RegisterRecords ссылается на несущ.` | Исправить имя регистра или создать регистр |

### Шаг 4: Повторный запуск
- Повторять Шаг 1-3 пока результат не покажет **0 ошибок**
- Только после 0 ошибок — конфигурация готова к загрузке
